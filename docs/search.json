{
  "articles": [
    {
      "path": "cv.html",
      "title": "Resume",
      "author": [],
      "contents": "\r\n\r\nContents\r\nEducation\r\nTechnical Skills\r\nRelevant Coursework\r\n\r\nResearch Experience\r\nWork Experience\r\nPublications\r\nTeaching Experience\r\nAwards\r\nOrganizations\r\n\r\nEducation\r\nJohns Hopkins University, Bloomberg School of Public Health\r\nBaltimore, Maryland (Expected May 2022)\r\nMaster of Health Science, Epidemiology, GPA: 3.93\r\nUniversity of Virginia, School of Arts and Sciences\r\nCharlottesville, Virginia (December 2019)\r\nBachelor of Arts, Biology & Global Public Health Double Major, GPA: 3.52\r\nTechnical Skills\r\nR\r\nMicrosoft Excel\r\nBash\r\nSTATA\r\nPython\r\nFIJI (ImageJ)\r\nRelevant Coursework\r\nAdvanced Epidemiology Methods\r\nStatistical Methods in Public Health I-IV\r\nAnalysis of Longitudinal Data\r\nGenetic Epidemiology I-III\r\nCausal Inference\r\nStatistical Computing\r\nData Science for Public Health\r\nPharmacoepidemiology Methods\r\nHealth Research Methods\r\nIntroduction to Programming\r\nHealth and Society\r\nPublic Health Policy\r\nPopulation Health Informatics\r\nResearch Experience\r\nJohns Hopkins Bloomberg School of Public Health\r\nResearch Assistant, Department of Epidemiology (June 2021-Present)\r\nDevelop reproducible statistical analyses in R programming language to predict chronologic age from large, complex DNA methylation datasets and to determine biological aging relationships with COPD severity and morbidity\r\nPerform appropriate methodologic procedures for statistical analyses such as overall descriptive statistics, exploratory data analyses including graphs and data transformations, and confirmatory analyses including statistical tests and models\r\nPrepare written manuscripts of research findings including tables and figures of publication quality, relevant epidemiologic theory, and references\r\nSynthesize literature and collaborate with content-matter experts to inform meaningful statistical analyses\r\nCommunicate research findings with colleagues both orally and in written progress reports\r\nImplement revisions to analyses based on feedback from colleagues in weekly meetings\r\nProgram in Bash to navigate secure datasets and organize reproducible statistical analyses through a remote computing cluster\r\nResearch Assistant, Department of Molecular Microbiology and Immunology (March 2021-June 2021)\r\nApplied epidemiology expertise and Excel skillset to enumerate the unenrolled population for a COVID-19 convalescent plasma trial\r\nUniversity of Virginia\r\nResearch Assistant, Center for Public Health Genomics (June 2018-December 2019)\r\nOptimized protocols for histological and immunohistochemical staining of frozen tissue specimen\r\nQuantified image data using FIJI software to elucidate stages of disease progression in atherosclerotic arteries\r\nRecorded experimental results in a professional Excel spreadsheet\r\nWork Experience\r\nThe Fauquier Free Clinic\r\nVolunteer & Administrative Intern (September 2015-August 2020)\r\nLead quality improvement efforts by extracting and analyzing data from Athena EMR to obtain health measures\r\nPresented data findings to a clinical services committee of health professionals and administrators\r\nOversaw that administrative and appointment intake document are complete and accurate\r\nEntered scheduling, financial, and health data into Athena EMR and trained staff on navigating Athena EMR\r\nInterpreted patient needs, determined financial eligibility, and linked patients with services as a patient registrar\r\nOffice of Health Promotion\r\nCampaign Assistant (August 2018- December 2019)\r\nCollaborated in a multidisciplinary team to create data-driven health intervention materials promoting positive norms for health behavior\r\nDisseminated public health campaign materials to an audience of thousands of undergraduate students\r\nPublications\r\nTurner, A., Wong, D., Khan, M. D., Driesbach, C., Palmore, M., & Miller, C. Multi-omics approaches to study long noncoding RNA function in atherosclerosis. Front Cardiovasc Med. (2019) 6:9. doi: 10.3389/fcvm.2019.00009\r\nTeaching Experience\r\nTutor – Epidemiologic Methods 2\r\nOctober 2021- December 2021\r\nAwards\r\nParent’s Fund Internship Grant\r\nApril 20, 2019\r\nAwarded in recognition of completing an unpaid service internship supporting one of the five areas of public concern as defined by the Virginia 2020 Commission\r\nOrganizations\r\nAmerican Public Health Association\r\nApril 2021-Present\r\nSustained Dialogue\r\nSeptember 2016-May 2018\r\nParticipated in a discussion of viewpoints on social and political issues with a diverse group of students\r\n\r\n\r\n\r\n",
      "last_modified": "2022-02-03T22:33:47-05:00"
    },
    {
      "path": "index.html",
      "title": "Meredith Palmore",
      "description": "Epidemiology | Genetics | Data science\n",
      "author": [],
      "contents": "\r\n\r\nHi, I’m Meredith! I am currently a Master of Health Science student at Johns Hopkins University’s Bloomberg School of Public Health studying Genetic Epidemiology.\r\nI am passionate about leveraging data science tools to answer complex public health questions. I am particularly interested in understanding the roles of genetic and environmental factors in the etiology of chronic diseases. During my schooling, I have actively participated in and supported diverse and interdisciplinary research projects, spanning the topics of epidemiology, molecular biology, genetics, epigenetics, social science, and clinical research.\r\nI am also an advocate for health equity and dedicated to improving the health of underserved communities through my research and volunteerism.\r\nContact Me:  \r\n\r\n\r\n\r\n",
      "last_modified": "2022-02-03T22:33:48-05:00"
    },
    {
      "path": "projects.html",
      "title": "Projects",
      "description": "My portfolio of data science projects\n",
      "author": [],
      "contents": "\r\n\r\nContents\r\nDeveloping a placental epigenetic risk score for maternal BMI\r\nBackground\r\nWrangling the Data\r\nRun the epigenetic risk score function\r\nResults\r\nDiscussion of the results\r\n\r\nBehavioral Risk Factors of Excessive Daytime Sleepiness in NHANES 2017-18\r\nBackground\r\nStudy Design\r\nData\r\nWrangling the data\r\nCorrecting for missingness\r\nStatistical Methods\r\nResults\r\nConclusions and future directions\r\n\r\n\r\nDeveloping a placental epigenetic risk score for maternal BMI\r\nBy Meredith Palmore, epigenetic risk score adapted from Ellen Howerton\r\nBackground\r\nMaternal body mass index (BMI) is a known risk factor of child health outcomes, such as childhood obesity, preterm birth, and infant mortality. Additionally, the theory of biological embedding highlights that early life conditions, such as those conferred by maternal BMI, may contribute to healthfulness of offspring later in life. Despite the correlational evidence behind the impacts of maternal BMI on child health outcomes, fewer studies have examined the biological pathways linking maternal education to child health outcomes. There is a clear need to examine how biological pathways related to maternal prepregnancy BMI may contribute to later child health.\r\nA plausible biological mechanism is epigenetic alterations to the placenta. The placenta mediates the transfer of life-supporting nutrients and stress signals to the developing fetus. Changes to the placental epigenome in the form of DNA methylation impact gene regulation and could serve as a biological mechanism for adverse infant health outcomes related to exposures during pregnancy. Both candidate gene studies and epigenome wide association studies (EWAS) have revealed relationships between maternal pre-pregnancy BMI and DNA methylation changes in the newborn epigenome. In this analysis, I aim to summarize the impact of maternal BMI on the fetal side of the placental epigenome in an epigenetic risk score. Capturing alterations to the infant epigenome during pregnancy in an epigenetic risk score will help to improve our understanding of the relationship between maternal BMI and adverse infant health outcomes. Understanding the biological risk of maternal BMI on infant health may influence the prioritization of public health initiatives and policies that target maternal health.\r\nDescription:\r\nThe primary goal of this analysis is to summarize the relationship between the infant epigenome and maternal BMI in a weighted epigenetic risk score. Predictors of epigenetic risk will be derived from summary statistics of a previous EWAS of pre-pregnancy BMI on placental DNA methylation. Epigenetic risk score performance will be validated in the RICHS cohort.\r\nThis function and following code show the DNA methylation scoring procedure for difference in M-value in placental tissue, comparing mothers with different BMI categories. The main scoring procedure is in the function, and then after all scoring is completed, the performance is evaluated and the results are plotted.\r\nSome notes on the epigenetic risk score:\r\nOne of my colleagues, Ellen Howerton, kindly provided me with the function for the epigenetic risk score. I have modified it to work with categorical variables with multiple levels.\r\ntoppg_11 are the summary statistics derived from limma’s topTable() (rownames are CpG sites, column names are effect size of logFC, P.Value, etc.)\r\nThe M-value matrix, or the individual-level methylation data matrix, in this example is named M_regress\r\nabsmeans are the average of the absolute value of effect sizes.\r\nHere, I have included one variable to score, BMI category, as well as scoring by p-value threshold, but it could be modified to be multiple variables and a CpG list to be more generalizable.\r\nWrangling the Data\r\nPart 1. Load packages\r\n\r\n\r\nlibrary(tidyverse)\r\nlibrary(data.table)\r\nlibrary(reshape2)\r\nlibrary(here)\r\n\r\nif (!requireNamespace(\"BiocManager\", quietly = TRUE))\r\n  install.packages(\"BiocManager\")\r\n\r\n#BiocManager::install(\"IlluminaHumanMethylation450kanno.ilmn12.hg19\")\r\n\r\nlibrary(IlluminaHumanMethylation450kanno.ilmn12.hg19)\r\nlibrary(methyland) #A package for imputation that I made myself! It requires the Annotation file loaded above.\r\nlibrary(fmsb)\r\nlibrary(pROC)\r\nlibrary(readxl)\r\n\r\n\r\n\r\nPart 2. Load in my M-value matrix and summary statistics\r\nA couple of notes about the methylation data:\r\nHere is a link to the study from which I derived summary statistics: https://pubmed.ncbi.nlm.nih.gov/32071425/\r\nHere is a link to the study where I derived my GEO dataset: http://dx.doi.org/10.1080/15592294.2016.1195534\r\nThe summary statistics were derived from linear models adjusted for surrogate variables as proxy for placenta cellular heterogeneity, SNP-based ancestry principal components, methylation principal components, maternal age, race and ethnicity, offspring sex,and sequencing batches.\r\nBoth the summary statistics and methylation data are measured from placental tissue on the 450K methylation array.\r\nNow I will load in the summary data for our risk score algorithm. There are multiple files for the summary statistics because they were converted from a pdf file.\r\n\r\n\r\n#My top_11 frame (it's not a limma object, it's loaded in as a .csv)\r\n\r\nsetwd(\"C:/Users/softb/OneDrive - Johns Hopkins/Thesis/Data/Summ_stats_BMI/\")\r\n\r\ntemp = list.files(pattern=\"*.csv\")\r\nmyfiles = lapply(temp, read.csv)\r\n\r\nfor(i in 1:length(myfiles)){colnames(myfiles[[i]]) <- c(\"CpGs\", \"chrom\", \"logFC\", \"p-value\", \"direction\")} \r\n\r\n\r\ntop_11 <- myfiles %>% bind_rows()\r\n\r\nhead(top_11)\r\n\r\n\r\n        CpGs chrom        logFC   p-value     direction\r\n1 cg10143030  chr2  0.004584571 0.2115875 Hypermethylat\r\n2 cg07848601  chr5  0.009093954 0.2151436 Hypermethylat\r\n3 cg26466094  chr1 -0.007766493 0.2162056  Hypomethylat\r\n4 cg16724319  chr2 -0.050483370 0.2181015  Hypomethylat\r\n5 cg22197787  chr1 -0.003223481 0.2339715  Hypomethylat\r\n6 cg13266327  chr2  0.004322822 0.2374356 Hypermethylat\r\n\r\ntop_11 <- as_tibble(top_11)\r\n\r\n# Any missing data?\r\n\r\npMiss <- function(x){sum(is.na(x))/length(x)*100}\r\n\r\napply(top_11,2,pMiss)\r\n\r\n\r\n      CpGs      chrom      logFC    p-value  direction \r\n0.00000000 0.00000000 0.05307856 0.00000000 0.00000000 \r\n\r\n# One logFC value missing, so I will remove it. \r\n\r\ntop_11 <- top_11[-c(which(is.na(top_11$logFC))),]\r\n\r\n# Make all of the columns numeric:\r\n\r\ncolnames(top_11)\r\n\r\n\r\n[1] \"CpGs\"      \"chrom\"     \"logFC\"     \"p-value\"   \"direction\"\r\n\r\ntop_11$logFC <- as.numeric(top_11$logFC)\r\ntop_11$`p-value` <- as.numeric(top_11$`p-value`)\r\n\r\n\r\n\r\nNow, I will load in the methylation data. We expect to see a data-frame with 237 subjects (columns) and a bit fewer than 450K rows of data corresponding to the CpG probes.\r\n\r\n\r\n## My M-matrix:\r\n\r\nsetwd(\"C:/Users/softb/OneDrive - Johns Hopkins/Thesis/Data\")\r\nload(\"Mval_Matrix.rda\")\r\n\r\ndim(M_regress)\r\n\r\n\r\n[1] 336484    237\r\n\r\nPart 3. Subset matrix to probes that transfer from the EPIC to 450K array\r\nThe methylation matrix from GEO is already cleaned. However, during the cleaning process, the authors filtered out many probes, inclusing ones with little variability in methylation. I need some of the probes that they filtered out.\r\nThere are two possible ways that I will deal with the probes that do not transfer: Either…\r\ndrop them from the analysis\r\nfind the nearest probes that we have measured and retain those for the score\r\nI will try option 2. I wrote a function that will find the nearest probe for which we have methylation data measured, and return a list of those probes.\r\nI developed an imputation function that finds the nearest probe on the array that is also in our dataset.\r\n\r\n\r\n# # Option 2: Substitute missing with an imputation function I developed\r\n      missing_fromMatrix <- top_11[which(!top_11$CpGs %in% rownames(M_regress)), 1]\r\n      missing_fromMatrix <- deframe(missing_fromMatrix)\r\n      closest_probe <- findSub(missing_fromMatrix, M_regress, annotation= \"Illumina450k\")\r\n\r\n      closest_probe[,1] %in% rownames(M_regress)\r\n\r\n\r\n  [1] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE\r\n [14] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE\r\n [27] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE\r\n [40] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE\r\n [53] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE\r\n [66] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE\r\n [79] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE\r\n [92] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE\r\n[105] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE\r\n\r\n      # All TRUE! :)\r\n      \r\n      # The first column are the probes that were substituted, the second is the nearest probe that my imputation function found. The third column is the distance between the two probes in base-pairs. \r\n      \r\n      head(closest_probe)\r\n\r\n\r\n           Nearest_Probe Distance\r\ncg13266327 \"cg03997139\"  \"9\"     \r\ncg03393966 \"cg10740054\"  \"11\"    \r\ncg15119377 \"cg03518058\"  \"82\"    \r\ncg20227592 \"cg13902024\"  \"25384\" \r\ncg10442251 \"cg23010629\"  \"22\"    \r\ncg07708472 \"cg19807612\"  \"50\"    \r\n\r\n      # Subset M-matrix to these probes (all 50)\r\n\r\n        index_scoreprobes <- which(rownames(M_regress) %in% top_11$CpGs)\r\n        index_imputedprobes <- which(rownames(M_regress) %in% closest_probe[,1])\r\n\r\n        index_allprobes <- c(index_scoreprobes, index_imputedprobes)\r\n\r\n        M_regress <- M_regress[index_allprobes,]\r\n\r\n      #rename the substituted probes in the toptable\r\n        closest_probe <- tibble::rownames_to_column(as.data.frame(closest_probe), \"CpGs\")\r\n\r\n        top_11 <- left_join(top_11, closest_probe, by=\"CpGs\")\r\n\r\n        top_11 <- top_11 %>% mutate(CpGs = ifelse(is.na(Nearest_Probe), CpGs, Nearest_Probe))\r\n        top_11 %>% select(CpGs, Nearest_Probe)\r\n\r\n\r\n# A tibble: 1,883 x 2\r\n   CpGs       Nearest_Probe\r\n   <chr>      <chr>        \r\n 1 cg10143030 <NA>         \r\n 2 cg07848601 <NA>         \r\n 3 cg26466094 <NA>         \r\n 4 cg16724319 <NA>         \r\n 5 cg22197787 <NA>         \r\n 6 cg03997139 cg03997139   \r\n 7 cg10740054 cg10740054   \r\n 8 cg20594982 <NA>         \r\n 9 cg05638699 <NA>         \r\n10 cg16274199 <NA>         \r\n# ... with 1,873 more rows\r\n\r\n        # Are there any duplicate probes in our imputed list?\r\n        all(unique(top_11$CpGs) == top_11$CpGs)\r\n\r\n\r\n[1] FALSE\r\n\r\n        top_11<- top_11 %>% filter(duplicated(CpGs) == FALSE)\r\n\r\n          #Will keep the true (non-imputed) CpG because it has a stronger association and is located closer to the top of the list\r\n\r\n\r\n\r\nNow that we have imputed the missing probes with nearby ones and updated them in the methylation matrix and in the top_11 object (summary statistics object), we can proceed with our computation of the score.\r\nFor the score, we must find the average absolute value of the logFC, or the log-fold change in methylation for each unit increase in BMI, and save it for later:\r\n\r\n\r\ntop_11$logFC <- as.numeric(top_11$logFC)\r\n  absmean_pg_11 <- mean(abs(top_11$logFC))\r\n  absmean_pg_11\r\n\r\n\r\n[1] 0.005470551\r\n\r\nPart 4. Select individuals with phenotype information\r\nThe sample annotation file contains all the phenotypic data of the subjects in the RICHS cohort. We would expect that the rows in the phenotypic dataset correspond perfectly to the columns in the methylation dataset. Here, I will only retain the sample IDs and the outcome of interest, BMI.\r\nThen, I calculate BMI categories because I need to be able to specify a reference group that I will compare mean methylation levels to, namely individuals with “normal” BMIs.\r\n\r\n\r\n# Load in phenotype information\r\n\r\nload(\"C:/Users/softb/OneDrive - Johns Hopkins/Thesis/Data/Subset_Annotation.rda\")\r\n\r\npd <- subset_anno %>%\r\n  mutate(\"SampleID\" = geo_accession, .before = geo_accession) %>%\r\n  select(SampleID, bmi)\r\n\r\n#We expect to have 237 rows of data, corresponding with the 237 columns in the \r\n\r\nhead(pd)\r\n\r\n\r\n             SampleID      bmi\r\nGSM1947017 GSM1947017 39.91943\r\nGSM1947018 GSM1947018 44.05074\r\nGSM1947019 GSM1947019 19.60968\r\nGSM1947020 GSM1947020 28.56811\r\nGSM1947021 GSM1947021 21.31254\r\nGSM1947023 GSM1947023 39.16633\r\n\r\ndim(pd)\r\n\r\n\r\n[1] 237   2\r\n\r\n# Is there any missing data?\r\napply(pd,2,pMiss) # No.\r\n\r\n\r\nSampleID      bmi \r\n       0        0 \r\n\r\n# Divide BMI into categories.\r\n\r\npd$bmi <- as.numeric(pd$bmi)\r\n\r\npd = dplyr::mutate(pd, bmicat = cut(bmi, breaks = c(0,18.5, 25, 30,100), labels = 1:4, ordered = TRUE))\r\n\r\nggplot(pd, aes(bmicat, bmi, fill = bmicat)) + \r\n  geom_boxplot() +\r\n  scale_x_discrete(labels=c(\"1\" = \"Underweight\", \"2\" = \"Normal\",\r\n                              \"3\" = \"Overweight\", \"4\" = \"Obese\"))+ \r\n  theme(legend.position= \"none\")\r\n\r\n\r\n\r\nhist(pd$bmi) #Very right skewed\r\n\r\n\r\n\r\nggplot(pd, aes(bmicat)) + \r\n  geom_histogram(stat=\"count\", fill = \"pink1\") +\r\n  scale_x_discrete(labels=c(\"1\" = \"Underweight\", \"2\" = \"Normal\",\r\n                              \"3\" = \"Overweight\", \"4\" = \"Obese\"))\r\n\r\n\r\n\r\nclass(pd$bmicat)\r\n\r\n\r\n[1] \"ordered\" \"factor\" \r\n\r\n#Make sure there are 237 subjects in the sample annotation and the methylation data files.\r\n\r\ndim(M_regress)\r\n\r\n\r\n[1] 1869  237\r\n\r\ndim(pd)\r\n\r\n\r\n[1] 237   3\r\n\r\nRun the epigenetic risk score function\r\nSince the outcome is not binary, the baseline we are standardizing our methylation levels to are individuals with ‘normal’ BMI. So when comparing methylation to the the median value of the “unexposed”, the unexposed is individuals with normal BMI.\r\n\r\n\r\nscore_ts_byM_p <- function(variable, pthresh) {\r\n  \r\n  top_11 <- top_11[top_11$`p-value` <= pthresh,]\r\n  top_11 <- mutate(top_11, CpG_site = CpGs)\r\n\r\n  top_11 <- top_11 %>%\r\n    as_tibble() %>%\r\n    dplyr::mutate(CpG_site = as.factor(CpG_site)) \r\n\r\n  if(nrow(top_11) == 0) {\r\n    print(paste0(\"There are no CpGs that reached significance for p <= \", pthresh, \". Stopping function.\"))\r\n    stop()\r\n  }\r\n\r\n  print(paste0(\"Here are the CpG sites that have a p-value <=  \", pthresh, \":\"))\r\n  print(top_11)\r\n  fwrite(top_11, file.path(\"projects_files\", paste0(\"cpg_list_in_score_\", pthresh, \"_\", variable, \".csv\")))\r\n\r\n  # prep count name\r\n  count_name <- paste0(\"count_\", pthresh)\r\n\r\n  top_count_t_11 <- top_11 %>%\r\n     as_tibble() %>%\r\n     dplyr::mutate(CpG_site = as.factor(CpG_site)) %>%\r\n    dplyr::summarise(!!count_name := n(), total_CpGs = nrow(top_11))\r\n  print(top_count_t_11)\r\n  fwrite(top_count_t_11,file.path(\"projects_files\",paste0(\"cpg_count_in_score_\", pthresh, \"_\", variable, \".csv\")))\r\n  # Note: Had to remove the directory specified because I don't have it.\r\n\r\n  # subset M-value matrix\r\n  t_cpg_site_names <- top_11 %>%\r\n    dplyr::select(CpG_site) %>%\r\n    dplyr::mutate(CpG_site = as.character(CpG_site)) %>%\r\n    deframe()\r\n\r\n  M_11 <- M_regress[t_cpg_site_names,] %>%\r\n    t() %>%\r\n    as.data.frame()\r\n  print(\"The dimensions of the M-value object, subsetted by CpG sites of interest:\")\r\n   #print(head(M_11))\r\n   #print(tail(M_11))\r\n  print(dim(M_11))\r\n\r\n  # bind phenotype information\r\n  M_inf_11 <- cbind(M_11, pd[ ,c(\"SampleID\",\"bmicat\")])\r\n  print(\"The dimensions of the M-value object, with bmi information:\")\r\n   #print(head(M_inf_11))\r\n   #print(tail(M_inf_11))\r\n  print(dim(M_inf_11))\r\n  \r\n  M_inf_11 <- M_inf_11 %>%\r\n    dplyr::as_tibble()\r\n  \r\n  #print(\"dimensions of the tibble:\")\r\n  #print(dim(M_inf_11))\r\n\r\n  # reshape data to long\r\n  M_inf_melt_11 <- M_inf_11 %>%\r\n    #dplyr::as_tibble() %>%\r\n    melt(id.vars = c(\"SampleID\",\"bmicat\")) %>%\r\n    #dplyr::as_tibble() %>%\r\n    dplyr::rename(CpG_site = variable) %>%\r\n    dplyr::rename(M_value = value) \r\n  \r\n  top_11$CpG_site <- as.character(top_11$CpG_site)\r\n  M_inf_melt_11$CpG_site <- as.character(M_inf_melt_11$CpG_site)\r\n  \r\n  M_inf_melt_11 <- M_inf_melt_11 %>%\r\n    dplyr::left_join(top_11, by = \"CpG_site\")\r\n  \r\n  print(\"The 'melted' M-value object, with bmi information:\")\r\n  print(summary(M_inf_melt_11))\r\n  \r\n  \r\n\r\n  # empty median M value tibble\r\n  med_M <- tibble(CpG_site = factor(),\r\n                  #timeframe = factor(),\r\n                  med_M_unexp = numeric())\r\n  print(\"Check (empty) median M value tibble:\")\r\n  print(med_M)\r\n\r\n  \r\n  # for loop to add in median M value for the reference group (normal BMI = 2) for each CpG and time period\r\n\r\n  \r\n  pd$bmicat <- as.numeric(pd$bmicat)\r\n  \r\n  top_11$CpG_site <- as.factor(top_11$CpG_site)\r\n\r\n  for(i in seq_along(levels(top_11$CpG_site))) {\r\n\r\n    i_nm <- top_11$CpG_site[[i]]\r\n\r\n       row_M <- M_inf_melt_11 %>%\r\n         dplyr::mutate(CpG_site = as.factor(CpG_site)) %>%\r\n         dplyr::filter(CpG_site == i_nm & bmicat == 2) %>%\r\n         dplyr::summarize(CpG_site, med_M_unexp = median(M_value)) %>%\r\n         distinct()\r\n       med_M <- bind_rows(med_M, row_M)\r\n  }\r\n\r\n   print(\"Here is the median M-value of normal BMI (reference group) for all CpGs in the score:\")\r\n   print(med_M)\r\n\r\n  # join the median unexposed to the melt score object\r\n  M_inf_melt_med <- dplyr::left_join(M_inf_melt_11, med_M, by = \"CpG_site\")\r\n  # print(M_inf_melt_med)\r\n\r\n  print(\"Check that median values joined correctly:\")\r\n  print(summary(M_inf_melt_med))\r\n\r\n  # prep names for score columns\r\n  score_name <- paste0(\"score_\", pthresh)\r\n  score_name <- gsub(\"e-\", \"E_\", score_name)\r\n\r\n  # score!\r\n  M_inf_melt_score <- M_inf_melt_med %>%\r\n    dplyr::mutate(score_cpg  = (logFC / absmean_pg_11) * (M_value - med_M_unexp)) %>%\r\n    dplyr::group_by(SampleID) %>%\r\n    dplyr::mutate(!!score_name := sum(score_cpg))\r\n\r\n  print(paste0(\"Scores are complete for the variable: \", variable, \" and the p-value threshold of: \", pthresh))\r\n\r\n  # make more mergeable\r\n  M_inf_melt_score %>%\r\n    dplyr::select(SampleID, bmicat, !!score_name) %>%\r\n    distinct()\r\n\r\n}\r\n\r\n\r\n\r\nResults\r\nPart 1. Make functions for results tables and graphs\r\nNow that we have computed the scores, we can make functions for the results that include figures and regression results.\r\nFunctions make my code look nicer and more concise to have graphs summarizing the results from the risk score calculations.\r\n\r\n\r\ngress_graph <- function(score){\r\n  \r\n  indv_scores <- as.matrix(score[,3])\r\n  \r\n  score$bmicat <- factor(score$bmicat, ordered = FALSE)\r\n  score$bmicat <- relevel(score$bmicat, ref = 2)\r\n  \r\n  mod <- lm(indv_scores ~ bmicat, data = score)\r\n  mean_change <- coef(mod)\r\n  conf <- confint(mod)\r\n  print(mean_change)\r\n  print(conf)\r\n  print(summary(mod)$r.squared)\r\n  print(aic(mod))\r\n  \r\n  \r\n\r\n   ggplot(score, aes(x = bmicat, y = indv_scores)) +\r\n     geom_violin(fill = \"pink1\") +\r\n     geom_point(alpha=0.5) +\r\n     scale_x_discrete(labels=c(\"1\" = \"Underweight\", \"2\" = \"Normal\",\r\n                              \"3\" = \"Overweight\", \"4\" = \"Obese\"))\r\n    \r\n}\r\n\r\n\r\n\r\nPart 2. Display the results\r\n\r\n\r\nM_score_pg_1E_03 <- score_ts_byM_p(\"bmicat\", 1*10^-3)\r\n\r\n\r\n[1] \"Here are the CpG sites that have a p-value <=  0.001:\"\r\n# A tibble: 2 x 8\r\n  CpGs       chrom    logFC `p-value` direction Nearest_Probe Distance\r\n  <chr>      <chr>    <dbl>     <dbl> <chr>     <chr>         <chr>   \r\n1 cg13014558 chr11 -0.00603  0.000503 Hypometh~ <NA>          <NA>    \r\n2 cg26947572 chr2  -0.0118   0.000723 Hypometh~ <NA>          <NA>    \r\n# ... with 1 more variable: CpG_site <fct>\r\n# A tibble: 1 x 2\r\n  count_0.001 total_CpGs\r\n        <int>      <int>\r\n1           2          2\r\n[1] \"The dimensions of the M-value object, subsetted by CpG sites of interest:\"\r\n[1] 237   2\r\n[1] \"The dimensions of the M-value object, with bmi information:\"\r\n[1] 237   4\r\n[1] \"The 'melted' M-value object, with bmi information:\"\r\n   SampleID         bmicat    CpG_site            M_value        \r\n Length:474         1: 22   Length:474         Min.   :-6.02212  \r\n Class :character   2:212   Class :character   1st Qu.:-5.17617  \r\n Mode  :character   3:112   Mode  :character   Median :-2.33216  \r\n                    4:128                      Mean   :-2.53902  \r\n                                               3rd Qu.: 0.09552  \r\n                                               Max.   : 0.59106  \r\n     CpGs              chrom               logFC          \r\n Length:474         Length:474         Min.   :-0.011773  \r\n Class :character   Class :character   1st Qu.:-0.011773  \r\n Mode  :character   Mode  :character   Median :-0.008900  \r\n                                       Mean   :-0.008900  \r\n                                       3rd Qu.:-0.006027  \r\n                                       Max.   :-0.006027  \r\n    p-value           direction         Nearest_Probe     \r\n Min.   :0.0005027   Length:474         Length:474        \r\n 1st Qu.:0.0005027   Class :character   Class :character  \r\n Median :0.0006129   Mode  :character   Mode  :character  \r\n Mean   :0.0006129                                        \r\n 3rd Qu.:0.0007231                                        \r\n Max.   :0.0007231                                        \r\n   Distance        \r\n Length:474        \r\n Class :character  \r\n Mode  :character  \r\n                   \r\n                   \r\n                   \r\n[1] \"Check (empty) median M value tibble:\"\r\n# A tibble: 0 x 2\r\n# ... with 2 variables: CpG_site <fct>, med_M_unexp <dbl>\r\n[1] \"Here is the median M-value of normal BMI (reference group) for all CpGs in the score:\"\r\n# A tibble: 2 x 2\r\n  CpG_site   med_M_unexp\r\n  <fct>            <dbl>\r\n1 cg13014558      0.0825\r\n2 cg26947572     -5.20  \r\n[1] \"Check that median values joined correctly:\"\r\n   SampleID         bmicat    CpG_site            M_value        \r\n Length:474         1: 22   Length:474         Min.   :-6.02212  \r\n Class :character   2:212   Class :character   1st Qu.:-5.17617  \r\n Mode  :character   3:112   Mode  :character   Median :-2.33216  \r\n                    4:128                      Mean   :-2.53902  \r\n                                               3rd Qu.: 0.09552  \r\n                                               Max.   : 0.59106  \r\n     CpGs              chrom               logFC          \r\n Length:474         Length:474         Min.   :-0.011773  \r\n Class :character   Class :character   1st Qu.:-0.011773  \r\n Mode  :character   Mode  :character   Median :-0.008900  \r\n                                       Mean   :-0.008900  \r\n                                       3rd Qu.:-0.006027  \r\n                                       Max.   :-0.006027  \r\n    p-value           direction         Nearest_Probe     \r\n Min.   :0.0005027   Length:474         Length:474        \r\n 1st Qu.:0.0005027   Class :character   Class :character  \r\n Median :0.0006129   Mode  :character   Mode  :character  \r\n Mean   :0.0006129                                        \r\n 3rd Qu.:0.0007231                                        \r\n Max.   :0.0007231                                        \r\n   Distance          med_M_unexp      \r\n Length:474         Min.   :-5.19757  \r\n Class :character   1st Qu.:-5.19757  \r\n Mode  :character   Median :-2.55752  \r\n                    Mean   :-2.55752  \r\n                    3rd Qu.: 0.08254  \r\n                    Max.   : 0.08254  \r\n[1] \"Scores are complete for the variable: bmicat and the p-value threshold of: 0.001\"\r\n\r\n  gress_graph(M_score_pg_1E_03)\r\n\r\n\r\n(Intercept)     bmicat1     bmicat3     bmicat4 \r\n-0.02918356  0.08305977 -0.18809819  0.00519048 \r\n                 2.5 %      97.5 %\r\n(Intercept) -0.1443039 0.085936813\r\nbmicat1     -0.2923874 0.458506904\r\nbmicat3     -0.3838995 0.007703169\r\nbmicat4     -0.1824328 0.192813739\r\n[1] 0.01970488\r\n       lik       infl       vari        aic \r\n-42.185102   3.433483   3.336728  91.237169 \r\n\r\nM_score_pg_1E_02 <- score_ts_byM_p(\"bmicat\", 1*10^-2)\r\n\r\n\r\n[1] \"Here are the CpG sites that have a p-value <=  0.01:\"\r\n# A tibble: 53 x 8\r\n   CpGs     chrom    logFC `p-value` direction  Nearest_Probe Distance\r\n   <chr>    <chr>    <dbl>     <dbl> <chr>      <chr>         <chr>   \r\n 1 cg13014~ chr11 -0.00603  0.000503 Hypomethy~ <NA>          <NA>    \r\n 2 cg26947~ chr2  -0.0118   0.000723 Hypomethy~ <NA>          <NA>    \r\n 3 cg05633~ chr2   0.0493   0.00108  Hypermeth~ <NA>          <NA>    \r\n 4 cg01054~ chr12  0.00608  0.00113  Hypermeth~ <NA>          <NA>    \r\n 5 cg12902~ chr1  -0.0327   0.00123  Hypomethy~ <NA>          <NA>    \r\n 6 cg11428~ chr22  0.0128   0.00157  Hypermeth~ <NA>          <NA>    \r\n 7 cg03719~ chr20 -0.0115   0.00160  Hypomethy~ <NA>          <NA>    \r\n 8 cg17492~ chr2  -0.0210   0.00167  Hypomethy~ <NA>          <NA>    \r\n 9 cg13782~ chr14 -0.0133   0.00170  Hypomethy~ <NA>          <NA>    \r\n10 cg02759~ chr4  -0.0682   0.00172  Hypomethy~ <NA>          <NA>    \r\n# ... with 43 more rows, and 1 more variable: CpG_site <fct>\r\n# A tibble: 1 x 2\r\n  count_0.01 total_CpGs\r\n       <int>      <int>\r\n1         53         53\r\n[1] \"The dimensions of the M-value object, subsetted by CpG sites of interest:\"\r\n[1] 237  53\r\n[1] \"The dimensions of the M-value object, with bmi information:\"\r\n[1] 237  55\r\n[1] \"The 'melted' M-value object, with bmi information:\"\r\n   SampleID         bmicat     CpG_site            M_value      \r\n Length:12561       1: 583   Length:12561       Min.   :-8.691  \r\n Class :character   2:5618   Class :character   1st Qu.:-5.480  \r\n Mode  :character   3:2968   Mode  :character   Median :-4.998  \r\n                    4:3392                      Mean   :-3.688  \r\n                                                3rd Qu.:-2.463  \r\n                                                Max.   : 5.809  \r\n     CpGs              chrom               logFC          \r\n Length:12561       Length:12561       Min.   :-0.068234  \r\n Class :character   Class :character   1st Qu.:-0.014400  \r\n Mode  :character   Mode  :character   Median :-0.011544  \r\n                                       Mean   :-0.004837  \r\n                                       3rd Qu.: 0.008676  \r\n                                       Max.   : 0.050861  \r\n    p-value           direction         Nearest_Probe     \r\n Min.   :0.0005027   Length:12561       Length:12561      \r\n 1st Qu.:0.0021486   Class :character   Class :character  \r\n Median :0.0037328   Mode  :character   Mode  :character  \r\n Mean   :0.0044511                                        \r\n 3rd Qu.:0.0066821                                        \r\n Max.   :0.0095655                                        \r\n   Distance        \r\n Length:12561      \r\n Class :character  \r\n Mode  :character  \r\n                   \r\n                   \r\n                   \r\n[1] \"Check (empty) median M value tibble:\"\r\n# A tibble: 0 x 2\r\n# ... with 2 variables: CpG_site <fct>, med_M_unexp <dbl>\r\n[1] \"Here is the median M-value of normal BMI (reference group) for all CpGs in the score:\"\r\n# A tibble: 53 x 2\r\n   CpG_site   med_M_unexp\r\n   <fct>            <dbl>\r\n 1 cg13014558      0.0825\r\n 2 cg26947572     -5.20  \r\n 3 cg05633391     -5.41  \r\n 4 cg01054110      1.95  \r\n 5 cg12902497     -5.66  \r\n 6 cg11428482     -5.59  \r\n 7 cg03719642      2.19  \r\n 8 cg17492041     -5.40  \r\n 9 cg13782781     -5.06  \r\n10 cg02759110     -4.22  \r\n# ... with 43 more rows\r\n[1] \"Check that median values joined correctly:\"\r\n   SampleID         bmicat     CpG_site            M_value      \r\n Length:12561       1: 583   Length:12561       Min.   :-8.691  \r\n Class :character   2:5618   Class :character   1st Qu.:-5.480  \r\n Mode  :character   3:2968   Mode  :character   Median :-4.998  \r\n                    4:3392                      Mean   :-3.688  \r\n                                                3rd Qu.:-2.463  \r\n                                                Max.   : 5.809  \r\n     CpGs              chrom               logFC          \r\n Length:12561       Length:12561       Min.   :-0.068234  \r\n Class :character   Class :character   1st Qu.:-0.014400  \r\n Mode  :character   Mode  :character   Median :-0.011544  \r\n                                       Mean   :-0.004837  \r\n                                       3rd Qu.: 0.008676  \r\n                                       Max.   : 0.050861  \r\n    p-value           direction         Nearest_Probe     \r\n Min.   :0.0005027   Length:12561       Length:12561      \r\n 1st Qu.:0.0021486   Class :character   Class :character  \r\n Median :0.0037328   Mode  :character   Mode  :character  \r\n Mean   :0.0044511                                        \r\n 3rd Qu.:0.0066821                                        \r\n Max.   :0.0095655                                        \r\n   Distance          med_M_unexp    \r\n Length:12561       Min.   :-6.278  \r\n Class :character   1st Qu.:-5.427  \r\n Mode  :character   Median :-5.071  \r\n                    Mean   :-3.704  \r\n                    3rd Qu.:-2.424  \r\n                    Max.   : 5.042  \r\n[1] \"Scores are complete for the variable: bmicat and the p-value threshold of: 0.01\"\r\n\r\n  gress_graph(M_score_pg_1E_02)\r\n\r\n\r\n(Intercept)     bmicat1     bmicat3     bmicat4 \r\n  -5.477925    2.052503    2.507837    3.408030 \r\n                 2.5 %     97.5 %\r\n(Intercept)  -9.974812 -0.9810378\r\nbmicat1     -12.613392 16.7183980\r\nbmicat3      -5.140650 10.1563227\r\nbmicat4      -3.920999 10.7370597\r\n[1] 0.004094288\r\n          lik          infl          vari           aic \r\n-64335.112821      3.433483      3.336728 128677.092608 \r\n\r\nM_score_pg_1E_01 <- score_ts_byM_p(\"bmicat\", 1*10^-1)\r\n\r\n\r\n[1] \"Here are the CpG sites that have a p-value <=  0.1:\"\r\n# A tibble: 312 x 8\r\n   CpGs     chrom    logFC `p-value` direction  Nearest_Probe Distance\r\n   <chr>    <chr>    <dbl>     <dbl> <chr>      <chr>         <chr>   \r\n 1 cg13014~ chr11 -0.00603  0.000503 Hypomethy~ <NA>          <NA>    \r\n 2 cg26947~ chr2  -0.0118   0.000723 Hypomethy~ <NA>          <NA>    \r\n 3 cg05633~ chr2   0.0493   0.00108  Hypermeth~ <NA>          <NA>    \r\n 4 cg01054~ chr12  0.00608  0.00113  Hypermeth~ <NA>          <NA>    \r\n 5 cg12902~ chr1  -0.0327   0.00123  Hypomethy~ <NA>          <NA>    \r\n 6 cg11428~ chr22  0.0128   0.00157  Hypermeth~ <NA>          <NA>    \r\n 7 cg03719~ chr20 -0.0115   0.00160  Hypomethy~ <NA>          <NA>    \r\n 8 cg17492~ chr2  -0.0210   0.00167  Hypomethy~ <NA>          <NA>    \r\n 9 cg13782~ chr14 -0.0133   0.00170  Hypomethy~ <NA>          <NA>    \r\n10 cg02759~ chr4  -0.0682   0.00172  Hypomethy~ <NA>          <NA>    \r\n# ... with 302 more rows, and 1 more variable: CpG_site <fct>\r\n# A tibble: 1 x 2\r\n  count_0.1 total_CpGs\r\n      <int>      <int>\r\n1       312        312\r\n[1] \"The dimensions of the M-value object, subsetted by CpG sites of interest:\"\r\n[1] 237 312\r\n[1] \"The dimensions of the M-value object, with bmi information:\"\r\n[1] 237 314\r\n[1] \"The 'melted' M-value object, with bmi information:\"\r\n   SampleID         bmicat      CpG_site            M_value      \r\n Length:73944       1: 3432   Length:73944       Min.   :-9.173  \r\n Class :character   2:33072   Class :character   1st Qu.:-5.479  \r\n Mode  :character   3:17472   Mode  :character   Median :-5.011  \r\n                    4:19968                      Mean   :-3.316  \r\n                                                 3rd Qu.:-1.815  \r\n                                                 Max.   : 6.834  \r\n     CpGs              chrom               logFC          \r\n Length:73944       Length:73944       Min.   :-0.068234  \r\n Class :character   Class :character   1st Qu.:-0.011853  \r\n Mode  :character   Mode  :character   Median :-0.007394  \r\n                                       Mean   :-0.003419  \r\n                                       3rd Qu.: 0.007900  \r\n                                       Max.   : 0.050861  \r\n    p-value           direction         Nearest_Probe     \r\n Min.   :0.0005027   Length:73944       Length:73944      \r\n 1st Qu.:0.0168901   Class :character   Class :character  \r\n Median :0.0394770   Mode  :character   Mode  :character  \r\n Mean   :0.0439951                                        \r\n 3rd Qu.:0.0709698                                        \r\n Max.   :0.0995257                                        \r\n   Distance        \r\n Length:73944      \r\n Class :character  \r\n Mode  :character  \r\n                   \r\n                   \r\n                   \r\n[1] \"Check (empty) median M value tibble:\"\r\n# A tibble: 0 x 2\r\n# ... with 2 variables: CpG_site <fct>, med_M_unexp <dbl>\r\n[1] \"Here is the median M-value of normal BMI (reference group) for all CpGs in the score:\"\r\n# A tibble: 312 x 2\r\n   CpG_site   med_M_unexp\r\n   <fct>            <dbl>\r\n 1 cg13014558      0.0825\r\n 2 cg26947572     -5.20  \r\n 3 cg05633391     -5.41  \r\n 4 cg01054110      1.95  \r\n 5 cg12902497     -5.66  \r\n 6 cg11428482     -5.59  \r\n 7 cg03719642      2.19  \r\n 8 cg17492041     -5.40  \r\n 9 cg13782781     -5.06  \r\n10 cg02759110     -4.22  \r\n# ... with 302 more rows\r\n[1] \"Check that median values joined correctly:\"\r\n   SampleID         bmicat      CpG_site            M_value      \r\n Length:73944       1: 3432   Length:73944       Min.   :-9.173  \r\n Class :character   2:33072   Class :character   1st Qu.:-5.479  \r\n Mode  :character   3:17472   Mode  :character   Median :-5.011  \r\n                    4:19968                      Mean   :-3.316  \r\n                                                 3rd Qu.:-1.815  \r\n                                                 Max.   : 6.834  \r\n     CpGs              chrom               logFC          \r\n Length:73944       Length:73944       Min.   :-0.068234  \r\n Class :character   Class :character   1st Qu.:-0.011853  \r\n Mode  :character   Mode  :character   Median :-0.007394  \r\n                                       Mean   :-0.003419  \r\n                                       3rd Qu.: 0.007900  \r\n                                       Max.   : 0.050861  \r\n    p-value           direction         Nearest_Probe     \r\n Min.   :0.0005027   Length:73944       Length:73944      \r\n 1st Qu.:0.0168901   Class :character   Class :character  \r\n Median :0.0394770   Mode  :character   Mode  :character  \r\n Mean   :0.0439951                                        \r\n 3rd Qu.:0.0709698                                        \r\n Max.   :0.0995257                                        \r\n   Distance          med_M_unexp    \r\n Length:73944       Min.   :-6.368  \r\n Class :character   1st Qu.:-5.468  \r\n Mode  :character   Median :-5.087  \r\n                    Mean   :-3.312  \r\n                    3rd Qu.:-1.914  \r\n                    Max.   : 5.611  \r\n[1] \"Scores are complete for the variable: bmicat and the p-value threshold of: 0.1\"\r\n\r\n  gress_graph(M_score_pg_1E_01)\r\n\r\n\r\n(Intercept)     bmicat1     bmicat3     bmicat4 \r\n  -8.293362    6.441864    2.134842    2.712726 \r\n                2.5 %    97.5 %\r\n(Intercept) -17.08768  0.500951\r\nbmicat1     -22.23942 35.123144\r\nbmicat3     -12.82288 17.092563\r\nbmicat4     -11.62025 17.045704\r\n[1] 0.001265498\r\n          lik          infl          vari           aic \r\n-2.460468e+05  3.433483e+00  3.336728e+00  4.921005e+05 \r\n\r\n\r\nDiscussion of the results\r\nThe model with the most stringent pruning threshold has the best discrimination, with an \\(R^{2}\\) of 2.0%. Additionally, since only 2 methylation loci were included, it was the most parsimonious model as well, with an AIC of just 91.24.\r\nAdditionally, the effect estimates are credible. Children with mothers with “normal” and “overweight” BMIs have comparable slight decrease in epigenetic risk scores, whereas those who were underweight had highest risk and those who were obese had the second highest epigenetic risk scores. Perhaps there are common epigenome-wide changes in individuals in the upper and lower extremes of BMI. This might extend to help explain observations of greater risks to conception-related outcomes in women who are on the extremes: e.g. in underweight, such as low birth-weight and preterm birth, as well as the risks for obese women such as infant mortality and preterm birth (Cnattingius et al., 1998).\r\nHowever, I will caution that these results are not to be taken as truth. The effect sizes are quite small and not significant, and this is not a rigorous study, just a project. Additionally, risk scores are not to be taken for causal inference and every individual is different. Individual level outcomes may not always reflect what you would predict based on population level data.\r\nLimitations:\r\nThis was an exploratory analysis for a self-directed project. If I were doing a real study, I might consider addressing the following:\r\nI did not adjust for confounding factors in the validation set, but the effect estimates included in the risk score itself should be un-confounded, assuming the study where the summary statistics came from properly accounted for confounding. I think this is a fair assumption. Their quality control procedures were quite comprehensive!\r\nI did not account for global differences in methylation, only single site changes. The normalization steps in the publicly available studies may have diluted global changes. Additionally, if there were differences in global methylation levels that are related to differences in characteristics of the 2 populations, then I may have obtained biased results.\r\nSince I used publicly available data, I am a bit unclear about the specifics of the measurement of BMI in these cohorts. Additionally, I cannot look at other relevant exposures such as weight gain during pregnancy, so I may be missing some important information.\r\nFuture perspectives:\r\nHere are some guiding questions for projects that would help contextualize and improve my analysis:\r\nHow much does the epigenetic risk score explain independently when included in a model with other covariates?\r\nHow is the risk score associated with child health outcomes?\r\nBehavioral Risk Factors of Excessive Daytime Sleepiness in NHANES 2017-18\r\nBackground\r\nInsufficient sleep duration and quality is associated with both morbidity and mortality from cardiometabolic disorders and affects neurobehavioral functioning (Gangwesh at al., 2006; Hall et al., 2008).\r\nThe 20th century has seen a downward trend in sleep duration and quality (Bixler, 2009).\r\nStudies have identified health behaviors and personal characteristics that contribute to shortened sleep duration, such as age, race, obesity, low physical activity, heavy alcohol use, high caffeine consumption, smoking (Bixler, 2009; Phillips, 1995; Temple et al., 2017; Schoenborn & Adams, 2019; Stein & Friedmann, 2005; Kredlow, 2015).\r\nFew research studies have sought to identify whether these relationships hold when the outcome is sleep quality rather than duration.\r\nSleep quality may be different from sleep duration. The sleep cycle is complex and sleep duration is not always indicative of high-quality sleep. In addition, sufficient sleep duration may also vary depending on the individual (Bin, 2016).\r\nUnderstanding factors associated with poor sleep quality could provide insight to actionable avenues for intervention and ultimately impact quality of life, and even morbidity and mortality.\r\nStudy Design\r\nData were obtained from National Health and Nutritional Examination Survey (NHANES) 2017-2018, a cross-sectional complex survey. Home interviews and exams were conducted on a nationally representative sample of adults and children in the United States. A population-based sample was derived from a complex multistage, probability sampling design. 9,254 participants were interviewed, and 8,704 were examined. Only participants aged 18 and older were included in the analysis, resulting in a study sample size of 5,856.\r\nData\r\nSince this is a risk factor study, all exposures were considered equally with no primary exposure of interest. Potential risk factors were derived from evidence in the literature. BMI and caffeine intake were measured in the examination stage. Alcohol use, excessive daytime sleepiness, current smoking, depression score, race and ethnicity, age, and participation in moderate to vigorous exercise were all collected at the interview stage. All risk factors except for income-to-poverty ratio, were transformed into categorical variables based on literature-informed criteria and conventions.\r\nExcessive daytime sleepiness was chosen as the outcome of interest. This outcome was selected over self-reported hours of sleep because it is an indicator of sleep quality, rather than sleep duration. The question asked to participants was “In the past month, how often did {you/survey participant} feel excessively or overly sleepy during the day?” Following the convention of Lal et al., participants responded as “Often” or “Almost always” were categorized as “Yes,” and other responses were categorized as “No. This study was exploratory in nature and meant to be hypothesis-generating and replicate prior associations between behavioral risk factors and sleep quality.\r\nWrangling the data\r\nFirst, I will load in the packages that I will use for my analysis.\r\n\r\n\r\nlibrary(here)\r\n#Open foreign package to convert from XPT to CSV\r\nlibrary(foreign)\r\nlibrary(dplyr)\r\nlibrary(tidyverse, quietly = TRUE)\r\nlibrary(here)\r\nlibrary(gtsummary)\r\n\r\n\r\n\r\nNow, I will read in my datasets. I exported the data from the NHANES 2018 website and converted them to .csv files. I will load them all and combine them into a larger file. I will merge all of the component files by the individuals’ identifying number (SEQN). I decide to left join with demography file as the leftmost column, because I want to retain the denominator of individuals even if some the predictor and outcome variables are missing.\r\n\r\n\r\ntemp = list.files(\".\",\"*.csv\")\r\nmyfiles = lapply(temp, read.csv)\r\n\r\none_tmp <- myfiles[[5]] #This is the demographic dataset\r\n\r\nfor(i in c(1:4,6:8)){\r\n  one_tmp <- left_join(one_tmp, myfiles[[i]], by = \"SEQN\")\r\n}\r\n\r\n# Fix the naming of some of these variables:\r\n\r\nhead(one_tmp)\r\n\r\n\r\n  X.x  SEQN RIAGENDR RIDAGEYR RIDRETH3  WTINT2YR  WTMEC2YR SDMVPSU\r\n1   1 93703        2        2        6  9246.492  8539.731       2\r\n2   2 93704        1        2        3 37338.768 42566.615       1\r\n3   3 93705        2       66        4  8614.571  8338.420       2\r\n4   4 93706        1       18        6  8548.633  8723.440       2\r\n5   5 93707        1       13        7  6769.345  7064.610       1\r\n6   6 93708        2       66        6 13329.451 14372.489       2\r\n  SDMVSTRA INDFMPIR X.y PAQ605 PAQ620 PAQ650 PAQ665 X.x.x ALQ111\r\n1      145     5.00  NA     NA     NA     NA     NA    NA     NA\r\n2      143     5.00  NA     NA     NA     NA     NA    NA     NA\r\n3      145     0.82   1      2      2      2      1     1      1\r\n4      134       NA   2      2      2      2      1     2      2\r\n5      138     1.88  NA     NA     NA     NA     NA    NA     NA\r\n6      138     1.63   3      2      2      2      1     3      2\r\n  ALQ121 ALQ130 X.y.y BMXBMI X.x.x.x DR1TCAFF DR2TCAFF\r\n1     NA     NA     1   17.5       1       NA       NA\r\n2     NA     NA     2   15.7       2        8        6\r\n3      7      1     3   31.7       3      361      146\r\n4     NA     NA     4   21.5       4        0       NA\r\n5     NA     NA     5   18.1       5       21       10\r\n6     NA     NA     6   23.7       6       33        0\r\n  avg_mg_caffeine X.y.y.y DPQ010 DPQ020 DPQ030 DPQ040 DPQ050 DPQ060\r\n1              NA      NA     NA     NA     NA     NA     NA     NA\r\n2             7.0      NA     NA     NA     NA     NA     NA     NA\r\n3           253.5       1      0      0      0      0      0      0\r\n4              NA       2      0      0      0      0      0      0\r\n5            15.5      NA     NA     NA     NA     NA     NA     NA\r\n6            16.5       3      0      0      0      0      0      0\r\n  DPQ070 DPQ080 DPQ090 DPQ100 X.x.x.x.x SLD012 SLD013 SLQ120\r\n1     NA     NA     NA     NA        NA     NA     NA     NA\r\n2     NA     NA     NA     NA        NA     NA     NA     NA\r\n3      0      0      0     NA         1    8.0    8.0      0\r\n4      0      0      0     NA         2   10.5   11.5      1\r\n5     NA     NA     NA     NA        NA     NA     NA     NA\r\n6      0      0      0     NA         3    8.0    8.0      2\r\n  day_sleep X.y.y.y.y SMQ681\r\n1        NA        NA     NA\r\n2        NA        NA     NA\r\n3         0         1      2\r\n4         0         2      2\r\n5        NA         3      2\r\n6         0         4      2\r\n\r\none_tmp <- one_tmp %>% as_tibble() %>% select(!starts_with(\"X\"))\r\n\r\nhead(one_tmp)\r\n\r\n\r\n# A tibble: 6 x 35\r\n   SEQN RIAGENDR RIDAGEYR RIDRETH3 WTINT2YR WTMEC2YR SDMVPSU SDMVSTRA\r\n  <dbl>    <int>    <int>    <int>    <dbl>    <dbl>   <int>    <int>\r\n1 93703        2        2        6    9246.    8540.       2      145\r\n2 93704        1        2        3   37339.   42567.       1      143\r\n3 93705        2       66        4    8615.    8338.       2      145\r\n4 93706        1       18        6    8549.    8723.       2      134\r\n5 93707        1       13        7    6769.    7065.       1      138\r\n6 93708        2       66        6   13329.   14372.       2      138\r\n# ... with 27 more variables: INDFMPIR <dbl>, PAQ605 <int>,\r\n#   PAQ620 <int>, PAQ650 <int>, PAQ665 <int>, ALQ111 <int>,\r\n#   ALQ121 <int>, ALQ130 <int>, BMXBMI <dbl>, DR1TCAFF <int>,\r\n#   DR2TCAFF <int>, avg_mg_caffeine <dbl>, DPQ010 <int>,\r\n#   DPQ020 <int>, DPQ030 <int>, DPQ040 <int>, DPQ050 <int>,\r\n#   DPQ060 <int>, DPQ070 <int>, DPQ080 <int>, DPQ090 <int>,\r\n#   DPQ100 <int>, SLD012 <dbl>, SLD013 <dbl>, SLQ120 <int>, ...\r\n\r\n# Worked beautifully!\r\n\r\n\r\n\r\nSome of the data are labeled as numeric values if they were missing. Referring to NHANES documentation, you can see which numbers correspond to missing data, depending on the variable. It would be a good idea to convert them into simple NAs.\r\n\r\n\r\none_tmp <- one_tmp %>%\r\n   mutate(across(starts_with('ALQ'), ~ case_when(. ==  77 ~ NA_integer_, . == 99 ~ NA_integer_, . == 777 ~ NA_integer_, . == 999 ~ NA_integer_, TRUE ~ as.integer(.))))\r\n\r\n\r\n#For activity variables, change to missing if \"Refused\" or \"Don't Know\"\r\n\r\none_tmp <- one_tmp %>%\r\n   mutate(across(starts_with('PAQ'), ~ case_when(. ==  9 ~ NA_integer_, TRUE ~ as.integer(.))))\r\n\r\n\r\n#For depression variables, change to missing if \"Refused\" or \"Don't Know\"\r\n\r\none_tmp <- one_tmp %>%\r\n   mutate(across(starts_with('DPQ'), ~ case_when(. ==  7 ~ NA_integer_, . ==  9 ~ NA_integer_, TRUE ~ as.integer(.))))\r\n\r\nsummary(one_tmp) # Looking better. \r\n\r\n\r\n      SEQN           RIAGENDR        RIDAGEYR        RIDRETH3    \r\n Min.   : 93703   Min.   :1.000   Min.   : 0.00   Min.   :1.000  \r\n 1st Qu.: 96016   1st Qu.:1.000   1st Qu.:11.00   1st Qu.:3.000  \r\n Median : 98330   Median :2.000   Median :31.00   Median :3.000  \r\n Mean   : 98330   Mean   :1.508   Mean   :34.33   Mean   :3.497  \r\n 3rd Qu.:100643   3rd Qu.:2.000   3rd Qu.:58.00   3rd Qu.:4.000  \r\n Max.   :102956   Max.   :2.000   Max.   :80.00   Max.   :7.000  \r\n                                                                 \r\n    WTINT2YR         WTMEC2YR         SDMVPSU         SDMVSTRA  \r\n Min.   :  2571   Min.   :     0   Min.   :1.000   Min.   :134  \r\n 1st Qu.: 13074   1st Qu.: 12347   1st Qu.:1.000   1st Qu.:137  \r\n Median : 21099   Median : 21060   Median :2.000   Median :141  \r\n Mean   : 34671   Mean   : 34671   Mean   :1.518   Mean   :141  \r\n 3rd Qu.: 36923   3rd Qu.: 37562   3rd Qu.:2.000   3rd Qu.:145  \r\n Max.   :433085   Max.   :419763   Max.   :2.000   Max.   :148  \r\n                                                                \r\n    INDFMPIR         PAQ605          PAQ620          PAQ650     \r\n Min.   :0.000   Min.   :1.000   Min.   :1.000   Min.   :1.000  \r\n 1st Qu.:1.040   1st Qu.:2.000   1st Qu.:1.000   1st Qu.:2.000  \r\n Median :1.920   Median :2.000   Median :2.000   Median :2.000  \r\n Mean   :2.376   Mean   :1.763   Mean   :1.583   Mean   :1.755  \r\n 3rd Qu.:3.690   3rd Qu.:2.000   3rd Qu.:2.000   3rd Qu.:2.000  \r\n Max.   :5.000   Max.   :2.000   Max.   :2.000   Max.   :2.000  \r\n NA's   :1231    NA's   :3404    NA's   :3403    NA's   :3398   \r\n     PAQ665          ALQ111          ALQ121           ALQ130      \r\n Min.   :1.000   Min.   :1.000   Min.   : 0.000   Min.   : 1.000  \r\n 1st Qu.:1.000   1st Qu.:1.000   1st Qu.: 1.000   1st Qu.: 1.000  \r\n Median :2.000   Median :1.000   Median : 5.000   Median : 2.000  \r\n Mean   :1.606   Mean   :1.114   Mean   : 4.911   Mean   : 2.517  \r\n 3rd Qu.:2.000   3rd Qu.:1.000   3rd Qu.: 8.000   3rd Qu.: 3.000  \r\n Max.   :2.000   Max.   :2.000   Max.   :10.000   Max.   :15.000  \r\n NA's   :3398    NA's   :4124    NA's   :4713     NA's   :5765    \r\n     BMXBMI         DR1TCAFF         DR2TCAFF       avg_mg_caffeine  \r\n Min.   :12.30   Min.   :   0.0   Min.   :   0.00   Min.   :   0.00  \r\n 1st Qu.:20.40   1st Qu.:   1.0   1st Qu.:   0.00   1st Qu.:   2.50  \r\n Median :25.80   Median :  35.0   Median :  26.00   Median :  40.00  \r\n Mean   :26.58   Mean   : 100.2   Mean   :  88.68   Mean   :  94.79  \r\n 3rd Qu.:31.30   3rd Qu.: 143.0   3rd Qu.: 127.00   3rd Qu.: 135.50  \r\n Max.   :86.20   Max.   :4320.0   Max.   :5040.00   Max.   :4680.00  \r\n NA's   :1249    NA's   :1770     NA's   :2752      NA's   :2763     \r\n     DPQ010          DPQ020         DPQ030          DPQ040     \r\n Min.   :0.000   Min.   :0.00   Min.   :0.000   Min.   :0.000  \r\n 1st Qu.:0.000   1st Qu.:0.00   1st Qu.:0.000   1st Qu.:0.000  \r\n Median :0.000   Median :0.00   Median :0.000   Median :0.000  \r\n Mean   :0.387   Mean   :0.35   Mean   :0.636   Mean   :0.752  \r\n 3rd Qu.:1.000   3rd Qu.:0.00   3rd Qu.:1.000   3rd Qu.:1.000  \r\n Max.   :3.000   Max.   :3.00   Max.   :3.000   Max.   :3.000  \r\n NA's   :4168    NA's   :4167   NA's   :4168    NA's   :4169   \r\n     DPQ050          DPQ060          DPQ070          DPQ080     \r\n Min.   :0.000   Min.   :0.000   Min.   :0.000   Min.   :0.000  \r\n 1st Qu.:0.000   1st Qu.:0.000   1st Qu.:0.000   1st Qu.:0.000  \r\n Median :0.000   Median :0.000   Median :0.000   Median :0.000  \r\n Mean   :0.392   Mean   :0.244   Mean   :0.264   Mean   :0.168  \r\n 3rd Qu.:1.000   3rd Qu.:0.000   3rd Qu.:0.000   3rd Qu.:0.000  \r\n Max.   :3.000   Max.   :3.000   Max.   :3.000   Max.   :3.000  \r\n NA's   :4167    NA's   :4171    NA's   :4168    NA's   :4170   \r\n     DPQ090          DPQ100          SLD012           SLD013      \r\n Min.   :0.000   Min.   :0.000   Min.   : 2.000   Min.   : 2.000  \r\n 1st Qu.:0.000   1st Qu.:0.000   1st Qu.: 7.000   1st Qu.: 7.000  \r\n Median :0.000   Median :0.000   Median : 8.000   Median : 8.000  \r\n Mean   :0.053   Mean   :0.321   Mean   : 7.659   Mean   : 8.378  \r\n 3rd Qu.:0.000   3rd Qu.:1.000   3rd Qu.: 8.500   3rd Qu.: 9.500  \r\n Max.   :3.000   Max.   :3.000   Max.   :14.000   Max.   :14.000  \r\n NA's   :4169    NA's   :5895    NA's   :3141     NA's   :3150    \r\n     SLQ120        day_sleep          SMQ681    \r\n Min.   :0.000   Min.   :0.0000   Min.   :1.00  \r\n 1st Qu.:1.000   1st Qu.:0.0000   1st Qu.:2.00  \r\n Median :2.000   Median :0.0000   Median :2.00  \r\n Mean   :1.786   Mean   :0.2587   Mean   :1.81  \r\n 3rd Qu.:3.000   3rd Qu.:1.0000   3rd Qu.:2.00  \r\n Max.   :9.000   Max.   :1.0000   Max.   :2.00  \r\n NA's   :3093    NA's   :3093     NA's   :3301  \r\n\r\nCategorize variables based on clinically meaningful guidelines\r\nNow I create a summary depression score by summing all question responses except for DPQ100, which was more of a measure of life quality than magnitude of depression.\r\n\r\n\r\none_tmp <- one_tmp %>% mutate(depress_score = rowSums(select(one_tmp, starts_with(\"DPQ\")& !ends_with(\"100\"))))\r\n\r\n\r\n\r\nNow I turn depression into a categorical variable\r\nDepression is categorized based on guidelines:\r\nNo depression: no_dep = 1 if total score <5; 0 if total score >= 5.\r\nMild depression: mild_dep = 1 if total score <10 and >4; 0 otherwise.\r\nModerate depression: mod_dep = 1 if total score >9 and <15; 0 therwise\r\nModerate to severe: mod_sev_dep = 1 if total score >14 and <20; 0 otherwise\r\nSevere: sev_dep = 1 if total score >19; 0 otherwise\r\n\r\n\r\none_tmp = one_tmp %>% mutate(depress_cat = cut(depress_score, breaks = c(-Inf,4.5,9.5,14.5,19.5,Inf), labels = c('nodep','mild_dep','mod_dep','mod_sev_dep','sev_dep'))\r\n)\r\n\r\n\r\n\r\nCreate race and Hispanic ethnicity categories. Combined Non-Hispanic white and Non-Hispanic other and multiple races, to approximate the sampling domains.\r\n\r\n\r\none_tmp = one_tmp %>% mutate(\r\n  race1 = factor(c(3, 3, 4, 1, NA, 2, 4)[RIDRETH3],\r\n                 labels = c('NH Black','NH Asian', 'Hispanic', 'NH White and Other')),\r\n  # Create race and Hispanic ethnicity categories for hypertension analysis \r\n  raceEthCat= factor(c(4, 4, 1, 2, NA, 3, 5)[RIDRETH3],\r\n                     labels = c('NH White', 'NH Black', 'NH Asian', 'Hispanic', 'NH Other/Multiple')),\r\n  # Create age categories for adults aged 18 and over: ages 18-39, 40-59, 60 and over\r\n  ageCat_18 = cut(RIDAGEYR, breaks = c(17, 39, 59, Inf),\r\n                  labels = c('18-39','40-59','60+'))\r\n)\r\n\r\n\r\n\r\nRegular moderate or vigorous activity reported? 1 = yes; 0 = no\r\n\r\n\r\none_tmp <-  mutate(one_tmp,activity=ifelse(PAQ605==1|PAQ620==1|PAQ650==1|PAQ665==1, 1, 0))\r\n\r\n\r\n\r\nRecommended caffeine dose is 400 mg. Dichotomize to above and below that threshold:\r\n\r\n\r\none_tmp <- mutate(one_tmp, hi_caffeine=ifelse(avg_mg_caffeine>400.0,1,0))\r\n\r\n\r\n\r\nThere are standards for categorizing BMI. I will carry them out here:\r\n\r\n\r\none_tmp = one_tmp %>% mutate(BMI_cat = cut(BMXBMI, breaks = c(-Inf,18.49,24.9, 29.9,Inf), labels = c('underweight','normal','overweight','obese'))\r\n)\r\n\r\n\r\n\r\nCategorize alcohol use\r\nAbove 2 drinks a day for men or above 1 drink a day for women are considered in excess of “moderate drinking”. https://www.niaaa.nih.gov/alcohol-health/overview-alcohol-consumption/moderate-binge-drinking\r\nMust account for those who responded that they were non-drinkers. Re-code alcohol consumption accounting for those who don’t drink to correct missingness\r\n\r\n\r\none_tmp <-  mutate(one_tmp, \r\n                   heavy_drink = ifelse((ALQ130>2 & RIAGENDR == 1) \r\n                                        | (ALQ130>1 & RIAGENDR == 2),1, 0))\r\none_tmp = one_tmp %>% mutate(heavy_drink2 = ifelse(ALQ111==2 | ALQ121==0, 0, heavy_drink))\r\n\r\n\r\n\r\nI will filter the population to ages 18 and above and save in a new dataset for analysis. I do this for 2 reasons. First, I would like the analytic population to be adults only. Second, the measurement of variables in NHANES is different in children.\r\n\r\n\r\nunweighted_data <- filter(one_tmp, RIDAGEYR >=18)\r\n\r\n\r\n\r\nCorrecting for missingness\r\nHow many are missing a the conventional 10% cutoff?\r\n\r\n\r\nmissing <- colSums(is.na(unweighted_data))# Number of missing per variable\r\n\r\nmissing <- missing/(length(unweighted_data$SEQN))\r\n\r\nmissing\r\n\r\n\r\n           SEQN        RIAGENDR        RIDAGEYR        RIDRETH3 \r\n   0.0000000000    0.0000000000    0.0000000000    0.0000000000 \r\n       WTINT2YR        WTMEC2YR         SDMVPSU        SDMVSTRA \r\n   0.0000000000    0.0000000000    0.0000000000    0.0000000000 \r\n       INDFMPIR          PAQ605          PAQ620          PAQ650 \r\n   0.1425887978    0.0010245902    0.0008538251    0.0000000000 \r\n         PAQ665          ALQ111          ALQ121          ALQ130 \r\n   0.0000000000    0.1239754098    0.2245560109    0.4042008197 \r\n         BMXBMI        DR1TCAFF        DR2TCAFF avg_mg_caffeine \r\n   0.0720628415    0.1490778689    0.2590505464    0.2590505464 \r\n         DPQ010          DPQ020          DPQ030          DPQ040 \r\n   0.1314890710    0.1313183060    0.1314890710    0.1316598361 \r\n         DPQ050          DPQ060          DPQ070          DPQ080 \r\n   0.1313183060    0.1320013661    0.1314890710    0.1318306011 \r\n         DPQ090          DPQ100          SLD012          SLD013 \r\n   0.1316598361    0.4264002732    0.0080259563    0.0095628415 \r\n         SLQ120       day_sleep          SMQ681   depress_score \r\n   0.0000000000    0.0000000000    0.1236338798    0.1345628415 \r\n    depress_cat           race1      raceEthCat       ageCat_18 \r\n   0.1345628415    0.0000000000    0.0000000000    0.0000000000 \r\n       activity     hi_caffeine         BMI_cat     heavy_drink \r\n   0.0011953552    0.2590505464    0.0720628415    0.4042008197 \r\n   heavy_drink2 \r\n   0.1256830601 \r\n\r\nMissingness: No individuals were missing the outcome. Missingness was below 15% for all covariates except for high caffeine intake, which was missing at a rate of 26%.\r\nNow that we have cleaned the NHANES data to our liking, it is time to conduct the analysis.\r\nLet’s load the packages that we will need. Must load the tidyverse last because both the dplyr package from the tidyverse and the MASS package have a select() function and the one loaded last is the one that will be used.\r\n\r\n\r\nif(!require(car)){   # for added variable plots, VIF\r\n    install.packages(\"car\")\r\n    library(car)\r\n}\r\nif(!require(sandwich)){   # for robust linear regression\r\n    install.packages(\"sandwich\")\r\n    library(sandwich)\r\n}\r\nif(!require(GGally)){   # for fancier scatterplot matrices\r\n    install.packages(\"GGally\")\r\n    library(GGally)\r\n}\r\n  \r\nif(!require(broom)){   # for tidy model output using tidy() function\r\n    install.packages(\"broom\")\r\n    library(broom)\r\n}  \r\n \r\nif(!require(lmtest)){   # coefficient test for robust variance\r\n    install.packages(\"lmtest\")\r\n    library(lmtest)\r\n} \r\n\r\nif(!require(tidyverse)){   # general functions for working with data\r\n    install.packages(\"tidyverse\")\r\n    library(tidyverse)\r\n} \r\n\r\nif(!require(survey)){   # general functions for working with data\r\n    install.packages(\"survey\")\r\n    library(survey)\r\n} \r\n\r\n\r\n\r\nSubset the dataset to individuals 18 and older, because that is the population we would like to make inferences to.\r\n\r\n\r\ndata <- mutate(one_tmp,inAnalysis=(RIDAGEYR >=18))\r\n\r\n# explore data \r\nsummary(data)\r\n\r\n\r\n      SEQN           RIAGENDR        RIDAGEYR        RIDRETH3    \r\n Min.   : 93703   Min.   :1.000   Min.   : 0.00   Min.   :1.000  \r\n 1st Qu.: 96016   1st Qu.:1.000   1st Qu.:11.00   1st Qu.:3.000  \r\n Median : 98330   Median :2.000   Median :31.00   Median :3.000  \r\n Mean   : 98330   Mean   :1.508   Mean   :34.33   Mean   :3.497  \r\n 3rd Qu.:100643   3rd Qu.:2.000   3rd Qu.:58.00   3rd Qu.:4.000  \r\n Max.   :102956   Max.   :2.000   Max.   :80.00   Max.   :7.000  \r\n                                                                 \r\n    WTINT2YR         WTMEC2YR         SDMVPSU         SDMVSTRA  \r\n Min.   :  2571   Min.   :     0   Min.   :1.000   Min.   :134  \r\n 1st Qu.: 13074   1st Qu.: 12347   1st Qu.:1.000   1st Qu.:137  \r\n Median : 21099   Median : 21060   Median :2.000   Median :141  \r\n Mean   : 34671   Mean   : 34671   Mean   :1.518   Mean   :141  \r\n 3rd Qu.: 36923   3rd Qu.: 37562   3rd Qu.:2.000   3rd Qu.:145  \r\n Max.   :433085   Max.   :419763   Max.   :2.000   Max.   :148  \r\n                                                                \r\n    INDFMPIR         PAQ605          PAQ620          PAQ650     \r\n Min.   :0.000   Min.   :1.000   Min.   :1.000   Min.   :1.000  \r\n 1st Qu.:1.040   1st Qu.:2.000   1st Qu.:1.000   1st Qu.:2.000  \r\n Median :1.920   Median :2.000   Median :2.000   Median :2.000  \r\n Mean   :2.376   Mean   :1.763   Mean   :1.583   Mean   :1.755  \r\n 3rd Qu.:3.690   3rd Qu.:2.000   3rd Qu.:2.000   3rd Qu.:2.000  \r\n Max.   :5.000   Max.   :2.000   Max.   :2.000   Max.   :2.000  \r\n NA's   :1231    NA's   :3404    NA's   :3403    NA's   :3398   \r\n     PAQ665          ALQ111          ALQ121           ALQ130      \r\n Min.   :1.000   Min.   :1.000   Min.   : 0.000   Min.   : 1.000  \r\n 1st Qu.:1.000   1st Qu.:1.000   1st Qu.: 1.000   1st Qu.: 1.000  \r\n Median :2.000   Median :1.000   Median : 5.000   Median : 2.000  \r\n Mean   :1.606   Mean   :1.114   Mean   : 4.911   Mean   : 2.517  \r\n 3rd Qu.:2.000   3rd Qu.:1.000   3rd Qu.: 8.000   3rd Qu.: 3.000  \r\n Max.   :2.000   Max.   :2.000   Max.   :10.000   Max.   :15.000  \r\n NA's   :3398    NA's   :4124    NA's   :4713     NA's   :5765    \r\n     BMXBMI         DR1TCAFF         DR2TCAFF       avg_mg_caffeine  \r\n Min.   :12.30   Min.   :   0.0   Min.   :   0.00   Min.   :   0.00  \r\n 1st Qu.:20.40   1st Qu.:   1.0   1st Qu.:   0.00   1st Qu.:   2.50  \r\n Median :25.80   Median :  35.0   Median :  26.00   Median :  40.00  \r\n Mean   :26.58   Mean   : 100.2   Mean   :  88.68   Mean   :  94.79  \r\n 3rd Qu.:31.30   3rd Qu.: 143.0   3rd Qu.: 127.00   3rd Qu.: 135.50  \r\n Max.   :86.20   Max.   :4320.0   Max.   :5040.00   Max.   :4680.00  \r\n NA's   :1249    NA's   :1770     NA's   :2752      NA's   :2763     \r\n     DPQ010          DPQ020         DPQ030          DPQ040     \r\n Min.   :0.000   Min.   :0.00   Min.   :0.000   Min.   :0.000  \r\n 1st Qu.:0.000   1st Qu.:0.00   1st Qu.:0.000   1st Qu.:0.000  \r\n Median :0.000   Median :0.00   Median :0.000   Median :0.000  \r\n Mean   :0.387   Mean   :0.35   Mean   :0.636   Mean   :0.752  \r\n 3rd Qu.:1.000   3rd Qu.:0.00   3rd Qu.:1.000   3rd Qu.:1.000  \r\n Max.   :3.000   Max.   :3.00   Max.   :3.000   Max.   :3.000  \r\n NA's   :4168    NA's   :4167   NA's   :4168    NA's   :4169   \r\n     DPQ050          DPQ060          DPQ070          DPQ080     \r\n Min.   :0.000   Min.   :0.000   Min.   :0.000   Min.   :0.000  \r\n 1st Qu.:0.000   1st Qu.:0.000   1st Qu.:0.000   1st Qu.:0.000  \r\n Median :0.000   Median :0.000   Median :0.000   Median :0.000  \r\n Mean   :0.392   Mean   :0.244   Mean   :0.264   Mean   :0.168  \r\n 3rd Qu.:1.000   3rd Qu.:0.000   3rd Qu.:0.000   3rd Qu.:0.000  \r\n Max.   :3.000   Max.   :3.000   Max.   :3.000   Max.   :3.000  \r\n NA's   :4167    NA's   :4171    NA's   :4168    NA's   :4170   \r\n     DPQ090          DPQ100          SLD012           SLD013      \r\n Min.   :0.000   Min.   :0.000   Min.   : 2.000   Min.   : 2.000  \r\n 1st Qu.:0.000   1st Qu.:0.000   1st Qu.: 7.000   1st Qu.: 7.000  \r\n Median :0.000   Median :0.000   Median : 8.000   Median : 8.000  \r\n Mean   :0.053   Mean   :0.321   Mean   : 7.659   Mean   : 8.378  \r\n 3rd Qu.:0.000   3rd Qu.:1.000   3rd Qu.: 8.500   3rd Qu.: 9.500  \r\n Max.   :3.000   Max.   :3.000   Max.   :14.000   Max.   :14.000  \r\n NA's   :4169    NA's   :5895    NA's   :3141     NA's   :3150    \r\n     SLQ120        day_sleep          SMQ681     depress_score   \r\n Min.   :0.000   Min.   :0.0000   Min.   :1.00   Min.   : 0.000  \r\n 1st Qu.:1.000   1st Qu.:0.0000   1st Qu.:2.00   1st Qu.: 0.000  \r\n Median :2.000   Median :0.0000   Median :2.00   Median : 2.000  \r\n Mean   :1.786   Mean   :0.2587   Mean   :1.81   Mean   : 3.241  \r\n 3rd Qu.:3.000   3rd Qu.:1.0000   3rd Qu.:2.00   3rd Qu.: 5.000  \r\n Max.   :9.000   Max.   :1.0000   Max.   :2.00   Max.   :25.000  \r\n NA's   :3093    NA's   :3093     NA's   :3301   NA's   :4186    \r\n      depress_cat                  race1     \r\n nodep      :3772   NH Black          :2115  \r\n mild_dep   : 837   NH Asian          :1168  \r\n mod_dep    : 292   Hispanic          :2187  \r\n mod_sev_dep: 124   NH White and Other:3784  \r\n sev_dep    :  43                            \r\n NA's       :4186                            \r\n                                             \r\n             raceEthCat   ageCat_18       activity    \r\n NH White         :3150   18-39:1974   Min.   :0.000  \r\n NH Black         :2115   40-59:1732   1st Qu.:0.000  \r\n NH Asian         :1168   60+  :2150   Median :1.000  \r\n Hispanic         :2187   NA's :3398   Mean   :0.675  \r\n NH Other/Multiple: 634                3rd Qu.:1.000  \r\n                                       Max.   :1.000  \r\n                                       NA's   :3405   \r\n  hi_caffeine           BMI_cat      heavy_drink     heavy_drink2  \r\n Min.   :0.000   underweight:1449   Min.   :0.000   Min.   :0.000  \r\n 1st Qu.:0.000   normal     :2191   1st Qu.:0.000   1st Qu.:0.000  \r\n Median :0.000   overweight :1957   Median :0.000   Median :0.000  \r\n Mean   :0.034   obese      :2408   Mean   :0.482   Mean   :0.329  \r\n 3rd Qu.:0.000   NA's       :1249   3rd Qu.:1.000   3rd Qu.:1.000  \r\n Max.   :1.000                      Max.   :1.000   Max.   :1.000  \r\n NA's   :2763                       NA's   :5765    NA's   :4134   \r\n inAnalysis     \r\n Mode :logical  \r\n FALSE:3398     \r\n TRUE :5856     \r\n                \r\n                \r\n                \r\n                \r\n\r\nNow, we would like to specify the categorical data as either nominal or ordinal data for our models. BMI categories, race, and age groups should be considered separately as nominal categories. Depression questionnaire scores have a natural ordered relationship, so we will specify the depression variable as an ordinal variable.\r\nWe must also set a reference group for the generalized linear models to improve our interpretations.\r\n\r\n\r\n#Nominal variables \r\n\r\ndata$BMI_cat <- factor(data$BMI_cat, ordered = FALSE )\r\ndata$raceEthCat <- factor(data$raceEthCat, ordered = FALSE )\r\ndata$ageCat_18 <- factor(data$ageCat_18, ordered = FALSE)\r\n\r\n#Set reference groups for statistical models\r\ndata <- within(data, raceEthCat <- relevel(raceEthCat, ref = \"NH White\"))\r\ndata <- within(data, BMI_cat <- relevel(BMI_cat, ref = \"normal\"))\r\ndata <- within(data, ageCat_18 <- relevel(ageCat_18, ref = \"18-39\"))\r\n\r\n# Ordinal variables\r\ndata$depress_cat <- ordered(data$depress_cat, levels = c(\"nodep\",\"mild_dep\",\"mod_dep\",\"mod_sev_dep\",\"sev_dep\"))\r\n\r\n\r\n\r\nTable 1\r\nI will make a table of descriptive statistics, stratified by the outcome, daytime sleepiness.\r\n\r\n\r\nlibrary(tableone)\r\n\r\nlistVars <- c(\"RIAGENDR\", \"ageCat_18\", \"INDFMPIR\", \"SMQ681\", \"raceEthCat\", \"activity\", \"hi_caffeine\", \"BMI_cat\", \"heavy_drink2\", \"depress_cat\")\r\ncatVars <- c(\"RIAGENDR\", \"ageCat_18\", \"SMQ681\", \"raceEthCat\", \"activity\", \"hi_caffeine\", \"BMI_cat\", \"heavy_drink2\", \"depress_cat\")\r\n\r\ntable1 <- CreateTableOne(vars = listVars, data = unweighted_data, factorVars = catVars, strata=c(\"day_sleep\"))\r\ndotable1 <- print(table1, quote=TRUE, noSpaces=TRUE)\r\n\r\n\r\n                        \"Stratified by day_sleep\"\r\n \"\"                      \"0\"           \"1\"           \"p\"      \"test\"\r\n  \"n\"                    \"4339\"        \"1517\"        \"\"       \"\"    \r\n  \"RIAGENDR = 2 (%)\"     \"2167 (49.9)\" \"849 (56.0)\"  \"<0.001\" \"\"    \r\n  \"ageCat_18 (%)\"        \"\"            \"\"            \"0.001\"  \"\"    \r\n  \"   18-39\"             \"1405 (32.4)\" \"569 (37.5)\"  \"\"       \"\"    \r\n  \"   40-59\"             \"1322 (30.5)\" \"410 (27.0)\"  \"\"       \"\"    \r\n  \"   60+\"               \"1612 (37.2)\" \"538 (35.5)\"  \"\"       \"\"    \r\n  \"INDFMPIR (mean (SD))\" \"2.60 (1.62)\" \"2.31 (1.57)\" \"<0.001\" \"\"    \r\n  \"SMQ681 = 2 (%)\"       \"3015 (79.5)\" \"1013 (75.5)\" \"0.003\"  \"\"    \r\n  \"raceEthCat (%)\"       \"\"            \"\"            \"<0.001\" \"\"    \r\n  \"   NH White\"          \"1342 (30.9)\" \"690 (45.5)\"  \"\"       \"\"    \r\n  \"   NH Black\"          \"1033 (23.8)\" \"310 (20.4)\"  \"\"       \"\"    \r\n  \"   NH Asian\"          \"729 (16.8)\"  \"120 (7.9)\"   \"\"       \"\"    \r\n  \"   Hispanic\"          \"1031 (23.8)\" \"304 (20.0)\"  \"\"       \"\"    \r\n  \"   NH Other/Multiple\" \"204 (4.7)\"   \"93 (6.1)\"    \"\"       \"\"    \r\n  \"activity = 1 (%)\"     \"2942 (67.9)\" \"1006 (66.4)\" \"0.325\"  \"\"    \r\n  \"hi_caffeine = 1 (%)\"  \"139 (4.4)\"   \"81 (7.0)\"    \"0.001\"  \"\"    \r\n  \"BMI_cat (%)\"          \"\"            \"\"            \"<0.001\" \"\"    \r\n  \"   underweight\"       \"76 (1.9)\"    \"23 (1.6)\"    \"\"       \"\"    \r\n  \"   normal\"            \"1074 (26.7)\" \"298 (21.1)\"  \"\"       \"\"    \r\n  \"   overweight\"        \"1333 (33.2)\" \"394 (27.9)\"  \"\"       \"\"    \r\n  \"   obese\"             \"1538 (38.2)\" \"698 (49.4)\"  \"\"       \"\"    \r\n  \"heavy_drink2 = 1 (%)\" \"1180 (31.2)\" \"503 (37.6)\"  \"<0.001\" \"\"    \r\n  \"depress_cat (%)\"      \"\"            \"\"            \"<0.001\" \"\"    \r\n  \"   nodep\"             \"3093 (82.5)\" \"679 (51.4)\"  \"\"       \"\"    \r\n  \"   mild_dep\"          \"456 (12.2)\"  \"381 (28.8)\"  \"\"       \"\"    \r\n  \"   mod_dep\"           \"134 (3.6)\"   \"158 (12.0)\"  \"\"       \"\"    \r\n  \"   mod_sev_dep\"       \"48 (1.3)\"    \"76 (5.8)\"    \"\"       \"\"    \r\n  \"   sev_dep\"           \"16 (0.4)\"    \"27 (2.0)\"    \"\"       \"\"    \r\n\r\nFigure 1: Caffeine intake and Daytime Sleepiness\r\n\r\n\r\n#png(\"Barplot Caffeine.png\")\r\ncounts <- table(unweighted_data$hi_caffeine, unweighted_data$day_sleep)\r\nbarplot(counts, main=\"High Caffeine Intake by Daytime Sleepiness\",\r\n        ylab = \"Number of Individuals\",\r\n        xlab=\"Daytime Sleepiness\", col=c(\"darkblue\",\"purple\"),\r\n        legend = c(\"Low Caffeine Intake\", \"High Caffeine Intake\"), beside=TRUE)\r\n\r\n\r\n\r\n#dev.off()\r\n\r\n\r\n\r\nFigure 2: Dperession and Daytime Sleepiness\r\n\r\n\r\n#png(\"Barplot Depression.png\")\r\ncounts <- table(unweighted_data$depress_cat, unweighted_data$day_sleep)\r\nbarplot(counts, main=\"Depression Category Distribution by Daytime Sleepiness\",\r\n        ylab = \"Number of Individuals\",\r\n        xlab=\"Daytime Sleepiness\", col=c(\"darkblue\",\"purple\",\"orange\",\"yellow\",\"lightblue\"),\r\n        legend = c(\"No Depression\", \"Mild Depression\", \"Moderate Depression\", \"Moderate/severe Depression\", \"Severe Depression\"), beside=TRUE)\r\n\r\n\r\n\r\n#dev.off()\r\n\r\n\r\n\r\nStatistical Methods\r\nLet’s develop a pipeline for our statistical analyses!\r\nPart a: Scatterplot matrices\r\nPart b: Fit weighted and unweighted SLRs\r\nPart c: Fit initial weighted and unweighted MLR model using all predictors\r\nPart d: Best subset model selection and human-selected model\r\nPart e. Compare model AICs and goodness of fit\r\nPart f: Check model: Analysis of Residuals\r\nPart f-1: Plot person residuals -vs- predicted values\r\nPart f-2: Boxplot and list outlier studentized residuals\r\nPart g: Check model: leverage boxplots\r\nPart h: Check model: influence\r\nPart h-1: Make boxplot and list outliers for influence\r\nPart h-2: Leverage -vs- residual squared (L-R) plot\r\nPart i: Sensitivity analysis: Re-fit without influential points\r\nPart j: Check for multi-collinearity using variance inflation factors\r\n\r\nPart a: Scatterplot matrices\r\nUsing the ggpairs() function, which is nice for getting a quick scatterplot matrix plot\r\nWe must first created an unweighted dataset of those >=18.\r\nThen we will make two separate scatterplot matrices. We must do this because if we make one matrix, it will be way too large and difficult to read. First we will make one of personal characteristics, and second, we will make one of lifestyle/behavioral characteristics.\r\n\r\n\r\nunweighted_data <- filter(data, RIDAGEYR >=18)\r\n\r\n#pdf(\"scatterplot_matrices_person.pdf\")\r\nunweighted_data %>%\r\n  dplyr::select(RIAGENDR, RIDAGEYR, INDFMPIR,depress_score,BMXBMI) %>%\r\n  pairs(upper.panel=NULL)\r\n\r\n\r\n\r\n#dev.off()\r\n\r\n#pdf(\"scatterplot_matrices_behavior.pdf\")\r\nunweighted_data %>%\r\n  dplyr::select(avg_mg_caffeine,SMQ681,ALQ130,activity) %>%\r\n  pairs(upper.panel=NULL)\r\n\r\n\r\n\r\n#dev.off()\r\n\r\n\r\n\r\nThere is no clear correlation between X’s.\r\nPart b: Fit weighted and unweighted SLRs\r\nCreate a survey weight object\r\n\r\n\r\nNHANES_all <- svydesign(data=data, id=~SDMVPSU, strata=~SDMVSTRA, weights=~WTINT2YR, nest=TRUE)\r\nNHANES_all_MEC <- svydesign(data=data, id=~SDMVPSU, strata=~SDMVSTRA, weights=~WTMEC2YR, nest=TRUE)\r\n\r\nNHANES <- subset(NHANES_all, inAnalysis==1)\r\nNHANES_MEC <- subset(NHANES_all_MEC, inAnalysis==1)\r\n\r\n\r\n\r\nFit the weighted univariate models and store the results. We are calculating the change in log prevalence odds of daytime sleepiness, our outcome, among levels of the “exposures”. Our exposures of interest are sex, age groups, income, smoking, race/ethnicity, any activity, high caffeine intake, BMI categories, heavy drinking, and ordinal depression scores. Log-binomial regression is used to estimate crude associations.\r\n\r\n\r\nmodel_1w <- svyglm(day_sleep~RIAGENDR, design=NHANES, family=quasibinomial(link=\"log\"))\r\nmodel_2w <- svyglm(day_sleep~ageCat_18, design=NHANES, family=quasibinomial(link=\"log\"))\r\nmodel_3w <- svyglm(day_sleep~INDFMPIR, design=NHANES, family=quasibinomial(link=\"log\"))\r\nmodel_4w <- svyglm(day_sleep~SMQ681, design=NHANES, family=quasibinomial(link=\"log\"))\r\nmodel_5w <- svyglm(day_sleep~raceEthCat, design=NHANES, family=quasibinomial(link=\"log\"))\r\nmodel_6w <- svyglm(day_sleep~activity, design=NHANES, family=quasibinomial(link=\"log\"))\r\nmodel_7w <- svyglm(day_sleep~hi_caffeine, design=NHANES_MEC, family=quasibinomial(link=\"log\"))\r\nmodel_8w <- svyglm(day_sleep~BMI_cat, design=NHANES_MEC, family=quasibinomial(link=\"log\"))\r\nmodel_9w <- svyglm(day_sleep~heavy_drink2, design=NHANES, family=quasibinomial(link=\"log\"))\r\nmodel_10w <- svyglm(day_sleep~depress_cat, design=NHANES, family=quasibinomial(link=\"log\"))\r\n\r\n\r\n\r\n\r\n\r\n#exponentiated coefficients\r\n\r\nexp(model_1w$coefficients)\r\n\r\n\r\n(Intercept)    RIAGENDR \r\n  0.2048742   1.2206388 \r\n\r\nexp(model_2w$coefficients)\r\n\r\n\r\n   (Intercept) ageCat_1840-59   ageCat_1860+ \r\n     0.3183220      0.7924395      0.8044204 \r\n\r\nexp(model_3w$coefficients)\r\n\r\n\r\n(Intercept)    INDFMPIR \r\n  0.3767510   0.9118087 \r\n\r\nexp(model_4w$coefficients)\r\n\r\n\r\n(Intercept)      SMQ681 \r\n  0.4012766   0.8151968 \r\n\r\nexp(model_5w$coefficients)\r\n\r\n\r\n                (Intercept)          raceEthCatNH Black \r\n                  0.3024167                   0.8091614 \r\n         raceEthCatNH Asian          raceEthCatHispanic \r\n                  0.4615732                   0.7857788 \r\nraceEthCatNH Other/Multiple \r\n                  1.2061075 \r\n\r\nexp(model_6w$coefficients)\r\n\r\n\r\n(Intercept)    activity \r\n  0.2791679   0.9971760 \r\n\r\nexp(model_7w$coefficients)\r\n\r\n\r\n(Intercept) hi_caffeine \r\n  0.2679387   1.4338962 \r\n\r\nexp(model_8w$coefficients)\r\n\r\n\r\n       (Intercept) BMI_catunderweight  BMI_catoverweight \r\n         0.2221463          1.2402763          1.0529336 \r\n      BMI_catobese \r\n         1.5503832 \r\n\r\nexp(model_9w$coefficients)\r\n\r\n\r\n (Intercept) heavy_drink2 \r\n   0.2525171    1.2794627 \r\n\r\nexp(model_10w$coefficients)\r\n\r\n\r\n  (Intercept) depress_cat.L depress_cat.Q depress_cat.C depress_cat^4 \r\n    0.4645206     2.2088022     0.5980783     1.2557422     0.9903052 \r\n\r\n# p-values\r\nsummary(model_1w)\r\n\r\n\r\n\r\nCall:\r\nsvyglm(formula = day_sleep ~ RIAGENDR, design = NHANES, family = quasibinomial(link = \"log\"))\r\n\r\nSurvey design:\r\nsubset(NHANES_all, inAnalysis == 1)\r\n\r\nCoefficients:\r\n            Estimate Std. Error t value Pr(>|t|)    \r\n(Intercept) -1.58536    0.15227 -10.412 5.65e-08 ***\r\nRIAGENDR     0.19937    0.08474   2.353   0.0338 *  \r\n---\r\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\r\n\r\n(Dispersion parameter for quasibinomial family taken to be 1.000171)\r\n\r\nNumber of Fisher Scoring iterations: 6\r\n\r\nsummary(model_2w)\r\n\r\n\r\n\r\nCall:\r\nsvyglm(formula = day_sleep ~ ageCat_18, design = NHANES, family = quasibinomial(link = \"log\"))\r\n\r\nSurvey design:\r\nsubset(NHANES_all, inAnalysis == 1)\r\n\r\nCoefficients:\r\n               Estimate Std. Error t value Pr(>|t|)    \r\n(Intercept)    -1.14469    0.05047 -22.680 7.73e-12 ***\r\nageCat_1840-59 -0.23264    0.06337  -3.671  0.00282 ** \r\nageCat_1860+   -0.21763    0.07092  -3.069  0.00897 ** \r\n---\r\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\r\n\r\n(Dispersion parameter for quasibinomial family taken to be 1.000171)\r\n\r\nNumber of Fisher Scoring iterations: 6\r\n\r\nsummary(model_3w)\r\n\r\n\r\n\r\nCall:\r\nsvyglm(formula = day_sleep ~ INDFMPIR, design = NHANES, family = quasibinomial(link = \"log\"))\r\n\r\nSurvey design:\r\nsubset(NHANES_all, inAnalysis == 1)\r\n\r\nCoefficients:\r\n            Estimate Std. Error t value Pr(>|t|)    \r\n(Intercept) -0.97617    0.08189 -11.920 1.02e-08 ***\r\nINDFMPIR    -0.09233    0.01919  -4.811 0.000277 ***\r\n---\r\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\r\n\r\n(Dispersion parameter for quasibinomial family taken to be 1.026985)\r\n\r\nNumber of Fisher Scoring iterations: 6\r\n\r\nsummary(model_4w)\r\n\r\n\r\n\r\nCall:\r\nsvyglm(formula = day_sleep ~ SMQ681, design = NHANES, family = quasibinomial(link = \"log\"))\r\n\r\nSurvey design:\r\nsubset(NHANES_all, inAnalysis == 1)\r\n\r\nCoefficients:\r\n            Estimate Std. Error t value Pr(>|t|)    \r\n(Intercept) -0.91310    0.12122  -7.532 2.74e-06 ***\r\nSMQ681      -0.20433    0.05779  -3.535  0.00329 ** \r\n---\r\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\r\n\r\n(Dispersion parameter for quasibinomial family taken to be 1.0229)\r\n\r\nNumber of Fisher Scoring iterations: 6\r\n\r\nsummary(model_5w)\r\n\r\n\r\n\r\nCall:\r\nsvyglm(formula = day_sleep ~ raceEthCat, design = NHANES, family = quasibinomial(link = \"log\"))\r\n\r\nSurvey design:\r\nsubset(NHANES_all, inAnalysis == 1)\r\n\r\nCoefficients:\r\n                            Estimate Std. Error t value Pr(>|t|)    \r\n(Intercept)                 -1.19595    0.04884 -24.490 6.03e-11 ***\r\nraceEthCatNH Black          -0.21176    0.07694  -2.752   0.0188 *  \r\nraceEthCatNH Asian          -0.77311    0.09487  -8.149 5.48e-06 ***\r\nraceEthCatHispanic          -0.24108    0.10810  -2.230   0.0475 *  \r\nraceEthCatNH Other/Multiple  0.18740    0.13200   1.420   0.1834    \r\n---\r\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\r\n\r\n(Dispersion parameter for quasibinomial family taken to be 1.000171)\r\n\r\nNumber of Fisher Scoring iterations: 6\r\n\r\nsummary(model_6w)\r\n\r\n\r\n\r\nCall:\r\nsvyglm(formula = day_sleep ~ activity, design = NHANES, family = quasibinomial(link = \"log\"))\r\n\r\nSurvey design:\r\nsubset(NHANES_all, inAnalysis == 1)\r\n\r\nCoefficients:\r\n             Estimate Std. Error t value Pr(>|t|)    \r\n(Intercept) -1.275942   0.059430 -21.470  4.1e-12 ***\r\nactivity    -0.002828   0.068327  -0.041    0.968    \r\n---\r\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\r\n\r\n(Dispersion parameter for quasibinomial family taken to be 1.000872)\r\n\r\nNumber of Fisher Scoring iterations: 6\r\n\r\nsummary(model_7w)\r\n\r\n\r\n\r\nCall:\r\nsvyglm(formula = day_sleep ~ hi_caffeine, design = NHANES_MEC, \r\n    family = quasibinomial(link = \"log\"))\r\n\r\nSurvey design:\r\nsubset(NHANES_all_MEC, inAnalysis == 1)\r\n\r\nCoefficients:\r\n            Estimate Std. Error t value Pr(>|t|)    \r\n(Intercept) -1.31700    0.03985 -33.050 1.09e-14 ***\r\nhi_caffeine  0.36040    0.12757   2.825   0.0135 *  \r\n---\r\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\r\n\r\n(Dispersion parameter for quasibinomial family taken to be 1.104844)\r\n\r\nNumber of Fisher Scoring iterations: 6\r\n\r\nsummary(model_8w)\r\n\r\n\r\n\r\nCall:\r\nsvyglm(formula = day_sleep ~ BMI_cat, design = NHANES_MEC, family = quasibinomial(link = \"log\"))\r\n\r\nSurvey design:\r\nsubset(NHANES_all_MEC, inAnalysis == 1)\r\n\r\nCoefficients:\r\n                   Estimate Std. Error t value Pr(>|t|)    \r\n(Intercept)        -1.50442    0.07922 -18.991 2.55e-10 ***\r\nBMI_catunderweight  0.21533    0.28243   0.762 0.460528    \r\nBMI_catoverweight   0.05158    0.13810   0.374 0.715285    \r\nBMI_catobese        0.43850    0.10153   4.319 0.000998 ***\r\n---\r\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\r\n\r\n(Dispersion parameter for quasibinomial family taken to be 1.064164)\r\n\r\nNumber of Fisher Scoring iterations: 6\r\n\r\nsummary(model_9w)\r\n\r\n\r\n\r\nCall:\r\nsvyglm(formula = day_sleep ~ heavy_drink2, design = NHANES, family = quasibinomial(link = \"log\"))\r\n\r\nSurvey design:\r\nsubset(NHANES_all, inAnalysis == 1)\r\n\r\nCoefficients:\r\n             Estimate Std. Error t value Pr(>|t|)    \r\n(Intercept)  -1.37628    0.06028 -22.830 1.78e-12 ***\r\nheavy_drink2  0.24644    0.05956   4.138  0.00101 ** \r\n---\r\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\r\n\r\n(Dispersion parameter for quasibinomial family taken to be 1.022591)\r\n\r\nNumber of Fisher Scoring iterations: 6\r\n\r\nsummary(model_10w)\r\n\r\n\r\n\r\nCall:\r\nsvyglm(formula = day_sleep ~ depress_cat, design = NHANES, family = quasibinomial(link = \"log\"))\r\n\r\nSurvey design:\r\nsubset(NHANES_all, inAnalysis == 1)\r\n\r\nCoefficients:\r\n               Estimate Std. Error t value Pr(>|t|)    \r\n(Intercept)   -0.766749   0.059637 -12.857 5.71e-08 ***\r\ndepress_cat.L  0.792450   0.105804   7.490 1.22e-05 ***\r\ndepress_cat.Q -0.514034   0.093152  -5.518 0.000181 ***\r\ndepress_cat.C  0.227727   0.075092   3.033 0.011395 *  \r\ndepress_cat^4 -0.009742   0.075368  -0.129 0.899485    \r\n---\r\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\r\n\r\n(Dispersion parameter for quasibinomial family taken to be 1.026629)\r\n\r\nNumber of Fisher Scoring iterations: 6\r\n\r\n#confidence intervals\r\nexp(confint(model_1w))\r\n\r\n\r\n                2.5 %    97.5 %\r\n(Intercept) 0.1477932 0.2840011\r\nRIAGENDR    1.0177826 1.4639265\r\n\r\nexp(confint(model_2w))\r\n\r\n\r\n                   2.5 %    97.5 %\r\n(Intercept)    0.2854385 0.3549939\r\nageCat_1840-59 0.6910498 0.9087050\r\nageCat_1860+   0.6901471 0.9376148\r\n\r\nexp(confint(model_3w))\r\n\r\n\r\n                2.5 %    97.5 %\r\n(Intercept) 0.3160633 0.4490912\r\nINDFMPIR    0.8750411 0.9501211\r\n\r\nexp(confint(model_4w))\r\n\r\n\r\n                2.5 %    97.5 %\r\n(Intercept) 0.3094055 0.5204269\r\nSMQ681      0.7201610 0.9227741\r\n\r\nexp(confint(model_5w))\r\n\r\n\r\n                                2.5 %    97.5 %\r\n(Intercept)                 0.2715973 0.3367333\r\nraceEthCatNH Black          0.6831119 0.9584698\r\nraceEthCatNH Asian          0.3745883 0.5687572\r\nraceEthCatHispanic          0.6193948 0.9968574\r\nraceEthCatNH Other/Multiple 0.9020059 1.6127337\r\n\r\nexp(confint(model_6w))\r\n\r\n\r\n                2.5 %   97.5 %\r\n(Intercept) 0.2457586 0.317119\r\nactivity    0.8612465 1.154559\r\n\r\nexp(confint(model_7w))\r\n\r\n\r\n                2.5 %    97.5 %\r\n(Intercept) 0.2459903 0.2918454\r\nhi_caffeine 1.0906713 1.8851310\r\n\r\nexp(confint(model_8w))\r\n\r\n\r\n                       2.5 %    97.5 %\r\n(Intercept)        0.1869307 0.2639961\r\nBMI_catunderweight 0.6702992 2.2949234\r\nBMI_catoverweight  0.7793414 1.4225720\r\nBMI_catobese       1.2427144 1.9342241\r\n\r\nexp(confint(model_9w))\r\n\r\n\r\n                 2.5 %    97.5 %\r\n(Intercept)  0.2218905 0.2873711\r\nheavy_drink2 1.1260268 1.4538061\r\n\r\nexp(confint(model_10w))\r\n\r\n\r\n                  2.5 %    97.5 %\r\n(Intercept)   0.4073797 0.5296763\r\ndepress_cat.L 1.7499334 2.7879959\r\ndepress_cat.Q 0.4872101 0.7341754\r\ndepress_cat.C 1.0644425 1.4814219\r\ndepress_cat^4 0.8389312 1.1689926\r\n\r\nLet’s also look at the univariate associations in unweighted models. We expect a change in the standard errors. It will not be as representative of the US population. We will store the results and diplay them in a table in the results section.\r\n\r\n\r\n# fit the unweighted models and store the results\r\n\r\nmodel_1u <- glm(day_sleep~RIAGENDR, family=binomial(link=\"log\"), data = unweighted_data)\r\nmodel_2u <- glm(day_sleep~ageCat_18, family=binomial(link=\"log\"), data = unweighted_data)\r\nmodel_3u <- glm(day_sleep~INDFMPIR, family=binomial(link=\"log\"), data = unweighted_data)\r\nmodel_4u <- glm(day_sleep~SMQ681, family=binomial(link=\"log\"), data = unweighted_data)\r\nmodel_5u <- glm(day_sleep~raceEthCat, family=binomial(link=\"log\"), data = unweighted_data)\r\nmodel_6u <- glm(day_sleep~activity, family=binomial(link=\"log\"), data = unweighted_data)\r\nmodel_7u <- glm(day_sleep~hi_caffeine, family=binomial(link=\"log\"), data = unweighted_data)\r\nmodel_8u <- glm(day_sleep~BMI_cat, family=binomial(link=\"log\"), data = unweighted_data)\r\nmodel_9u <- glm(day_sleep~heavy_drink2, family=binomial(link=\"log\"), data = unweighted_data)\r\nmodel_10u <- glm(day_sleep~depress_cat, family=binomial(link=\"log\"), data = unweighted_data)\r\n\r\n\r\n\r\nPart c: Fit initial MLR using all predictors\r\nMultivariable Poisson regression with robust standard errors will be used to estimate adjusted prevalence ratios. Unweighted multivariable candidate models were selected in 4 ways:\r\nIncluding all predictors\r\nBest subset selection\r\na-priori selection based on literature and common knowledge\r\nCombination of a priori and best-subset\r\nFirst, lets run the models with every predictor\r\nNote: logit models failed to converge. Use poisson model. From the svy package: svyglm always returns ‘model-robust’ standard errors; the Horvitz-Thompson-type standard errors used everywhere in the survey package are a generalisation of the model-robust ‘sandwich’ estimators. In particular, a quasi-Poisson svyglm will return correct standard errors for relative risk regression models.\r\nUsing Exam weights (recommended):\r\n\r\n\r\nMLR_1 <- svyglm(day_sleep~RIAGENDR+ INDFMPIR + SMQ681 + ageCat_18+\r\n                           + raceEthCat + activity + hi_caffeine + BMI_cat + \r\n                             heavy_drink2 + depress_cat, design=NHANES_MEC, \r\n                           family=quasipoisson(link=\"log\"))\r\n\r\nsummary(MLR_1, df.resid = degf(NHANES_MEC))\r\n\r\n\r\n\r\nCall:\r\nsvyglm(formula = day_sleep ~ RIAGENDR + INDFMPIR + SMQ681 + ageCat_18 + \r\n    +raceEthCat + activity + hi_caffeine + BMI_cat + heavy_drink2 + \r\n    depress_cat, design = NHANES_MEC, family = quasipoisson(link = \"log\"))\r\n\r\nSurvey design:\r\nsubset(NHANES_all_MEC, inAnalysis == 1)\r\n\r\nCoefficients:\r\n                             Estimate Std. Error t value Pr(>|t|)    \r\n(Intercept)                 -1.082160   0.233512  -4.634 0.000324 ***\r\nRIAGENDR                     0.121471   0.078823   1.541 0.144130    \r\nINDFMPIR                    -0.052522   0.019994  -2.627 0.019049 *  \r\nSMQ681                       0.095709   0.068990   1.387 0.185622    \r\nageCat_1840-59              -0.226165   0.095069  -2.379 0.031076 *  \r\nageCat_1860+                -0.238507   0.081341  -2.932 0.010300 *  \r\nraceEthCatNH Black          -0.238056   0.105131  -2.264 0.038800 *  \r\nraceEthCatNH Asian          -0.557554   0.173805  -3.208 0.005868 ** \r\nraceEthCatHispanic          -0.307914   0.099593  -3.092 0.007442 ** \r\nraceEthCatNH Other/Multiple  0.064766   0.159042   0.407 0.689595    \r\nactivity                     0.026327   0.057780   0.456 0.655168    \r\nhi_caffeine                  0.226425   0.095594   2.369 0.031709 *  \r\nBMI_catunderweight          -0.062413   0.362150  -0.172 0.865473    \r\nBMI_catoverweight            0.105170   0.160207   0.656 0.521471    \r\nBMI_catobese                 0.380563   0.106197   3.584 0.002716 ** \r\nheavy_drink2                 0.058645   0.083379   0.703 0.492609    \r\ndepress_cat.L                0.643917   0.102021   6.312 1.39e-05 ***\r\ndepress_cat.Q               -0.426273   0.084199  -5.063 0.000140 ***\r\ndepress_cat.C                0.239641   0.093666   2.558 0.021828 *  \r\ndepress_cat^4               -0.005434   0.075550  -0.072 0.943615    \r\n---\r\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\r\n\r\nZero or negative residual df; p-values not defined\r\n\r\n(Dispersion parameter for quasipoisson family taken to be 0.8208122)\r\n\r\nNumber of Fisher Scoring iterations: 6\r\n\r\n#linearHypothesis(MLR_1, \"ageCat_1818-39=ageCat_1840-59\")\r\n#linearHypothesis(MLR_1, \"ageCat_1818-39=ageCat_1860+\")\r\n\r\nexp(MLR_1$coefficients)\r\n\r\n\r\n                (Intercept)                    RIAGENDR \r\n                  0.3388629                   1.1291569 \r\n                   INDFMPIR                      SMQ681 \r\n                  0.9488333                   1.1004391 \r\n             ageCat_1840-59                ageCat_1860+ \r\n                  0.7975861                   0.7878033 \r\n         raceEthCatNH Black          raceEthCatNH Asian \r\n                  0.7881582                   0.5726078 \r\n         raceEthCatHispanic raceEthCatNH Other/Multiple \r\n                  0.7349785                   1.0669093 \r\n                   activity                 hi_caffeine \r\n                  1.0266769                   1.2541089 \r\n         BMI_catunderweight           BMI_catoverweight \r\n                  0.9394944                   1.1108992 \r\n               BMI_catobese                heavy_drink2 \r\n                  1.4631086                   1.0603987 \r\n              depress_cat.L               depress_cat.Q \r\n                  1.9039230                   0.6529379 \r\n              depress_cat.C               depress_cat^4 \r\n                  1.2707934                   0.9945811 \r\n\r\nUsing Interview weights\r\n\r\n\r\nMLR_2 <- svyglm(day_sleep~RIAGENDR + ageCat_18 + INDFMPIR + SMQ681 \r\n                + raceEthCat + activity + hi_caffeine + BMI_cat + \r\n                  heavy_drink2 + depress_cat, design=NHANES, \r\n                family=quasipoisson(link=\"log\"))\r\n\r\nsummary(MLR_2, df.resid = degf(NHANES))\r\n\r\n\r\n\r\nCall:\r\nsvyglm(formula = day_sleep ~ RIAGENDR + ageCat_18 + INDFMPIR + \r\n    SMQ681 + raceEthCat + activity + hi_caffeine + BMI_cat + \r\n    heavy_drink2 + depress_cat, design = NHANES, family = quasipoisson(link = \"log\"))\r\n\r\nSurvey design:\r\nsubset(NHANES_all, inAnalysis == 1)\r\n\r\nCoefficients:\r\n                             Estimate Std. Error t value Pr(>|t|)    \r\n(Intercept)                 -1.089417   0.237501  -4.587 0.000356 ***\r\nRIAGENDR                     0.125684   0.080332   1.565 0.138535    \r\nageCat_1840-59              -0.226016   0.093995  -2.405 0.029561 *  \r\nageCat_1860+                -0.252454   0.080819  -3.124 0.006972 ** \r\nINDFMPIR                    -0.052001   0.019399  -2.681 0.017113 *  \r\nSMQ681                       0.093046   0.069257   1.343 0.199087    \r\nraceEthCatNH Black          -0.239878   0.105846  -2.266 0.038658 *  \r\nraceEthCatNH Asian          -0.556917   0.176800  -3.150 0.006607 ** \r\nraceEthCatHispanic          -0.306654   0.098127  -3.125 0.006952 ** \r\nraceEthCatNH Other/Multiple  0.065960   0.164823   0.400 0.694660    \r\nactivity                     0.039479   0.059561   0.663 0.517487    \r\nhi_caffeine                  0.235958   0.094373   2.500 0.024492 *  \r\nBMI_catunderweight          -0.097781   0.377249  -0.259 0.799009    \r\nBMI_catoverweight            0.107206   0.162556   0.660 0.519570    \r\nBMI_catobese                 0.380365   0.107844   3.527 0.003050 ** \r\nheavy_drink2                 0.052873   0.082232   0.643 0.529948    \r\ndepress_cat.L                0.643541   0.105453   6.103 2.02e-05 ***\r\ndepress_cat.Q               -0.422803   0.083392  -5.070 0.000138 ***\r\ndepress_cat.C                0.250825   0.089710   2.796 0.013570 *  \r\ndepress_cat^4                0.001431   0.076402   0.019 0.985299    \r\n---\r\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\r\n\r\nZero or negative residual df; p-values not defined\r\n\r\n(Dispersion parameter for quasipoisson family taken to be 0.7764147)\r\n\r\nNumber of Fisher Scoring iterations: 6\r\n\r\nexp(MLR_2$coefficients)\r\n\r\n\r\n                (Intercept)                    RIAGENDR \r\n                  0.3364125                   1.1339234 \r\n             ageCat_1840-59                ageCat_1860+ \r\n                  0.7977057                   0.7768921 \r\n                   INDFMPIR                      SMQ681 \r\n                  0.9493281                   1.0975126 \r\n         raceEthCatNH Black          raceEthCatNH Asian \r\n                  0.7867238                   0.5729726 \r\n         raceEthCatHispanic raceEthCatNH Other/Multiple \r\n                  0.7359049                   1.0681840 \r\n                   activity                 hi_caffeine \r\n                  1.0402691                   1.2661215 \r\n         BMI_catunderweight           BMI_catoverweight \r\n                  0.9068478                   1.1131640 \r\n               BMI_catobese                heavy_drink2 \r\n                  1.4628178                   1.0542955 \r\n              depress_cat.L               depress_cat.Q \r\n                  1.9032081                   0.6552077 \r\n              depress_cat.C               depress_cat^4 \r\n                  1.2850850                   1.0014325 \r\n\r\nUn-weighted\r\n\r\n\r\nMLR_3 <- glm(day_sleep~RIAGENDR + ageCat_18 + INDFMPIR + SMQ681 \r\n             + raceEthCat + activity + hi_caffeine + BMI_cat + \r\n               heavy_drink2 + depress_cat, family=poisson(link=\"log\"), data = unweighted_data)\r\n\r\nsummary(MLR_3)\r\n\r\n\r\n\r\nCall:\r\nglm(formula = day_sleep ~ RIAGENDR + ageCat_18 + INDFMPIR + SMQ681 + \r\n    raceEthCat + activity + hi_caffeine + BMI_cat + heavy_drink2 + \r\n    depress_cat, family = poisson(link = \"log\"), data = unweighted_data)\r\n\r\nDeviance Residuals: \r\n    Min       1Q   Median       3Q      Max  \r\n-1.3717  -0.6854  -0.5868   0.3796   1.7553  \r\n\r\nCoefficients:\r\n                            Estimate Std. Error z value Pr(>|z|)    \r\n(Intercept)                 -0.80381    0.20016  -4.016 5.92e-05 ***\r\nRIAGENDR                     0.06662    0.06524   1.021  0.30718    \r\nageCat_1840-59              -0.18448    0.08036  -2.296  0.02169 *  \r\nageCat_1860+                -0.19778    0.08158  -2.424  0.01534 *  \r\nINDFMPIR                    -0.03071    0.02143  -1.433  0.15184    \r\nSMQ681                       0.10030    0.08124   1.235  0.21696    \r\nraceEthCatNH Black          -0.34815    0.08526  -4.083 4.44e-05 ***\r\nraceEthCatNH Asian          -0.64845    0.13840  -4.686 2.79e-06 ***\r\nraceEthCatHispanic          -0.37725    0.08883  -4.247 2.17e-05 ***\r\nraceEthCatNH Other/Multiple -0.13584    0.13158  -1.032  0.30192    \r\nactivity                    -0.06755    0.07090  -0.953  0.34068    \r\nhi_caffeine                  0.11217    0.12508   0.897  0.36983    \r\nBMI_catunderweight          -0.26905    0.28795  -0.934  0.35012    \r\nBMI_catoverweight            0.08017    0.09485   0.845  0.39798    \r\nBMI_catobese                 0.23308    0.08521   2.735  0.00623 ** \r\nheavy_drink2                 0.02428    0.07038   0.345  0.73014    \r\ndepress_cat.L                0.72063    0.15763   4.572 4.84e-06 ***\r\ndepress_cat.Q               -0.43440    0.14050  -3.092  0.00199 ** \r\ndepress_cat.C                0.21783    0.12248   1.779  0.07531 .  \r\ndepress_cat^4               -0.05760    0.10252  -0.562  0.57419    \r\n---\r\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\r\n\r\n(Dispersion parameter for poisson family taken to be 1)\r\n\r\n    Null deviance: 2612.4  on 3678  degrees of freedom\r\nResidual deviance: 2320.8  on 3659  degrees of freedom\r\n  (2177 observations deleted due to missingness)\r\nAIC: 4384.8\r\n\r\nNumber of Fisher Scoring iterations: 6\r\n\r\ncoeftest(MLR_3, vcov = sandwich)\r\n\r\n\r\n\r\nz test of coefficients:\r\n\r\n                             Estimate Std. Error z value  Pr(>|z|)\r\n(Intercept)                 -0.803810   0.155923 -5.1552 2.534e-07\r\nRIAGENDR                     0.066625   0.052285  1.2743  0.202572\r\nageCat_1840-59              -0.184479   0.063186 -2.9196  0.003504\r\nageCat_1860+                -0.197776   0.065378 -3.0251  0.002485\r\nINDFMPIR                    -0.030711   0.017555 -1.7494  0.080213\r\nSMQ681                       0.100302   0.064105  1.5647  0.117662\r\nraceEthCatNH Black          -0.348150   0.069915 -4.9796 6.370e-07\r\nraceEthCatNH Asian          -0.648454   0.123021 -5.2711 1.356e-07\r\nraceEthCatHispanic          -0.377252   0.071291 -5.2917 1.212e-07\r\nraceEthCatNH Other/Multiple -0.135836   0.098084 -1.3849  0.166087\r\nactivity                    -0.067554   0.056518 -1.1952  0.231990\r\nhi_caffeine                  0.112169   0.094040  1.1928  0.232956\r\nBMI_catunderweight          -0.269051   0.228246 -1.1788  0.238488\r\nBMI_catoverweight            0.080168   0.079409  1.0096  0.312710\r\nBMI_catobese                 0.233082   0.070999  3.2829  0.001027\r\nheavy_drink2                 0.024277   0.056023  0.4333  0.664765\r\ndepress_cat.L                0.720634   0.097246  7.4104 1.259e-13\r\ndepress_cat.Q               -0.434399   0.086629 -5.0145 5.318e-07\r\ndepress_cat.C                0.217833   0.075467  2.8864  0.003896\r\ndepress_cat^4               -0.057602   0.065414 -0.8806  0.378544\r\n                               \r\n(Intercept)                 ***\r\nRIAGENDR                       \r\nageCat_1840-59              ** \r\nageCat_1860+                ** \r\nINDFMPIR                    .  \r\nSMQ681                         \r\nraceEthCatNH Black          ***\r\nraceEthCatNH Asian          ***\r\nraceEthCatHispanic          ***\r\nraceEthCatNH Other/Multiple    \r\nactivity                       \r\nhi_caffeine                    \r\nBMI_catunderweight             \r\nBMI_catoverweight              \r\nBMI_catobese                ** \r\nheavy_drink2                   \r\ndepress_cat.L               ***\r\ndepress_cat.Q               ***\r\ndepress_cat.C               ** \r\ndepress_cat^4                  \r\n---\r\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\r\n\r\nexp(MLR_3$coefficients)\r\n\r\n\r\n                (Intercept)                    RIAGENDR \r\n                  0.4476202                   1.0688942 \r\n             ageCat_1840-59                ageCat_1860+ \r\n                  0.8315377                   0.8205536 \r\n                   INDFMPIR                      SMQ681 \r\n                  0.9697560                   1.1055052 \r\n         raceEthCatNH Black          raceEthCatNH Asian \r\n                  0.7059933                   0.5228535 \r\n         raceEthCatHispanic raceEthCatNH Other/Multiple \r\n                  0.6857430                   0.8729861 \r\n                   activity                 hi_caffeine \r\n                  0.9346777                   1.1187019 \r\n         BMI_catunderweight           BMI_catoverweight \r\n                  0.7641043                   1.0834689 \r\n               BMI_catobese                heavy_drink2 \r\n                  1.2624850                   1.0245741 \r\n              depress_cat.L               depress_cat.Q \r\n                  2.0557369                   0.6476537 \r\n              depress_cat.C               depress_cat^4 \r\n                  1.2433790                   0.9440252 \r\n\r\nThe unweighted regression results are qualitatively the same as the weighted regression results. I I also am not able to easily perform regression diagnostics with the survey weighted glm, so I will proceed with the unweighted model 3 for simplicity. This is reasonable, since we are trying to observe risk factors to daytime sleepiness in our sample and are not trying to predict prevalence of these risk factors in the United States population.\r\nPart d: selection of best model using AIC and a priori\r\nNext, we will run our best subset AI model to select the most parsimonious predictors\r\nWe will also attempt best-subset model selection to ensure that we are not missing any potentially relevant variables in our a-priori models.\r\n\r\n\r\nanalytic_data <- na.omit(unweighted_data)\r\n\r\n# can do this all at once with step function when done by AIC\r\nmodel_0 <- glm(day_sleep ~ 1, data = analytic_data, family = poisson(link = \"log\"))    # start with null model\r\nmod_final <- step(model_0, scope = ~ . + RIAGENDR + ageCat_18 + INDFMPIR-1 + SMQ681 \r\n                  + activity + hi_caffeine + BMI_cat + raceEthCat +\r\n                    heavy_drink2 + depress_cat, family=poisson(link=\"log\"), \r\n                  data = analytic_data, direction = \"forward\", na.rm = TRUE)   # add terms one at a time using AIC\r\n\r\n\r\nStart:  AIC=2514.33\r\nday_sleep ~ 1\r\n\r\n               Df Deviance    AIC\r\n+ depress_cat   4   1198.9 2450.9\r\n+ raceEthCat    4   1256.2 2508.2\r\n+ INDFMPIR      1   1262.8 2508.8\r\n+ BMI_cat       3   1262.0 2512.0\r\n+ hi_caffeine   1   1267.4 2513.4\r\n<none>              1270.3 2514.3\r\n+ RIAGENDR      1   1269.2 2515.2\r\n+ ageCat_18     2   1267.8 2515.8\r\n+ heavy_drink2  1   1269.8 2515.8\r\n+ SMQ681        1   1269.9 2515.9\r\n+ activity      1   1270.2 2516.2\r\n\r\nStep:  AIC=2450.89\r\nday_sleep ~ depress_cat\r\n\r\n               Df Deviance    AIC\r\n+ raceEthCat    4   1187.4 2447.4\r\n<none>              1198.9 2450.9\r\n+ INDFMPIR      1   1197.1 2451.1\r\n+ hi_caffeine   1   1197.8 2451.8\r\n+ ageCat_18     2   1195.8 2451.8\r\n+ RIAGENDR      1   1198.4 2452.4\r\n+ BMI_cat       3   1194.5 2452.5\r\n+ activity      1   1198.5 2452.5\r\n+ SMQ681        1   1198.7 2452.7\r\n+ heavy_drink2  1   1198.9 2452.9\r\n\r\nStep:  AIC=2447.4\r\nday_sleep ~ depress_cat + raceEthCat\r\n\r\n               Df Deviance    AIC\r\n+ ageCat_18     2   1183.2 2447.2\r\n+ INDFMPIR      1   1185.3 2447.3\r\n<none>              1187.4 2447.4\r\n+ SMQ681        1   1186.8 2448.8\r\n+ RIAGENDR      1   1187.1 2449.1\r\n+ activity      1   1187.1 2449.1\r\n+ hi_caffeine   1   1187.1 2449.1\r\n+ heavy_drink2  1   1187.4 2449.4\r\n+ BMI_cat       3   1183.4 2449.4\r\n\r\nStep:  AIC=2447.2\r\nday_sleep ~ depress_cat + raceEthCat + ageCat_18\r\n\r\n               Df Deviance    AIC\r\n<none>              1183.2 2447.2\r\n+ INDFMPIR      1   1181.7 2447.7\r\n+ SMQ681        1   1182.0 2448.0\r\n+ BMI_cat       3   1178.4 2448.4\r\n+ hi_caffeine   1   1182.7 2448.7\r\n+ heavy_drink2  1   1183.0 2448.9\r\n+ RIAGENDR      1   1183.0 2449.0\r\n+ activity      1   1183.2 2449.2\r\n\r\ncoeftest(mod_final, vcov. = sandwich)\r\n\r\n\r\n\r\nz test of coefficients:\r\n\r\n                             Estimate Std. Error z value  Pr(>|z|)\r\n(Intercept)                 -0.482284   0.063935 -7.5433 4.581e-14\r\ndepress_cat.L                0.576384   0.129384  4.4548 8.396e-06\r\ndepress_cat.Q               -0.392328   0.115405 -3.3996 0.0006749\r\ndepress_cat.C                0.042799   0.092111  0.4646 0.6421856\r\ndepress_cat^4               -0.041453   0.074945 -0.5531 0.5801898\r\nraceEthCatNH Black          -0.232862   0.083771 -2.7798 0.0054400\r\nraceEthCatNH Asian          -0.448282   0.149246 -3.0036 0.0026677\r\nraceEthCatHispanic          -0.277537   0.084456 -3.2862 0.0010156\r\nraceEthCatNH Other/Multiple -0.150954   0.115582 -1.3060 0.1915424\r\nageCat_1840-59              -0.115274   0.071351 -1.6156 0.1061843\r\nageCat_1860+                -0.204843   0.079876 -2.5645 0.0103322\r\n                               \r\n(Intercept)                 ***\r\ndepress_cat.L               ***\r\ndepress_cat.Q               ***\r\ndepress_cat.C                  \r\ndepress_cat^4                  \r\nraceEthCatNH Black          ** \r\nraceEthCatNH Asian          ** \r\nraceEthCatHispanic          ** \r\nraceEthCatNH Other/Multiple    \r\nageCat_1840-59                 \r\nageCat_1860+                *  \r\n---\r\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\r\n\r\nsummary(mod_final)\r\n\r\n\r\n\r\nCall:\r\nglm(formula = day_sleep ~ depress_cat + raceEthCat + ageCat_18, \r\n    family = poisson(link = \"log\"), data = analytic_data)\r\n\r\nDeviance Residuals: \r\n    Min       1Q   Median       3Q      Max  \r\n-1.2781  -0.7799  -0.6942   0.6298   1.3459  \r\n\r\nCoefficients:\r\n                            Estimate Std. Error z value Pr(>|z|)    \r\n(Intercept)                 -0.48228    0.09852  -4.895 9.81e-07 ***\r\ndepress_cat.L                0.57638    0.20265   2.844  0.00445 ** \r\ndepress_cat.Q               -0.39233    0.18092  -2.169  0.03012 *  \r\ndepress_cat.C                0.04280    0.14962   0.286  0.77484    \r\ndepress_cat^4               -0.04145    0.12182  -0.340  0.73365    \r\nraceEthCatNH Black          -0.23286    0.10737  -2.169  0.03009 *  \r\nraceEthCatNH Asian          -0.44828    0.17580  -2.550  0.01077 *  \r\nraceEthCatHispanic          -0.27754    0.10892  -2.548  0.01083 *  \r\nraceEthCatNH Other/Multiple -0.15095    0.16024  -0.942  0.34617    \r\nageCat_1840-59              -0.11527    0.09378  -1.229  0.21900    \r\nageCat_1860+                -0.20484    0.10283  -1.992  0.04637 *  \r\n---\r\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\r\n\r\n(Dispersion parameter for poisson family taken to be 1)\r\n\r\n    Null deviance: 1270.3  on 1726  degrees of freedom\r\nResidual deviance: 1183.2  on 1716  degrees of freedom\r\nAIC: 2447.2\r\n\r\nNumber of Fisher Scoring iterations: 5\r\n\r\nexp(mod_final$coefficients)\r\n\r\n\r\n                (Intercept)               depress_cat.L \r\n                  0.6173715                   1.7795910 \r\n              depress_cat.Q               depress_cat.C \r\n                  0.6754827                   1.0437281 \r\n              depress_cat^4          raceEthCatNH Black \r\n                  0.9593946                   0.7922631 \r\n         raceEthCatNH Asian          raceEthCatHispanic \r\n                  0.6387248                   0.7576473 \r\nraceEthCatNH Other/Multiple              ageCat_1840-59 \r\n                  0.8598874                   0.8911220 \r\n               ageCat_1860+ \r\n                  0.8147754 \r\n\r\nWe see the final model has depression category, race, and age as the most parsimonious predictors explaining daytime sleepiness in our sample\r\nNow, let’s look at our a-priori models\r\nModel using behavioral risk factors only (a priori)\r\n\r\n\r\nmod_behav <- glm(day_sleep~SMQ681 + activity + hi_caffeine + heavy_drink2, \r\n                     family=poisson(link=\"log\"), data = unweighted_data)\r\n\r\n#robust variance\r\ncoeftest(mod_behav, vcov = sandwich)\r\n\r\n\r\n\r\nz test of coefficients:\r\n\r\n              Estimate Std. Error z value  Pr(>|z|)    \r\n(Intercept)  -1.161584   0.122919 -9.4500 < 2.2e-16 ***\r\nSMQ681       -0.085705   0.061396 -1.3959 0.1627367    \r\nactivity     -0.109537   0.054449 -2.0117 0.0442484 *  \r\nhi_caffeine   0.320028   0.094668  3.3805 0.0007235 ***\r\nheavy_drink2  0.149307   0.054189  2.7553 0.0058635 ** \r\n---\r\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\r\n\r\n#coefficents\r\nexp(mod_behav$coefficients)\r\n\r\n\r\n (Intercept)       SMQ681     activity  hi_caffeine heavy_drink2 \r\n   0.3129899    0.9178654    0.8962488    1.3771665    1.1610298 \r\n\r\nModel combining a priori and best-subset selection\r\n\r\n\r\nmod_final_behav <- glm(day_sleep~depress_cat + ageCat_18 + SMQ681 + activity + raceEthCat +\r\n                          hi_caffeine + heavy_drink2, family=poisson(link=\"log\"), data = unweighted_data)\r\n\r\nsummary(mod_final_behav)\r\n\r\n\r\n\r\nCall:\r\nglm(formula = day_sleep ~ depress_cat + ageCat_18 + SMQ681 + \r\n    activity + raceEthCat + hi_caffeine + heavy_drink2, family = poisson(link = \"log\"), \r\n    data = unweighted_data)\r\n\r\nDeviance Residuals: \r\n    Min       1Q   Median       3Q      Max  \r\n-1.3059  -0.6649  -0.5739   0.3749   1.7463  \r\n\r\nCoefficients:\r\n                            Estimate Std. Error z value Pr(>|z|)    \r\n(Intercept)                 -0.60500    0.15997  -3.782 0.000156 ***\r\ndepress_cat.L                0.83543    0.13796   6.056 1.40e-09 ***\r\ndepress_cat.Q               -0.40609    0.12492  -3.251 0.001151 ** \r\ndepress_cat.C                0.29800    0.11183   2.665 0.007706 ** \r\ndepress_cat^4               -0.03835    0.09589  -0.400 0.689213    \r\nageCat_1840-59              -0.18828    0.07594  -2.479 0.013167 *  \r\nageCat_1860+                -0.21188    0.07645  -2.772 0.005579 ** \r\nSMQ681                       0.10213    0.07482   1.365 0.172250    \r\nactivity                    -0.09067    0.06641  -1.365 0.172142    \r\nraceEthCatNH Black          -0.34672    0.08010  -4.328 1.50e-05 ***\r\nraceEthCatNH Asian          -0.78766    0.13358  -5.897 3.71e-09 ***\r\nraceEthCatHispanic          -0.36168    0.08289  -4.363 1.28e-05 ***\r\nraceEthCatNH Other/Multiple -0.13766    0.12599  -1.093 0.274537    \r\nhi_caffeine                  0.11937    0.12200   0.978 0.327873    \r\nheavy_drink2                 0.03806    0.06676   0.570 0.568567    \r\n---\r\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\r\n\r\n(Dispersion parameter for poisson family taken to be 1)\r\n\r\n    Null deviance: 2935.0  on 4164  degrees of freedom\r\nResidual deviance: 2599.7  on 4150  degrees of freedom\r\n  (1691 observations deleted due to missingness)\r\nAIC: 4847.7\r\n\r\nNumber of Fisher Scoring iterations: 6\r\n\r\ncoeftest(mod_final_behav, vcov = sandwich)\r\n\r\n\r\n\r\nz test of coefficients:\r\n\r\n                             Estimate Std. Error z value  Pr(>|z|)\r\n(Intercept)                 -0.604997   0.121445 -4.9817 6.304e-07\r\ndepress_cat.L                0.835431   0.081969 10.1920 < 2.2e-16\r\ndepress_cat.Q               -0.406091   0.075380 -5.3872 7.156e-08\r\ndepress_cat.C                0.297997   0.071108  4.1908 2.780e-05\r\ndepress_cat^4               -0.038350   0.063182 -0.6070 0.5438610\r\nageCat_1840-59              -0.188282   0.060499 -3.1122 0.0018573\r\nageCat_1860+                -0.211885   0.061448 -3.4482 0.0005643\r\nSMQ681                       0.102129   0.059907  1.7048 0.0882301\r\nactivity                    -0.090669   0.052991 -1.7110 0.0870746\r\nraceEthCatNH Black          -0.346716   0.065189 -5.3187 1.045e-07\r\nraceEthCatNH Asian          -0.787660   0.119233 -6.6061 3.946e-11\r\nraceEthCatHispanic          -0.361676   0.067043 -5.3947 6.863e-08\r\nraceEthCatNH Other/Multiple -0.137664   0.096014 -1.4338 0.1516323\r\nhi_caffeine                  0.119369   0.092434  1.2914 0.1965662\r\nheavy_drink2                 0.038062   0.053537  0.7110 0.4771127\r\n                               \r\n(Intercept)                 ***\r\ndepress_cat.L               ***\r\ndepress_cat.Q               ***\r\ndepress_cat.C               ***\r\ndepress_cat^4                  \r\nageCat_1840-59              ** \r\nageCat_1860+                ***\r\nSMQ681                      .  \r\nactivity                    .  \r\nraceEthCatNH Black          ***\r\nraceEthCatNH Asian          ***\r\nraceEthCatHispanic          ***\r\nraceEthCatNH Other/Multiple    \r\nhi_caffeine                    \r\nheavy_drink2                   \r\n---\r\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\r\n\r\nPart e: AIC and Goodness of Fit (pearson’s chi-sq)\r\nNow I will compare the fit of the models. I calculate deviance residuals since the models are poisson, not linear.\r\n\r\n\r\nwith(mod_final_behav, cbind(res.deviance = deviance, df = df.residual, p = pchisq(deviance, df.residual, lower.tail=FALSE)))\r\n\r\n\r\n     res.deviance   df p\r\n[1,]     2599.738 4150 1\r\n\r\nwith(mod_final, cbind(res.deviance = deviance, df = df.residual,\r\n                            p = pchisq(deviance, df.residual, lower.tail=FALSE)))\r\n\r\n\r\n     res.deviance   df p\r\n[1,]     1183.199 1716 1\r\n\r\nwith(MLR_3, cbind(res.deviance = deviance, df = df.residual,\r\n                            p = pchisq(deviance, df.residual, lower.tail=FALSE)))\r\n\r\n\r\n     res.deviance   df p\r\n[1,]     2320.764 3659 1\r\n\r\nI calculate the fit of the models using Aikake’s Information Criterion, a measure of parsimony and model goodness of fit:\r\n\r\n\r\nAIC(mod_final)\r\n\r\n\r\n[1] 2447.199\r\n\r\nAIC(MLR_3)\r\n\r\n\r\n[1] 4384.764\r\n\r\nAIC(mod_final_behav)\r\n\r\n\r\n[1] 4847.738\r\n\r\nThere was some lost data in the best subset regression since there was some missingness. Therefore, the AIC is not as great as it seems when run on the full dataset. Let’s try the best subset model on the full data:\r\n\r\n\r\nMod_bestsub <- glm(day_sleep ~ ageCat_18 + depress_cat + raceEthCat, data = unweighted_data, family = poisson(link = \"log\"))\r\n\r\nAIC(Mod_bestsub)\r\n\r\n\r\n[1] 5802.821\r\n\r\nWe see in the analyses above that the model with the best fit is the model including all covariates. However, since the epidemiologic question is seeking to understand which the behavioral risk factors may be the most impactful on daytime sleepiness, we will proceed with the model including all behavioral covariates (ever smoking, moderate/high physical activity, race, high caffeine consumption, and heavy drinking) plus the covariates identified in the best-subset model (age and depression).\r\nPart f: Model diagnostics\r\nModel diagnostics that we will perform include residual versus fitted plots, Q-Q plots, leverage boxplots, residual boxplots and influential point boxplots.\r\nPart f-1: Plot studentized residual -vs- predicted values\r\nCalculate predicted values and residuals in weighted data - model w/ all covariates\r\n\r\n\r\nfit_dat <- as.data.frame(MLR_1$fitted.values)\r\npearson_res_w <- residuals(MLR_1, type = \"pearson\")\r\nfit_dat <- cbind(fit_dat, pearson_res_w)\r\n\r\n\r\n\r\nfit_dat %>%\r\n  ggplot(aes(x = MLR_1$fitted.values, y = pearson_res_w)) + \r\n  geom_point() + \r\n  geom_hline(yintercept = c(-2, 0, 2), col=\"red\") + \r\n  geom_smooth(method = lm) +\r\n  labs(x = \"Fitted values\", y = \"Pearson Residuals\", title = \"Residuals vs. Fitted values\")\r\n\r\n\r\n\r\nggsave(\"pearson_resids_weighted.png\", width = 6, height = 4, units = \"in\")\r\n\r\n\r\n\r\nCalculate predicted values and residuals in unweighted data - model w/ all covariates\r\n\r\n\r\nfit_dat2 <- as.data.frame(MLR_3$fitted.values)\r\npearson_res <- residuals(MLR_3, type = \"pearson\")\r\nfit_dat2 <- cbind(fit_dat2, pearson_res)\r\n\r\nfit_dat2 %>%\r\n  ggplot(aes(x = MLR_3$fitted.values, y = pearson_res)) + \r\n  geom_point() + \r\n  geom_hline(yintercept = c(-2, 0, 2), col=\"red\") + \r\n  geom_smooth(method = lm) +\r\n  labs(x = \"Fitted values\", y = \"Pearson Residuals\", title = \"Residuals vs. Fitted values\")\r\n\r\n\r\n\r\nggsave(\"pearson_resids_unweighted.png\", width = 6, height = 4, units = \"in\")\r\n\r\n\r\n\r\nThe loess line is flat, which means there is no trend in the residuals. Equal variances/ linear assumption is met.\r\nCalculate predicted values and residuals in unweighted final model\r\n\r\n\r\nfit_dat_fin <- as.data.frame(mod_final_behav$fitted.values)\r\npearson_res_fin <- residuals(mod_final_behav, type = \"pearson\")\r\nfit_dat_fin <- cbind(fit_dat_fin, pearson_res_fin)\r\n\r\nfit_dat_fin %>%\r\n  ggplot(aes(x = mod_final_behav$fitted.values, y = pearson_res_fin)) + \r\n  geom_point() + \r\n  geom_hline(yintercept = c(-2, 0, 2), col=\"red\") + \r\n  geom_smooth(method = lm) +\r\n  labs(x = \"Fitted values\", y = \"Pearson Residuals\", title = \"Residuals vs. Fitted values\")\r\n\r\n\r\n\r\nggsave(\"pearson_resids_final_behave_model.png\", width = 6, height = 4, units = \"in\")\r\n\r\n\r\n\r\nNow, let’s create a Q-Q plot of deviance residuals for the final model and the model including all covariates\r\n\r\n\r\nfit_dat_fin_apriori <- as.data.frame(mod_final_behav$fitted.values)\r\ndeviance_res_apriori <- residuals(mod_final_behav, type = \"deviance\")\r\nfit_dat_fin_apriori <- cbind(fit_dat_fin_apriori, deviance_res_apriori)\r\n\r\nfit_dat_fin_apriori %>%\r\n  ggplot(aes(sample = deviance_res_apriori)) +\r\n  geom_qq() + \r\n  geom_qq_line() + \r\n  labs(title = \"Q-Q plot of deviance residuals\")\r\n\r\n\r\n\r\nggsave(\"Q-Q_final_behav_mod.png\", width = 6, height = 4, units = \"in\")\r\n\r\n\r\nfit_dat_fin_all <- as.data.frame(MLR_3$fitted.values)\r\ndeviance_res_fin <- residuals(MLR_3, type = \"deviance\")\r\nfit_dat_fin_all <- cbind(fit_dat_fin_all, deviance_res_fin)\r\n\r\nfit_dat_fin_all %>%\r\n  ggplot(aes(sample = deviance_res_fin)) +\r\n  geom_qq() + \r\n  geom_qq_line() + \r\n  labs(title = \"Q-Q plot of deviance residuals\")\r\n\r\n\r\n\r\nggsave(\"Q-Q_all_variables.png\", width = 6, height = 4, units = \"in\")\r\n\r\n\r\n\r\nUnder the correct distribution of the response, we expect the points to align with the diagonal line. However, it is usual to have departures from the diagonal in the extremes other than in the center, even under normality. The graph is a little bit strange because we ran Poisson models, but the assumption is met.\r\nPart f-2 : check outliers\r\nIdentify the outliers in the final a-priori models:\r\n\r\n\r\nfit_dat_fin_apriori %>%\r\n  ggplot() +\r\n  geom_boxplot(aes(y = pearson_res_fin)) +\r\n  labs(y=\"Pearson residuals\", title=\"Boxplot of pearson residuals\")\r\n\r\n\r\n\r\n# Looking at the plot we can filter to see which observation is the outlier\r\noutlier_list <- fit_dat_fin_apriori %>% \r\n  filter(pearson_res_fin > 2.5)\r\n\r\nglimpse(outlier_list)\r\n\r\n\r\nRows: 40\r\nColumns: 2\r\n$ `mod_final_behav$fitted.values` <dbl> 0.09910205, 0.09679036, 0.08~\r\n$ deviance_res_apriori            <dbl> 1.679707, 1.692335, 1.733906~\r\n\r\nnrow(outlier_list)\r\n\r\n\r\n[1] 40\r\n\r\n#ggsave(\"outlier_residuals_apriori.png\", width = 6, height = 4, units = \"in\")\r\n\r\n\r\n\r\nPart g : check leverage\r\n\r\n\r\nfit_dat_fin_apriori <- fit_dat_fin_apriori %>%\r\n  mutate(lev = hatvalues(mod_final_behav))\r\n\r\n# Boxplot of leverage values\r\nfit_dat_fin_apriori %>%\r\n  ggplot() +\r\n  geom_boxplot(aes(y = lev)) +\r\n  labs(y=\"Leverage values\", title=\"Boxplot of leverages\")\r\n\r\n\r\n\r\nsummary(fit_dat_fin_apriori$lev)\r\n\r\n\r\n    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. \r\n0.001112 0.001548 0.001979 0.003601 0.004278 0.048211 \r\n\r\nlev_outliers <- 0.004278 + 1.5*(IQR(fit_dat_fin_apriori$lev))\r\n\r\nlist_lev_outliers <- fit_dat_fin_apriori %>% \r\n  filter(lev > lev_outliers)\r\n\r\nglimpse(list_lev_outliers)\r\n\r\n\r\nRows: 336\r\nColumns: 3\r\n$ `mod_final_behav$fitted.values` <dbl> 0.5299878, 0.5505493, 0.6055~\r\n$ deviance_res_apriori            <dbl> 0.5742631, 0.5429329, 0.4629~\r\n$ lev                             <dbl> 0.010388046, 0.011440973, 0.~\r\n\r\nnrow(list_lev_outliers)\r\n\r\n\r\n[1] 336\r\n\r\n#ggsave(\"Leverages_apriori.png\", width = 6, height = 4, units = \"in\")\r\n\r\n\r\n\r\nThere are 336 leverage outliers!\r\nPart h: Check model: influence\r\nPart h-1: Make boxplot and list outliers for influence\r\n\r\n\r\n# Calculate DFITS influence measure -- effect ith obs on overall fit\r\n# Add them to data set\r\nfit_dat_fin_apriori <- fit_dat_fin_apriori %>%\r\n  mutate(dfits = dffits(mod_final_behav))\r\n\r\n# Boxplot of dfits values\r\nfit_dat_fin_apriori %>%\r\n  ggplot() +\r\n  geom_boxplot(aes(y = dfits)) +\r\n  labs(y=\"DFITS values\", title=\"Boxplot of DFIT values\")\r\n\r\n\r\n\r\nggsave(\"dfits_apriori.png\", width = 6, height = 4, units = \"in\")\r\n\r\n# Look at outliers\r\ninfluential_points <- fit_dat_fin_apriori %>% \r\n  dplyr::select(dfits) %>%\r\n  filter(dfits <= quantile(dfits, .25) - 1.5*IQR(dfits) | \r\n           dfits >= quantile(dfits, .75) + 1.5*IQR(dfits)) %>%\r\n  arrange(dfits)\r\n\r\nglimpse(influential_points)\r\n\r\n\r\nRows: 56\r\nColumns: 1\r\n$ dfits <dbl> -0.3788205, -0.3478482, -0.3398676, -0.2887166, -0.285~\r\n\r\nnrow(influential_points)\r\n\r\n\r\n[1] 56\r\n\r\nPart h-2: Leverage -vs- residual squared (L-R) plot\r\n\r\n\r\nfit_dat_fin_apriori %>%\r\n  ggplot(aes(x = pearson_res_fin^2, y = lev)) + \r\n  geom_point() +\r\n  geom_hline(yintercept = mean(fit_dat_fin_apriori$lev), col=\"red\") +\r\n  geom_vline(xintercept = mean(fit_dat_fin_apriori$pearson_res_fin^2), col=\"red\") +\r\n  labs(title=\"Leverage-Residual Plot\")\r\n\r\n\r\n\r\nggsave(\"L-R plot apriori.png\", width = 6, height = 4, units = \"in\")\r\n\r\n\r\n\r\nPart i: Sensitivity analysis: Re-fit without influential points\r\nSensitivity analysis conducted on the 8 most influential points:\r\nCreate new data set without influential points:\r\n\r\n\r\nunweighted_data_noip <- unweighted_data %>%\r\n  filter(SEQN != 2876, SEQN != 5791, SEQN != 1373, SEQN != 5401, SEQN != 135,\r\n         SEQN != 5150, SEQN != 4173, SEQN != 1345)\r\n\r\n\r\n\r\nFit the model without the influential points:\r\n\r\n\r\nmodel_final_b_no_outliers <- glm(day_sleep~depress_cat + ageCat_18 + SMQ681 + activity + \r\n                                   raceEthCat + hi_caffeine + heavy_drink2, family=poisson(link=\"log\"), data = unweighted_data)\r\n\r\nsummary(model_final_b_no_outliers)\r\n\r\n\r\n\r\nCall:\r\nglm(formula = day_sleep ~ depress_cat + ageCat_18 + SMQ681 + \r\n    activity + raceEthCat + hi_caffeine + heavy_drink2, family = poisson(link = \"log\"), \r\n    data = unweighted_data)\r\n\r\nDeviance Residuals: \r\n    Min       1Q   Median       3Q      Max  \r\n-1.3059  -0.6649  -0.5739   0.3749   1.7463  \r\n\r\nCoefficients:\r\n                            Estimate Std. Error z value Pr(>|z|)    \r\n(Intercept)                 -0.60500    0.15997  -3.782 0.000156 ***\r\ndepress_cat.L                0.83543    0.13796   6.056 1.40e-09 ***\r\ndepress_cat.Q               -0.40609    0.12492  -3.251 0.001151 ** \r\ndepress_cat.C                0.29800    0.11183   2.665 0.007706 ** \r\ndepress_cat^4               -0.03835    0.09589  -0.400 0.689213    \r\nageCat_1840-59              -0.18828    0.07594  -2.479 0.013167 *  \r\nageCat_1860+                -0.21188    0.07645  -2.772 0.005579 ** \r\nSMQ681                       0.10213    0.07482   1.365 0.172250    \r\nactivity                    -0.09067    0.06641  -1.365 0.172142    \r\nraceEthCatNH Black          -0.34672    0.08010  -4.328 1.50e-05 ***\r\nraceEthCatNH Asian          -0.78766    0.13358  -5.897 3.71e-09 ***\r\nraceEthCatHispanic          -0.36168    0.08289  -4.363 1.28e-05 ***\r\nraceEthCatNH Other/Multiple -0.13766    0.12599  -1.093 0.274537    \r\nhi_caffeine                  0.11937    0.12200   0.978 0.327873    \r\nheavy_drink2                 0.03806    0.06676   0.570 0.568567    \r\n---\r\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\r\n\r\n(Dispersion parameter for poisson family taken to be 1)\r\n\r\n    Null deviance: 2935.0  on 4164  degrees of freedom\r\nResidual deviance: 2599.7  on 4150  degrees of freedom\r\n  (1691 observations deleted due to missingness)\r\nAIC: 4847.7\r\n\r\nNumber of Fisher Scoring iterations: 6\r\n\r\ncoeftest(mod_final_behav, vcov = sandwich)\r\n\r\n\r\n\r\nz test of coefficients:\r\n\r\n                             Estimate Std. Error z value  Pr(>|z|)\r\n(Intercept)                 -0.604997   0.121445 -4.9817 6.304e-07\r\ndepress_cat.L                0.835431   0.081969 10.1920 < 2.2e-16\r\ndepress_cat.Q               -0.406091   0.075380 -5.3872 7.156e-08\r\ndepress_cat.C                0.297997   0.071108  4.1908 2.780e-05\r\ndepress_cat^4               -0.038350   0.063182 -0.6070 0.5438610\r\nageCat_1840-59              -0.188282   0.060499 -3.1122 0.0018573\r\nageCat_1860+                -0.211885   0.061448 -3.4482 0.0005643\r\nSMQ681                       0.102129   0.059907  1.7048 0.0882301\r\nactivity                    -0.090669   0.052991 -1.7110 0.0870746\r\nraceEthCatNH Black          -0.346716   0.065189 -5.3187 1.045e-07\r\nraceEthCatNH Asian          -0.787660   0.119233 -6.6061 3.946e-11\r\nraceEthCatHispanic          -0.361676   0.067043 -5.3947 6.863e-08\r\nraceEthCatNH Other/Multiple -0.137664   0.096014 -1.4338 0.1516323\r\nhi_caffeine                  0.119369   0.092434  1.2914 0.1965662\r\nheavy_drink2                 0.038062   0.053537  0.7110 0.4771127\r\n                               \r\n(Intercept)                 ***\r\ndepress_cat.L               ***\r\ndepress_cat.Q               ***\r\ndepress_cat.C               ***\r\ndepress_cat^4                  \r\nageCat_1840-59              ** \r\nageCat_1860+                ***\r\nSMQ681                      .  \r\nactivity                    .  \r\nraceEthCatNH Black          ***\r\nraceEthCatNH Asian          ***\r\nraceEthCatHispanic          ***\r\nraceEthCatNH Other/Multiple    \r\nhi_caffeine                    \r\nheavy_drink2                   \r\n---\r\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\r\n\r\nexp(model_final_b_no_outliers$coefficients)\r\n\r\n\r\n                (Intercept)               depress_cat.L \r\n                  0.5460763                   2.3058075 \r\n              depress_cat.Q               depress_cat.C \r\n                  0.6662495                   1.3471573 \r\n              depress_cat^4              ageCat_1840-59 \r\n                  0.9623758                   0.8283812 \r\n               ageCat_1860+                      SMQ681 \r\n                  0.8090580                   1.1075267 \r\n                   activity          raceEthCatNH Black \r\n                  0.9133201                   0.7070058 \r\n         raceEthCatNH Asian          raceEthCatHispanic \r\n                  0.4549079                   0.6965079 \r\nraceEthCatNH Other/Multiple                 hi_caffeine \r\n                  0.8713918                   1.1267856 \r\n               heavy_drink2 \r\n                  1.0387961 \r\n\r\nexp(mod_final_behav$coefficients)\r\n\r\n\r\n                (Intercept)               depress_cat.L \r\n                  0.5460763                   2.3058075 \r\n              depress_cat.Q               depress_cat.C \r\n                  0.6662495                   1.3471573 \r\n              depress_cat^4              ageCat_1840-59 \r\n                  0.9623758                   0.8283812 \r\n               ageCat_1860+                      SMQ681 \r\n                  0.8090580                   1.1075267 \r\n                   activity          raceEthCatNH Black \r\n                  0.9133201                   0.7070058 \r\n         raceEthCatNH Asian          raceEthCatHispanic \r\n                  0.4549079                   0.6965079 \r\nraceEthCatNH Other/Multiple                 hi_caffeine \r\n                  0.8713918                   1.1267856 \r\n               heavy_drink2 \r\n                  1.0387961 \r\n\r\nPart j: Check variance inflation\r\n\r\n\r\nvif(MLR_3) #check VIF of unweighted model with all risk factors\r\n\r\n\r\n                 GVIF Df GVIF^(1/(2*Df))\r\nRIAGENDR     1.059197  1        1.029173\r\nageCat_18    1.223982  2        1.051826\r\nINDFMPIR     1.149586  1        1.072187\r\nSMQ681       1.208305  1        1.099229\r\nraceEthCat   1.225887  4        1.025785\r\nactivity     1.086719  1        1.042458\r\nhi_caffeine  1.099705  1        1.048668\r\nBMI_cat      1.114698  3        1.018262\r\nheavy_drink2 1.160023  1        1.077044\r\ndepress_cat  1.126430  4        1.014993\r\n\r\nvif(mod_final) # check VIF of best subset model\r\n\r\n\r\n                GVIF Df GVIF^(1/(2*Df))\r\ndepress_cat 1.021293  4        1.002637\r\nraceEthCat  1.044998  4        1.005517\r\nageCat_18   1.042034  2        1.010347\r\n\r\nvif(mod_final_behav) # check VIF of a priori model\r\n\r\n\r\n                 GVIF Df GVIF^(1/(2*Df))\r\ndepress_cat  1.060084  4        1.007320\r\nageCat_18    1.170830  2        1.040216\r\nSMQ681       1.134808  1        1.065274\r\nactivity     1.056344  1        1.027786\r\nraceEthCat   1.134959  4        1.015950\r\nhi_caffeine  1.092136  1        1.045053\r\nheavy_drink2 1.145752  1        1.070398\r\n\r\nResults\r\n\r\n\r\nunweighted_data %>%\r\n  select(day_sleep, RIAGENDR, ageCat_18, INDFMPIR, SMQ681, raceEthCat, activity, hi_caffeine, BMI_cat, heavy_drink2, depress_cat) %>%\r\n  tbl_uvregression(\r\n    method = glm,\r\n    y = day_sleep,\r\n    method.args = list(family = binomial(link=\"log\")),\r\n    exponentiate = TRUE,\r\n    pvalue_fun = ~style_pvalue(.x, digits = 2)\r\n  ) %>%\r\n  add_global_p() %>%  # add global p-value\r\n  add_q() %>%         # adjusts global p-values for multiple testing\r\n  bold_p() %>%        # bold p-values under a given threshold (default 0.05)\r\n  bold_p(t = 0.10, q = TRUE) %>% # now bold q-values under the threshold of 0.10\r\n  modify_caption(\"Crude Table\") %>%\r\n  bold_labels()\r\n\r\n\r\n\r\nhtml {\r\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;\r\n}\r\n\r\n#shfaqogolc .gt_table {\r\n  display: table;\r\n  border-collapse: collapse;\r\n  margin-left: auto;\r\n  margin-right: auto;\r\n  color: #333333;\r\n  font-size: 16px;\r\n  font-weight: normal;\r\n  font-style: normal;\r\n  background-color: #FFFFFF;\r\n  width: auto;\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #A8A8A8;\r\n  border-right-style: none;\r\n  border-right-width: 2px;\r\n  border-right-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #A8A8A8;\r\n  border-left-style: none;\r\n  border-left-width: 2px;\r\n  border-left-color: #D3D3D3;\r\n}\r\n\r\n#shfaqogolc .gt_heading {\r\n  background-color: #FFFFFF;\r\n  text-align: center;\r\n  border-bottom-color: #FFFFFF;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n}\r\n\r\n#shfaqogolc .gt_title {\r\n  color: #333333;\r\n  font-size: 125%;\r\n  font-weight: initial;\r\n  padding-top: 4px;\r\n  padding-bottom: 4px;\r\n  border-bottom-color: #FFFFFF;\r\n  border-bottom-width: 0;\r\n}\r\n\r\n#shfaqogolc .gt_subtitle {\r\n  color: #333333;\r\n  font-size: 85%;\r\n  font-weight: initial;\r\n  padding-top: 0;\r\n  padding-bottom: 6px;\r\n  border-top-color: #FFFFFF;\r\n  border-top-width: 0;\r\n}\r\n\r\n#shfaqogolc .gt_bottom_border {\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n}\r\n\r\n#shfaqogolc .gt_col_headings {\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n}\r\n\r\n#shfaqogolc .gt_col_heading {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: normal;\r\n  text-transform: inherit;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n  vertical-align: bottom;\r\n  padding-top: 5px;\r\n  padding-bottom: 6px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  overflow-x: hidden;\r\n}\r\n\r\n#shfaqogolc .gt_column_spanner_outer {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: normal;\r\n  text-transform: inherit;\r\n  padding-top: 0;\r\n  padding-bottom: 0;\r\n  padding-left: 4px;\r\n  padding-right: 4px;\r\n}\r\n\r\n#shfaqogolc .gt_column_spanner_outer:first-child {\r\n  padding-left: 0;\r\n}\r\n\r\n#shfaqogolc .gt_column_spanner_outer:last-child {\r\n  padding-right: 0;\r\n}\r\n\r\n#shfaqogolc .gt_column_spanner {\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  vertical-align: bottom;\r\n  padding-top: 5px;\r\n  padding-bottom: 5px;\r\n  overflow-x: hidden;\r\n  display: inline-block;\r\n  width: 100%;\r\n}\r\n\r\n#shfaqogolc .gt_group_heading {\r\n  padding: 8px;\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: initial;\r\n  text-transform: inherit;\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n  vertical-align: middle;\r\n}\r\n\r\n#shfaqogolc .gt_empty_group_heading {\r\n  padding: 0.5px;\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: initial;\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  vertical-align: middle;\r\n}\r\n\r\n#shfaqogolc .gt_from_md > :first-child {\r\n  margin-top: 0;\r\n}\r\n\r\n#shfaqogolc .gt_from_md > :last-child {\r\n  margin-bottom: 0;\r\n}\r\n\r\n#shfaqogolc .gt_row {\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  margin: 10px;\r\n  border-top-style: solid;\r\n  border-top-width: 1px;\r\n  border-top-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n  vertical-align: middle;\r\n  overflow-x: hidden;\r\n}\r\n\r\n#shfaqogolc .gt_stub {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: initial;\r\n  text-transform: inherit;\r\n  border-right-style: solid;\r\n  border-right-width: 2px;\r\n  border-right-color: #D3D3D3;\r\n  padding-left: 12px;\r\n}\r\n\r\n#shfaqogolc .gt_summary_row {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  text-transform: inherit;\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n}\r\n\r\n#shfaqogolc .gt_first_summary_row {\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #D3D3D3;\r\n}\r\n\r\n#shfaqogolc .gt_grand_summary_row {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  text-transform: inherit;\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n}\r\n\r\n#shfaqogolc .gt_first_grand_summary_row {\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  border-top-style: double;\r\n  border-top-width: 6px;\r\n  border-top-color: #D3D3D3;\r\n}\r\n\r\n#shfaqogolc .gt_striped {\r\n  background-color: rgba(128, 128, 128, 0.05);\r\n}\r\n\r\n#shfaqogolc .gt_table_body {\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n}\r\n\r\n#shfaqogolc .gt_footnotes {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  border-bottom-style: none;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 2px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 2px;\r\n  border-right-color: #D3D3D3;\r\n}\r\n\r\n#shfaqogolc .gt_footnote {\r\n  margin: 0px;\r\n  font-size: 90%;\r\n  padding: 4px;\r\n}\r\n\r\n#shfaqogolc .gt_sourcenotes {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  border-bottom-style: none;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 2px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 2px;\r\n  border-right-color: #D3D3D3;\r\n}\r\n\r\n#shfaqogolc .gt_sourcenote {\r\n  font-size: 90%;\r\n  padding: 4px;\r\n}\r\n\r\n#shfaqogolc .gt_left {\r\n  text-align: left;\r\n}\r\n\r\n#shfaqogolc .gt_center {\r\n  text-align: center;\r\n}\r\n\r\n#shfaqogolc .gt_right {\r\n  text-align: right;\r\n  font-variant-numeric: tabular-nums;\r\n}\r\n\r\n#shfaqogolc .gt_font_normal {\r\n  font-weight: normal;\r\n}\r\n\r\n#shfaqogolc .gt_font_bold {\r\n  font-weight: bold;\r\n}\r\n\r\n#shfaqogolc .gt_font_italic {\r\n  font-style: italic;\r\n}\r\n\r\n#shfaqogolc .gt_super {\r\n  font-size: 65%;\r\n}\r\n\r\n#shfaqogolc .gt_footnote_marks {\r\n  font-style: italic;\r\n  font-weight: normal;\r\n  font-size: 65%;\r\n}\r\nTable 1: Crude Table\r\n  \r\n  Characteristic\r\n      N\r\n      RR1\r\n      95% CI1\r\n      p-value\r\n      q-value2\r\n    RIAGENDR\r\n5856\r\n1.20\r\n1.10, 1.31\r\n<0.001\r\n<0.001ageCat_18\r\n5856\r\n\r\n\r\n<0.001\r\n0.00118-39\r\n\r\n—\r\n—\r\n\r\n40-59\r\n\r\n0.82\r\n0.74, 0.92\r\n\r\n60+\r\n\r\n0.87\r\n0.78, 0.96\r\n\r\nINDFMPIR\r\n5021\r\n0.92\r\n0.89, 0.95\r\n<0.001\r\n<0.001SMQ681\r\n5132\r\n0.85\r\n0.76, 0.94\r\n0.002\r\n0.003raceEthCat\r\n5856\r\n\r\n\r\n<0.001\r\n<0.001NH White\r\n\r\n—\r\n—\r\n\r\nNH Black\r\n\r\n0.68\r\n0.61, 0.76\r\n\r\nNH Asian\r\n\r\n0.42\r\n0.35, 0.49\r\n\r\nHispanic\r\n\r\n0.67\r\n0.60, 0.75\r\n\r\nNH Other/Multiple\r\n\r\n0.92\r\n0.76, 1.09\r\n\r\nactivity\r\n5849\r\n0.95\r\n0.87, 1.05\r\n0.31\r\n0.31hi_caffeine\r\n4339\r\n1.41\r\n1.16, 1.67\r\n<0.001\r\n0.001BMI_cat\r\n5434\r\n\r\n\r\n<0.001\r\n<0.001normal\r\n\r\n—\r\n—\r\n\r\nunderweight\r\n\r\n1.07\r\n0.71, 1.51\r\n\r\noverweight\r\n\r\n1.05\r\n0.92, 1.20\r\n\r\nobese\r\n\r\n1.44\r\n1.28, 1.62\r\n\r\nheavy_drink2\r\n5120\r\n1.23\r\n1.12, 1.35\r\n<0.001\r\n<0.001depress_cat\r\n5068\r\n\r\n\r\n<0.001\r\n<0.001depress_cat.L\r\n\r\n2.42\r\n2.02, 2.79\r\n\r\ndepress_cat.Q\r\n\r\n0.61\r\n0.52, 0.70\r\n\r\ndepress_cat.C\r\n\r\n1.23\r\n1.08, 1.40\r\n\r\ndepress_cat^4\r\n\r\n0.91\r\n0.82, 1.02\r\n\r\n\r\n        \r\n          1\r\n          \r\n           \r\n          RR = Relative Risk, CI = Confidence Interval\r\n          \r\n        \r\n          2\r\n          \r\n           \r\n          False discovery rate correction for multiple testing\r\n          \r\n      \r\n    \r\n\r\nBest subset model included race categories, age categories, and depression score categories as predictors. The final model was the model including behavioral variables selected a-priori, along with age and depression score which were identified through the AI model. This final model best suits the epidemiological question at hand: which risk factors are most important in the relationship with excessive daytime sleepiness, with a special emphasis on modifiable lifestyle factors?\r\nThe predictors in the final model: age categories, race categories, depression score categories, current smoking, weekly moderate to vigorous activity, high caffeine intake, and heavy alcohol use\r\nThe dataset was large, so the model is still parsimonious with many predictors. All candidate models had Pearson’s Goodness of Fit p-values equal to 1, so all fit the data very well. None of the variables showed signs of collinearity for any of the candidate models.\r\nResults from the final model:\r\n\r\n\r\nmod_final_behav %>% \r\n  tbl_regression(exponentiate = TRUE) %>%\r\n  add_global_p() %>%  # add global p-value \r\n  add_q() %>%         # adjusts global p-values for multiple testing\r\n  bold_p() %>%        # bold p-values under a given threshold (default 0.05)\r\n  bold_p(t = 0.10, q = TRUE) %>% # now bold q-values under the threshold of 0.10\r\n  modify_caption(\"Final model\") %>%\r\n  bold_labels() \r\n\r\n\r\n\r\nhtml {\r\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;\r\n}\r\n\r\n#cikikjsauv .gt_table {\r\n  display: table;\r\n  border-collapse: collapse;\r\n  margin-left: auto;\r\n  margin-right: auto;\r\n  color: #333333;\r\n  font-size: 16px;\r\n  font-weight: normal;\r\n  font-style: normal;\r\n  background-color: #FFFFFF;\r\n  width: auto;\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #A8A8A8;\r\n  border-right-style: none;\r\n  border-right-width: 2px;\r\n  border-right-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #A8A8A8;\r\n  border-left-style: none;\r\n  border-left-width: 2px;\r\n  border-left-color: #D3D3D3;\r\n}\r\n\r\n#cikikjsauv .gt_heading {\r\n  background-color: #FFFFFF;\r\n  text-align: center;\r\n  border-bottom-color: #FFFFFF;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n}\r\n\r\n#cikikjsauv .gt_title {\r\n  color: #333333;\r\n  font-size: 125%;\r\n  font-weight: initial;\r\n  padding-top: 4px;\r\n  padding-bottom: 4px;\r\n  border-bottom-color: #FFFFFF;\r\n  border-bottom-width: 0;\r\n}\r\n\r\n#cikikjsauv .gt_subtitle {\r\n  color: #333333;\r\n  font-size: 85%;\r\n  font-weight: initial;\r\n  padding-top: 0;\r\n  padding-bottom: 6px;\r\n  border-top-color: #FFFFFF;\r\n  border-top-width: 0;\r\n}\r\n\r\n#cikikjsauv .gt_bottom_border {\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n}\r\n\r\n#cikikjsauv .gt_col_headings {\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n}\r\n\r\n#cikikjsauv .gt_col_heading {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: normal;\r\n  text-transform: inherit;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n  vertical-align: bottom;\r\n  padding-top: 5px;\r\n  padding-bottom: 6px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  overflow-x: hidden;\r\n}\r\n\r\n#cikikjsauv .gt_column_spanner_outer {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: normal;\r\n  text-transform: inherit;\r\n  padding-top: 0;\r\n  padding-bottom: 0;\r\n  padding-left: 4px;\r\n  padding-right: 4px;\r\n}\r\n\r\n#cikikjsauv .gt_column_spanner_outer:first-child {\r\n  padding-left: 0;\r\n}\r\n\r\n#cikikjsauv .gt_column_spanner_outer:last-child {\r\n  padding-right: 0;\r\n}\r\n\r\n#cikikjsauv .gt_column_spanner {\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  vertical-align: bottom;\r\n  padding-top: 5px;\r\n  padding-bottom: 5px;\r\n  overflow-x: hidden;\r\n  display: inline-block;\r\n  width: 100%;\r\n}\r\n\r\n#cikikjsauv .gt_group_heading {\r\n  padding: 8px;\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: initial;\r\n  text-transform: inherit;\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n  vertical-align: middle;\r\n}\r\n\r\n#cikikjsauv .gt_empty_group_heading {\r\n  padding: 0.5px;\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: initial;\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  vertical-align: middle;\r\n}\r\n\r\n#cikikjsauv .gt_from_md > :first-child {\r\n  margin-top: 0;\r\n}\r\n\r\n#cikikjsauv .gt_from_md > :last-child {\r\n  margin-bottom: 0;\r\n}\r\n\r\n#cikikjsauv .gt_row {\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  margin: 10px;\r\n  border-top-style: solid;\r\n  border-top-width: 1px;\r\n  border-top-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n  vertical-align: middle;\r\n  overflow-x: hidden;\r\n}\r\n\r\n#cikikjsauv .gt_stub {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: initial;\r\n  text-transform: inherit;\r\n  border-right-style: solid;\r\n  border-right-width: 2px;\r\n  border-right-color: #D3D3D3;\r\n  padding-left: 12px;\r\n}\r\n\r\n#cikikjsauv .gt_summary_row {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  text-transform: inherit;\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n}\r\n\r\n#cikikjsauv .gt_first_summary_row {\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #D3D3D3;\r\n}\r\n\r\n#cikikjsauv .gt_grand_summary_row {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  text-transform: inherit;\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n}\r\n\r\n#cikikjsauv .gt_first_grand_summary_row {\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  border-top-style: double;\r\n  border-top-width: 6px;\r\n  border-top-color: #D3D3D3;\r\n}\r\n\r\n#cikikjsauv .gt_striped {\r\n  background-color: rgba(128, 128, 128, 0.05);\r\n}\r\n\r\n#cikikjsauv .gt_table_body {\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n}\r\n\r\n#cikikjsauv .gt_footnotes {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  border-bottom-style: none;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 2px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 2px;\r\n  border-right-color: #D3D3D3;\r\n}\r\n\r\n#cikikjsauv .gt_footnote {\r\n  margin: 0px;\r\n  font-size: 90%;\r\n  padding: 4px;\r\n}\r\n\r\n#cikikjsauv .gt_sourcenotes {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  border-bottom-style: none;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 2px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 2px;\r\n  border-right-color: #D3D3D3;\r\n}\r\n\r\n#cikikjsauv .gt_sourcenote {\r\n  font-size: 90%;\r\n  padding: 4px;\r\n}\r\n\r\n#cikikjsauv .gt_left {\r\n  text-align: left;\r\n}\r\n\r\n#cikikjsauv .gt_center {\r\n  text-align: center;\r\n}\r\n\r\n#cikikjsauv .gt_right {\r\n  text-align: right;\r\n  font-variant-numeric: tabular-nums;\r\n}\r\n\r\n#cikikjsauv .gt_font_normal {\r\n  font-weight: normal;\r\n}\r\n\r\n#cikikjsauv .gt_font_bold {\r\n  font-weight: bold;\r\n}\r\n\r\n#cikikjsauv .gt_font_italic {\r\n  font-style: italic;\r\n}\r\n\r\n#cikikjsauv .gt_super {\r\n  font-size: 65%;\r\n}\r\n\r\n#cikikjsauv .gt_footnote_marks {\r\n  font-style: italic;\r\n  font-weight: normal;\r\n  font-size: 65%;\r\n}\r\nTable 2: Final model\r\n  \r\n  Characteristic\r\n      IRR1\r\n      95% CI1\r\n      p-value\r\n      q-value2\r\n    depress_cat\r\n\r\n\r\n<0.001\r\n<0.001depress_cat.L\r\n2.31\r\n1.73, 2.98\r\n\r\ndepress_cat.Q\r\n0.67\r\n0.52, 0.84\r\n\r\ndepress_cat.C\r\n1.35\r\n1.08, 1.68\r\n\r\ndepress_cat^4\r\n0.96\r\n0.80, 1.16\r\n\r\nageCat_18\r\n\r\n\r\n0.010\r\n0.02318-39\r\n—\r\n—\r\n\r\n40-59\r\n0.83\r\n0.71, 0.96\r\n\r\n60+\r\n0.81\r\n0.70, 0.94\r\n\r\nSMQ681\r\n1.11\r\n0.96, 1.28\r\n0.2\r\n0.2activity\r\n0.91\r\n0.80, 1.04\r\n0.2\r\n0.2raceEthCat\r\n\r\n\r\n<0.001\r\n<0.001NH White\r\n—\r\n—\r\n\r\nNH Black\r\n0.71\r\n0.60, 0.83\r\n\r\nNH Asian\r\n0.45\r\n0.35, 0.59\r\n\r\nHispanic\r\n0.70\r\n0.59, 0.82\r\n\r\nNH Other/Multiple\r\n0.87\r\n0.68, 1.11\r\n\r\nhi_caffeine\r\n1.13\r\n0.88, 1.42\r\n0.3\r\n0.4heavy_drink2\r\n1.04\r\n0.91, 1.18\r\n0.6\r\n0.6\r\n        \r\n          1\r\n          \r\n           \r\n          IRR = Incidence Rate Ratio, CI = Confidence Interval\r\n          \r\n        \r\n          2\r\n          \r\n           \r\n          False discovery rate correction for multiple testing\r\n          \r\n      \r\n    \r\n\r\nBelonging to older age groups (40-59 years & 60+ years) conferred a decreased risk of excessive daytime sleepiness when compared to a referent group of 18-39 years, contrary to what is expected based on the literature\r\nThis may indicate that age-differential lifestyle factors confound the relationship between age and sleep quality.\r\n\r\nThere was also an association in the opposite direction of to what is expected for race categories.\r\nWhen compared to white individuals, Hispanic, Asian, and Black individuals have a decreased risk of excessive daytime sleepiness\r\nPerhaps the relationship is confounded by social factors not accounted for in the study\r\n\r\n\r\nAssociations with the most potential for intervention were mild and moderate to severe depression, caffeine intake, and obesity\r\nThe direction of the association of depression score with excessive daytime sleepiness varied by severity, which may be due to low sample sizes in severity categories\r\n\r\nSome covariates previously presented as risk factors for poor sleep quality in the literature that were not replicated in this study were heavy alcohol use, current tobacco smoking, and participation in weekly moderate to vigorous physical activity\r\nConclusions and future directions\r\nConflicting results emphasize the need for more research is needed to uncover the links between age, race, alcohol use, tobacco smoking and exercise on sleep quality\r\nHigh daily caffeine consumption is a modifiable risk factor that could play a role in causing excessive sleepiness during the day.\r\nBased on these results and the results of previous research, it may be clinically advisable to address sleep hygiene in people with depression and obesity to prevent future morbidity and mortality.\r\n\r\n\r\n\r\n",
      "last_modified": "2022-02-03T22:36:32-05:00"
    }
  ],
  "collections": []
}
