<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007ba5; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #007ba5; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #007ba5; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #5e5e5e; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>


  <!--radix_placeholder_meta_tags-->
  <title>Meredith Palmore: Projects</title>

  <meta property="description" itemprop="description" content="My portfolio of data science projects"/>



  <!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
  <meta property="og:title" content="Meredith Palmore: Projects"/>
  <meta property="og:type" content="article"/>
  <meta property="og:description" content="My portfolio of data science projects"/>
  <meta property="og:locale" content="en_US"/>
  <meta property="og:site_name" content="Meredith Palmore"/>

  <!--  https://dev.twitter.com/cards/types/summary -->
  <meta property="twitter:card" content="summary"/>
  <meta property="twitter:title" content="Meredith Palmore: Projects"/>
  <meta property="twitter:description" content="My portfolio of data science projects"/>

  <!--/radix_placeholder_meta_tags-->
  <!--radix_placeholder_rmarkdown_metadata-->

  <script type="text/json" id="radix-rmarkdown-metadata">
  {"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","description","output"]}},"value":[{"type":"character","attributes":{},"value":["Projects"]},{"type":"character","attributes":{},"value":["My portfolio of data science projects\n"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["toc","toc_float"]}},"value":[{"type":"logical","attributes":{},"value":[true]},{"type":"logical","attributes":{},"value":[true]}]}]}]}
  </script>
  <!--/radix_placeholder_rmarkdown_metadata-->
  <!--radix_placeholder_navigation_in_header-->
  <meta name="distill:offset" content=""/>

  <script type="application/javascript">

    window.headroom_prevent_pin = false;

    window.document.addEventListener("DOMContentLoaded", function (event) {

      // initialize headroom for banner
      var header = $('header').get(0);
      var headerHeight = header.offsetHeight;
      var headroom = new Headroom(header, {
        tolerance: 5,
        onPin : function() {
          if (window.headroom_prevent_pin) {
            window.headroom_prevent_pin = false;
            headroom.unpin();
          }
        }
      });
      headroom.init();
      if(window.location.hash)
        headroom.unpin();
      $(header).addClass('headroom--transition');

      // offset scroll location for banner on hash change
      // (see: https://github.com/WickyNilliams/headroom.js/issues/38)
      window.addEventListener("hashchange", function(event) {
        window.scrollTo(0, window.pageYOffset - (headerHeight + 25));
      });

      // responsive menu
      $('.distill-site-header').each(function(i, val) {
        var topnav = $(this);
        var toggle = topnav.find('.nav-toggle');
        toggle.on('click', function() {
          topnav.toggleClass('responsive');
        });
      });

      // nav dropdowns
      $('.nav-dropbtn').click(function(e) {
        $(this).next('.nav-dropdown-content').toggleClass('nav-dropdown-active');
        $(this).parent().siblings('.nav-dropdown')
           .children('.nav-dropdown-content').removeClass('nav-dropdown-active');
      });
      $("body").click(function(e){
        $('.nav-dropdown-content').removeClass('nav-dropdown-active');
      });
      $(".nav-dropdown").click(function(e){
        e.stopPropagation();
      });
    });
  </script>

  <style type="text/css">

  /* Theme (user-documented overrideables for nav appearance) */

  .distill-site-nav {
    color: rgba(255, 255, 255, 0.8);
    background-color: #0F2E3D;
    font-size: 15px;
    font-weight: 300;
  }

  .distill-site-nav a {
    color: inherit;
    text-decoration: none;
  }

  .distill-site-nav a:hover {
    color: white;
  }

  @media print {
    .distill-site-nav {
      display: none;
    }
  }

  .distill-site-header {

  }

  .distill-site-footer {

  }


  /* Site Header */

  .distill-site-header {
    width: 100%;
    box-sizing: border-box;
    z-index: 3;
  }

  .distill-site-header .nav-left {
    display: inline-block;
    margin-left: 8px;
  }

  @media screen and (max-width: 768px) {
    .distill-site-header .nav-left {
      margin-left: 0;
    }
  }


  .distill-site-header .nav-right {
    float: right;
    margin-right: 8px;
  }

  .distill-site-header a,
  .distill-site-header .title {
    display: inline-block;
    text-align: center;
    padding: 14px 10px 14px 10px;
  }

  .distill-site-header .title {
    font-size: 18px;
    min-width: 150px;
  }

  .distill-site-header .logo {
    padding: 0;
  }

  .distill-site-header .logo img {
    display: none;
    max-height: 20px;
    width: auto;
    margin-bottom: -4px;
  }

  .distill-site-header .nav-image img {
    max-height: 18px;
    width: auto;
    display: inline-block;
    margin-bottom: -3px;
  }



  @media screen and (min-width: 1000px) {
    .distill-site-header .logo img {
      display: inline-block;
    }
    .distill-site-header .nav-left {
      margin-left: 20px;
    }
    .distill-site-header .nav-right {
      margin-right: 20px;
    }
    .distill-site-header .title {
      padding-left: 12px;
    }
  }


  .distill-site-header .nav-toggle {
    display: none;
  }

  .nav-dropdown {
    display: inline-block;
    position: relative;
  }

  .nav-dropdown .nav-dropbtn {
    border: none;
    outline: none;
    color: rgba(255, 255, 255, 0.8);
    padding: 16px 10px;
    background-color: transparent;
    font-family: inherit;
    font-size: inherit;
    font-weight: inherit;
    margin: 0;
    margin-top: 1px;
    z-index: 2;
  }

  .nav-dropdown-content {
    display: none;
    position: absolute;
    background-color: white;
    min-width: 200px;
    border: 1px solid rgba(0,0,0,0.15);
    border-radius: 4px;
    box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.1);
    z-index: 1;
    margin-top: 2px;
    white-space: nowrap;
    padding-top: 4px;
    padding-bottom: 4px;
  }

  .nav-dropdown-content hr {
    margin-top: 4px;
    margin-bottom: 4px;
    border: none;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }

  .nav-dropdown-active {
    display: block;
  }

  .nav-dropdown-content a, .nav-dropdown-content .nav-dropdown-header {
    color: black;
    padding: 6px 24px;
    text-decoration: none;
    display: block;
    text-align: left;
  }

  .nav-dropdown-content .nav-dropdown-header {
    display: block;
    padding: 5px 24px;
    padding-bottom: 0;
    text-transform: uppercase;
    font-size: 14px;
    color: #999999;
    white-space: nowrap;
  }

  .nav-dropdown:hover .nav-dropbtn {
    color: white;
  }

  .nav-dropdown-content a:hover {
    background-color: #ddd;
    color: black;
  }

  .nav-right .nav-dropdown-content {
    margin-left: -45%;
    right: 0;
  }

  @media screen and (max-width: 768px) {
    .distill-site-header a, .distill-site-header .nav-dropdown  {display: none;}
    .distill-site-header a.nav-toggle {
      float: right;
      display: block;
    }
    .distill-site-header .title {
      margin-left: 0;
    }
    .distill-site-header .nav-right {
      margin-right: 0;
    }
    .distill-site-header {
      overflow: hidden;
    }
    .nav-right .nav-dropdown-content {
      margin-left: 0;
    }
  }


  @media screen and (max-width: 768px) {
    .distill-site-header.responsive {position: relative; min-height: 500px; }
    .distill-site-header.responsive a.nav-toggle {
      position: absolute;
      right: 0;
      top: 0;
    }
    .distill-site-header.responsive a,
    .distill-site-header.responsive .nav-dropdown {
      display: block;
      text-align: left;
    }
    .distill-site-header.responsive .nav-left,
    .distill-site-header.responsive .nav-right {
      width: 100%;
    }
    .distill-site-header.responsive .nav-dropdown {float: none;}
    .distill-site-header.responsive .nav-dropdown-content {position: relative;}
    .distill-site-header.responsive .nav-dropdown .nav-dropbtn {
      display: block;
      width: 100%;
      text-align: left;
    }
  }

  /* Site Footer */

  .distill-site-footer {
    width: 100%;
    overflow: hidden;
    box-sizing: border-box;
    z-index: 3;
    margin-top: 30px;
    padding-top: 30px;
    padding-bottom: 30px;
    text-align: center;
  }

  /* Headroom */

  d-title {
    padding-top: 6rem;
  }

  @media print {
    d-title {
      padding-top: 4rem;
    }
  }

  .headroom {
    z-index: 1000;
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
  }

  .headroom--transition {
    transition: all .4s ease-in-out;
  }

  .headroom--unpinned {
    top: -100px;
  }

  .headroom--pinned {
    top: 0;
  }

  /* adjust viewport for navbar height */
  /* helps vertically center bootstrap (non-distill) content */
  .min-vh-100 {
    min-height: calc(100vh - 100px) !important;
  }

  </style>

  <script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
  <link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet"/>
  <link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet"/>
  <script src="site_libs/headroom-0.9.4/headroom.min.js"></script>
  <script src="site_libs/autocomplete-0.37.1/autocomplete.min.js"></script>
  <script src="site_libs/fuse-6.4.1/fuse.min.js"></script>

  <script type="application/javascript">

  function getMeta(metaName) {
    var metas = document.getElementsByTagName('meta');
    for (let i = 0; i < metas.length; i++) {
      if (metas[i].getAttribute('name') === metaName) {
        return metas[i].getAttribute('content');
      }
    }
    return '';
  }

  function offsetURL(url) {
    var offset = getMeta('distill:offset');
    return offset ? offset + '/' + url : url;
  }

  function createFuseIndex() {

    // create fuse index
    var options = {
      keys: [
        { name: 'title', weight: 20 },
        { name: 'categories', weight: 15 },
        { name: 'description', weight: 10 },
        { name: 'contents', weight: 5 },
      ],
      ignoreLocation: true,
      threshold: 0
    };
    var fuse = new window.Fuse([], options);

    // fetch the main search.json
    return fetch(offsetURL('search.json'))
      .then(function(response) {
        if (response.status == 200) {
          return response.json().then(function(json) {
            // index main articles
            json.articles.forEach(function(article) {
              fuse.add(article);
            });
            // download collections and index their articles
            return Promise.all(json.collections.map(function(collection) {
              return fetch(offsetURL(collection)).then(function(response) {
                if (response.status === 200) {
                  return response.json().then(function(articles) {
                    articles.forEach(function(article) {
                      fuse.add(article);
                    });
                  })
                } else {
                  return Promise.reject(
                    new Error('Unexpected status from search index request: ' +
                              response.status)
                  );
                }
              });
            })).then(function() {
              return fuse;
            });
          });

        } else {
          return Promise.reject(
            new Error('Unexpected status from search index request: ' +
                        response.status)
          );
        }
      });
  }

  window.document.addEventListener("DOMContentLoaded", function (event) {

    // get search element (bail if we don't have one)
    var searchEl = window.document.getElementById('distill-search');
    if (!searchEl)
      return;

    createFuseIndex()
      .then(function(fuse) {

        // make search box visible
        searchEl.classList.remove('hidden');

        // initialize autocomplete
        var options = {
          autoselect: true,
          hint: false,
          minLength: 2,
        };
        window.autocomplete(searchEl, options, [{
          source: function(query, callback) {
            const searchOptions = {
              isCaseSensitive: false,
              shouldSort: true,
              minMatchCharLength: 2,
              limit: 10,
            };
            var results = fuse.search(query, searchOptions);
            callback(results
              .map(function(result) { return result.item; })
            );
          },
          templates: {
            suggestion: function(suggestion) {
              var img = suggestion.preview && Object.keys(suggestion.preview).length > 0
                ? `<img src="${offsetURL(suggestion.preview)}"</img>`
                : '';
              var html = `
                <div class="search-item">
                  <h3>${suggestion.title}</h3>
                  <div class="search-item-description">
                    ${suggestion.description || ''}
                  </div>
                  <div class="search-item-preview">
                    ${img}
                  </div>
                </div>
              `;
              return html;
            }
          }
        }]).on('autocomplete:selected', function(event, suggestion) {
          window.location.href = offsetURL(suggestion.path);
        });
        // remove inline display style on autocompleter (we want to
        // manage responsive display via css)
        $('.algolia-autocomplete').css("display", "");
      })
      .catch(function(error) {
        console.log(error);
      });

  });

  </script>

  <style type="text/css">

  .nav-search {
    font-size: x-small;
  }

  /* Algolioa Autocomplete */

  .algolia-autocomplete {
    display: inline-block;
    margin-left: 10px;
    vertical-align: sub;
    background-color: white;
    color: black;
    padding: 6px;
    padding-top: 8px;
    padding-bottom: 0;
    border-radius: 6px;
    border: 1px #0F2E3D solid;
    width: 180px;
  }


  @media screen and (max-width: 768px) {
    .distill-site-nav .algolia-autocomplete {
      display: none;
      visibility: hidden;
    }
    .distill-site-nav.responsive .algolia-autocomplete {
      display: inline-block;
      visibility: visible;
    }
    .distill-site-nav.responsive .algolia-autocomplete .aa-dropdown-menu {
      margin-left: 0;
      width: 400px;
      max-height: 400px;
    }
  }

  .algolia-autocomplete .aa-input, .algolia-autocomplete .aa-hint {
    width: 90%;
    outline: none;
    border: none;
  }

  .algolia-autocomplete .aa-hint {
    color: #999;
  }
  .algolia-autocomplete .aa-dropdown-menu {
    width: 550px;
    max-height: 70vh;
    overflow-x: visible;
    overflow-y: scroll;
    padding: 5px;
    margin-top: 3px;
    margin-left: -150px;
    background-color: #fff;
    border-radius: 5px;
    border: 1px solid #999;
    border-top: none;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion {
    cursor: pointer;
    padding: 5px 4px;
    border-bottom: 1px solid #eee;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion:last-of-type {
    border-bottom: none;
    margin-bottom: 2px;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item {
    overflow: hidden;
    font-size: 0.8em;
    line-height: 1.4em;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item h3 {
    font-size: 1rem;
    margin-block-start: 0;
    margin-block-end: 5px;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-description {
    display: inline-block;
    overflow: hidden;
    height: 2.8em;
    width: 80%;
    margin-right: 4%;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview {
    display: inline-block;
    width: 15%;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img {
    height: 3em;
    width: auto;
    display: none;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img[src] {
    display: initial;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion.aa-cursor {
    background-color: #eee;
  }
  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion em {
    font-weight: bold;
    font-style: normal;
  }

  </style>


  <!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

  <style type="text/css">

  body {
    background-color: white;
  }

  .pandoc-table {
    width: 100%;
  }

  .pandoc-table>caption {
    margin-bottom: 10px;
  }

  .pandoc-table th:not([align]) {
    text-align: left;
  }

  .pagedtable-footer {
    font-size: 15px;
  }

  d-byline .byline {
    grid-template-columns: 2fr 2fr;
  }

  d-byline .byline h3 {
    margin-block-start: 1.5em;
  }

  d-byline .byline .authors-affiliations h3 {
    margin-block-start: 0.5em;
  }

  .authors-affiliations .orcid-id {
    width: 16px;
    height:16px;
    margin-left: 4px;
    margin-right: 4px;
    vertical-align: middle;
    padding-bottom: 2px;
  }

  d-title .dt-tags {
    margin-top: 1em;
    grid-column: text;
  }

  .dt-tags .dt-tag {
    text-decoration: none;
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0em 0.4em;
    margin-right: 0.5em;
    margin-bottom: 0.4em;
    font-size: 70%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  d-article table.gt_table td,
  d-article table.gt_table th {
    border-bottom: none;
  }

  .html-widget {
    margin-bottom: 2.0em;
  }

  .l-screen-inset {
    padding-right: 16px;
  }

  .l-screen .caption {
    margin-left: 10px;
  }

  .shaded {
    background: rgb(247, 247, 247);
    padding-top: 20px;
    padding-bottom: 20px;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .html-widget {
    margin-bottom: 0;
    border: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .shaded-content {
    background: white;
  }

  .text-output {
    margin-top: 0;
    line-height: 1.5em;
  }

  .hidden {
    display: none !important;
  }

  d-article {
    padding-top: 2.5rem;
    padding-bottom: 30px;
  }

  d-appendix {
    padding-top: 30px;
  }

  d-article>p>img {
    width: 100%;
  }

  d-article h2 {
    margin: 1rem 0 1.5rem 0;
  }

  d-article h3 {
    margin-top: 1.5rem;
  }

  d-article iframe {
    border: 1px solid rgba(0, 0, 0, 0.1);
    margin-bottom: 2.0em;
    width: 100%;
  }

  /* Tweak code blocks */

  d-article div.sourceCode code,
  d-article pre code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: auto;
  }

  d-article div.sourceCode {
    background-color: white;
  }

  d-article div.sourceCode pre {
    padding-left: 10px;
    font-size: 12px;
    border-left: 2px solid rgba(0,0,0,0.1);
  }

  d-article pre {
    font-size: 12px;
    color: black;
    background: none;
    margin-top: 0;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  d-article pre a {
    border-bottom: none;
  }

  d-article pre a:hover {
    border-bottom: none;
    text-decoration: underline;
  }

  d-article details {
    grid-column: text;
    margin-bottom: 0.8em;
  }

  @media(min-width: 768px) {

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: visible !important;
  }

  d-article div.sourceCode pre {
    padding-left: 18px;
    font-size: 14px;
  }

  d-article pre {
    font-size: 14px;
  }

  }

  figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  /* CSS for d-contents */

  .d-contents {
    grid-column: text;
    color: rgba(0,0,0,0.8);
    font-size: 0.9em;
    padding-bottom: 1em;
    margin-bottom: 1em;
    padding-bottom: 0.5em;
    margin-bottom: 1em;
    padding-left: 0.25em;
    justify-self: start;
  }

  @media(min-width: 1000px) {
    .d-contents.d-contents-float {
      height: 0;
      grid-column-start: 1;
      grid-column-end: 4;
      justify-self: center;
      padding-right: 3em;
      padding-left: 2em;
    }
  }

  .d-contents nav h3 {
    font-size: 18px;
    margin-top: 0;
    margin-bottom: 1em;
  }

  .d-contents li {
    list-style-type: none
  }

  .d-contents nav > ul {
    padding-left: 0;
  }

  .d-contents ul {
    padding-left: 1em
  }

  .d-contents nav ul li {
    margin-top: 0.6em;
    margin-bottom: 0.2em;
  }

  .d-contents nav a {
    font-size: 13px;
    border-bottom: none;
    text-decoration: none
    color: rgba(0, 0, 0, 0.8);
  }

  .d-contents nav a:hover {
    text-decoration: underline solid rgba(0, 0, 0, 0.6)
  }

  .d-contents nav > ul > li > a {
    font-weight: 600;
  }

  .d-contents nav > ul > li > ul {
    font-weight: inherit;
  }

  .d-contents nav > ul > li > ul > li {
    margin-top: 0.2em;
  }


  .d-contents nav ul {
    margin-top: 0;
    margin-bottom: 0.25em;
  }

  .d-article-with-toc h2:nth-child(2) {
    margin-top: 0;
  }


  /* Figure */

  .figure {
    position: relative;
    margin-bottom: 2.5em;
    margin-top: 1.5em;
  }

  .figure img {
    width: 100%;
  }

  .figure .caption {
    color: rgba(0, 0, 0, 0.6);
    font-size: 12px;
    line-height: 1.5em;
  }

  .figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  .figure .caption a {
    color: rgba(0, 0, 0, 0.6);
  }

  .figure .caption b,
  .figure .caption strong, {
    font-weight: 600;
    color: rgba(0, 0, 0, 1.0);
  }

  /* Citations */

  d-article .citation {
    color: inherit;
    cursor: inherit;
  }

  div.hanging-indent{
    margin-left: 1em; text-indent: -1em;
  }

  /* Citation hover box */

  .tippy-box[data-theme~=light-border] {
    background-color: rgba(250, 250, 250, 0.95);
  }

  .tippy-content > p {
    margin-bottom: 0;
    padding: 2px;
  }


  /* Tweak 1000px media break to show more text */

  @media(min-width: 1000px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 16px;
    }

    .grid {
      grid-column-gap: 16px;
    }

    d-article {
      font-size: 1.06rem;
      line-height: 1.7em;
    }
    figure .caption, .figure .caption, figure figcaption {
      font-size: 13px;
    }
  }

  @media(min-width: 1180px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 32px;
    }

    .grid {
      grid-column-gap: 32px;
    }
  }


  /* Get the citation styles for the appendix (not auto-injected on render since
     we do our own rendering of the citation appendix) */

  d-appendix .citation-appendix,
  .d-appendix .citation-appendix {
    font-size: 11px;
    line-height: 15px;
    border-left: 1px solid rgba(0, 0, 0, 0.1);
    padding-left: 18px;
    border: 1px solid rgba(0,0,0,0.1);
    background: rgba(0, 0, 0, 0.02);
    padding: 10px 18px;
    border-radius: 3px;
    color: rgba(150, 150, 150, 1);
    overflow: hidden;
    margin-top: -12px;
    white-space: pre-wrap;
    word-wrap: break-word;
  }

  /* Include appendix styles here so they can be overridden */

  d-appendix {
    contain: layout style;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-top: 60px;
    margin-bottom: 0;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    color: rgba(0,0,0,0.5);
    padding-top: 60px;
    padding-bottom: 48px;
  }

  d-appendix h3 {
    grid-column: page-start / text-start;
    font-size: 15px;
    font-weight: 500;
    margin-top: 1em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.65);
  }

  d-appendix h3 + * {
    margin-top: 1em;
  }

  d-appendix ol {
    padding: 0 0 0 15px;
  }

  @media (min-width: 768px) {
    d-appendix ol {
      padding: 0 0 0 30px;
      margin-left: -30px;
    }
  }

  d-appendix li {
    margin-bottom: 1em;
  }

  d-appendix a {
    color: rgba(0, 0, 0, 0.6);
  }

  d-appendix > * {
    grid-column: text;
  }

  d-appendix > d-footnote-list,
  d-appendix > d-citation-list,
  d-appendix > distill-appendix {
    grid-column: screen;
  }

  /* Include footnote styles here so they can be overridden */

  d-footnote-list {
    contain: layout style;
  }

  d-footnote-list > * {
    grid-column: text;
  }

  d-footnote-list a.footnote-backlink {
    color: rgba(0,0,0,0.3);
    padding-left: 0.5em;
  }



  /* Anchor.js */

  .anchorjs-link {
    /*transition: all .25s linear; */
    text-decoration: none;
    border-bottom: none;
  }
  *:hover > .anchorjs-link {
    margin-left: -1.125em !important;
    text-decoration: none;
    border-bottom: none;
  }

  /* Social footer */

  .social_footer {
    margin-top: 30px;
    margin-bottom: 0;
    color: rgba(0,0,0,0.67);
  }

  .disqus-comments {
    margin-right: 30px;
  }

  .disqus-comment-count {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
    cursor: pointer;
  }

  #disqus_thread {
    margin-top: 30px;
  }

  .article-sharing a {
    border-bottom: none;
    margin-right: 8px;
  }

  .article-sharing a:hover {
    border-bottom: none;
  }

  .sidebar-section.subscribe {
    font-size: 12px;
    line-height: 1.6em;
  }

  .subscribe p {
    margin-bottom: 0.5em;
  }


  .article-footer .subscribe {
    font-size: 15px;
    margin-top: 45px;
  }


  .sidebar-section.custom {
    font-size: 12px;
    line-height: 1.6em;
  }

  .custom p {
    margin-bottom: 0.5em;
  }

  /* Styles for listing layout (hide title) */
  .layout-listing d-title, .layout-listing .d-title {
    display: none;
  }

  /* Styles for posts lists (not auto-injected) */


  .posts-with-sidebar {
    padding-left: 45px;
    padding-right: 45px;
  }

  .posts-list .description h2,
  .posts-list .description p {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  }

  .posts-list .description h2 {
    font-weight: 700;
    border-bottom: none;
    padding-bottom: 0;
  }

  .posts-list h2.post-tag {
    border-bottom: 1px solid rgba(0, 0, 0, 0.2);
    padding-bottom: 12px;
  }
  .posts-list {
    margin-top: 60px;
    margin-bottom: 24px;
  }

  .posts-list .post-preview {
    text-decoration: none;
    overflow: hidden;
    display: block;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
    padding: 24px 0;
  }

  .post-preview-last {
    border-bottom: none !important;
  }

  .posts-list .posts-list-caption {
    grid-column: screen;
    font-weight: 400;
  }

  .posts-list .post-preview h2 {
    margin: 0 0 6px 0;
    line-height: 1.2em;
    font-style: normal;
    font-size: 24px;
  }

  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.4em;
    font-size: 16px;
  }

  .posts-list .post-preview .thumbnail {
    box-sizing: border-box;
    margin-bottom: 24px;
    position: relative;
    max-width: 500px;
  }
  .posts-list .post-preview img {
    width: 100%;
    display: block;
  }

  .posts-list .metadata {
    font-size: 12px;
    line-height: 1.4em;
    margin-bottom: 18px;
  }

  .posts-list .metadata > * {
    display: inline-block;
  }

  .posts-list .metadata .publishedDate {
    margin-right: 2em;
  }

  .posts-list .metadata .dt-authors {
    display: block;
    margin-top: 0.3em;
    margin-right: 2em;
  }

  .posts-list .dt-tags {
    display: block;
    line-height: 1em;
  }

  .posts-list .dt-tags .dt-tag {
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0.3em 0.4em;
    margin-right: 0.2em;
    margin-bottom: 0.4em;
    font-size: 60%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  .posts-list img {
    opacity: 1;
  }

  .posts-list img[data-src] {
    opacity: 0;
  }

  .posts-more {
    clear: both;
  }


  .posts-sidebar {
    font-size: 16px;
  }

  .posts-sidebar h3 {
    font-size: 16px;
    margin-top: 0;
    margin-bottom: 0.5em;
    font-weight: 400;
    text-transform: uppercase;
  }

  .sidebar-section {
    margin-bottom: 30px;
  }

  .categories ul {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }

  .categories li {
    color: rgba(0, 0, 0, 0.8);
    margin-bottom: 0;
  }

  .categories li>a {
    border-bottom: none;
  }

  .categories li>a:hover {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  }

  .categories .active {
    font-weight: 600;
  }

  .categories .category-count {
    color: rgba(0, 0, 0, 0.4);
  }


  @media(min-width: 768px) {
    .posts-list .post-preview h2 {
      font-size: 26px;
    }
    .posts-list .post-preview .thumbnail {
      float: right;
      width: 30%;
      margin-bottom: 0;
    }
    .posts-list .post-preview .description {
      float: left;
      width: 45%;
    }
    .posts-list .post-preview .metadata {
      float: left;
      width: 20%;
      margin-top: 8px;
    }
    .posts-list .post-preview p {
      margin: 0 0 12px 0;
      line-height: 1.5em;
      font-size: 16px;
    }
    .posts-with-sidebar .posts-list {
      float: left;
      width: 75%;
    }
    .posts-with-sidebar .posts-sidebar {
      float: right;
      width: 20%;
      margin-top: 60px;
      padding-top: 24px;
      padding-bottom: 24px;
    }
  }


  /* Improve display for browsers without grid (IE/Edge <= 15) */

  .downlevel {
    line-height: 1.6em;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
    margin: 0;
  }

  .downlevel .d-title {
    padding-top: 6rem;
    padding-bottom: 1.5rem;
  }

  .downlevel .d-title h1 {
    font-size: 50px;
    font-weight: 700;
    line-height: 1.1em;
    margin: 0 0 0.5rem;
  }

  .downlevel .d-title p {
    font-weight: 300;
    font-size: 1.2rem;
    line-height: 1.55em;
    margin-top: 0;
  }

  .downlevel .d-byline {
    padding-top: 0.8em;
    padding-bottom: 0.8em;
    font-size: 0.8rem;
    line-height: 1.8em;
  }

  .downlevel .section-separator {
    border: none;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
  }

  .downlevel .d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
    padding-top: 1rem;
    padding-bottom: 2rem;
  }


  .downlevel .d-appendix {
    padding-left: 0;
    padding-right: 0;
    max-width: none;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.5);
    padding-top: 40px;
    padding-bottom: 48px;
  }

  .downlevel .footnotes ol {
    padding-left: 13px;
  }

  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
    padding-left: 40px;
    padding-right: 40px;
  }

  @media(min-width: 768px) {
    .downlevel .base-grid,
    .downlevel .distill-header,
    .downlevel .d-title,
    .downlevel .d-abstract,
    .downlevel .d-article,
    .downlevel .d-appendix,
    .downlevel .distill-appendix,
    .downlevel .d-byline,
    .downlevel .d-footnote-list,
    .downlevel .d-citation-list,
    .downlevel .distill-footer,
    .downlevel .appendix-bottom,
    .downlevel .posts-container {
    padding-left: 150px;
    padding-right: 150px;
    max-width: 900px;
  }
  }

  .downlevel pre code {
    display: block;
    border-left: 2px solid rgba(0, 0, 0, .1);
    padding: 0 0 0 20px;
    font-size: 14px;
  }

  .downlevel code, .downlevel pre {
    color: black;
    background: none;
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  .downlevel .posts-list .post-preview {
    color: inherit;
  }



  </style>

  <script type="application/javascript">

  function is_downlevel_browser() {
    if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                   window.navigator.userAgent)) {
      return true;
    } else {
      return window.load_distill_framework === undefined;
    }
  }

  // show body when load is complete
  function on_load_complete() {

    // add anchors
    if (window.anchors) {
      window.anchors.options.placement = 'left';
      window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
    }


    // set body to visible
    document.body.style.visibility = 'visible';

    // force redraw for leaflet widgets
    if (window.HTMLWidgets) {
      var maps = window.HTMLWidgets.findAll(".leaflet");
      $.each(maps, function(i, el) {
        var map = this.getMap();
        map.invalidateSize();
        map.eachLayer(function(layer) {
          if (layer instanceof L.TileLayer)
            layer.redraw();
        });
      });
    }

    // trigger 'shown' so htmlwidgets resize
    $('d-article').trigger('shown');
  }

  function init_distill() {

    init_common();

    // create front matter
    var front_matter = $('<d-front-matter></d-front-matter>');
    $('#distill-front-matter').wrap(front_matter);

    // create d-title
    $('.d-title').changeElementType('d-title');

    // create d-byline
    var byline = $('<d-byline></d-byline>');
    $('.d-byline').replaceWith(byline);

    // create d-article
    var article = $('<d-article></d-article>');
    $('.d-article').wrap(article).children().unwrap();

    // move posts container into article
    $('.posts-container').appendTo($('d-article'));

    // create d-appendix
    $('.d-appendix').changeElementType('d-appendix');

    // flag indicating that we have appendix items
    var appendix = $('.appendix-bottom').children('h3').length > 0;

    // replace footnotes with <d-footnote>
    $('.footnote-ref').each(function(i, val) {
      appendix = true;
      var href = $(this).attr('href');
      var id = href.replace('#', '');
      var fn = $('#' + id);
      var fn_p = $('#' + id + '>p');
      fn_p.find('.footnote-back').remove();
      var text = fn_p.html();
      var dtfn = $('<d-footnote></d-footnote>');
      dtfn.html(text);
      $(this).replaceWith(dtfn);
    });
    // remove footnotes
    $('.footnotes').remove();

    // move refs into #references-listing
    $('#references-listing').replaceWith($('#refs'));

    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      var id = $(this).attr('id');
      $('.d-contents a[href="#' + id + '"]').parent().remove();
      appendix = true;
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
    });

    // show d-appendix if we have appendix content
    $("d-appendix").css('display', appendix ? 'grid' : 'none');

    // localize layout chunks to just output
    $('.layout-chunk').each(function(i, val) {

      // capture layout
      var layout = $(this).attr('data-layout');

      // apply layout to markdown level block elements
      var elements = $(this).children().not('details, div.sourceCode, pre, script');
      elements.each(function(i, el) {
        var layout_div = $('<div class="' + layout + '"></div>');
        if (layout_div.hasClass('shaded')) {
          var shaded_content = $('<div class="shaded-content"></div>');
          $(this).wrap(shaded_content);
          $(this).parent().wrap(layout_div);
        } else {
          $(this).wrap(layout_div);
        }
      });


      // unwrap the layout-chunk div
      $(this).children().unwrap();
    });

    // remove code block used to force  highlighting css
    $('.distill-force-highlighting-css').parent().remove();

    // remove empty line numbers inserted by pandoc when using a
    // custom syntax highlighting theme
    $('code.sourceCode a:empty').remove();

    // load distill framework
    load_distill_framework();

    // wait for window.distillRunlevel == 4 to do post processing
    function distill_post_process() {

      if (!window.distillRunlevel || window.distillRunlevel < 4)
        return;

      // hide author/affiliations entirely if we have no authors
      var front_matter = JSON.parse($("#distill-front-matter").html());
      var have_authors = front_matter.authors && front_matter.authors.length > 0;
      if (!have_authors)
        $('d-byline').addClass('hidden');

      // article with toc class
      $('.d-contents').parent().addClass('d-article-with-toc');

      // strip links that point to #
      $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

      // add orcid ids
      $('.authors-affiliations').find('.author').each(function(i, el) {
        var orcid_id = front_matter.authors[i].orcidID;
        if (orcid_id) {
          var a = $('<a></a>');
          a.attr('href', 'https://orcid.org/' + orcid_id);
          var img = $('<img></img>');
          img.addClass('orcid-id');
          img.attr('alt', 'ORCID ID');
          img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
          a.append(img);
          $(this).append(a);
        }
      });

      // hide elements of author/affiliations grid that have no value
      function hide_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
      }

      // affiliations
      var have_affiliations = false;
      for (var i = 0; i<front_matter.authors.length; ++i) {
        var author = front_matter.authors[i];
        if (author.affiliation !== "&nbsp;") {
          have_affiliations = true;
          break;
        }
      }
      if (!have_affiliations)
        $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

      // published date
      if (!front_matter.publishedDate)
        hide_byline_column("Published");

      // document object identifier
      var doi = $('d-byline').find('h3:contains("DOI")');
      var doi_p = doi.next().empty();
      if (!front_matter.doi) {
        // if we have a citation and valid citationText then link to that
        if ($('#citation').length > 0 && front_matter.citationText) {
          doi.html('Citation');
          $('<a href="#citation"></a>')
            .text(front_matter.citationText)
            .appendTo(doi_p);
        } else {
          hide_byline_column("DOI");
        }
      } else {
        $('<a></a>')
           .attr('href', "https://doi.org/" + front_matter.doi)
           .html(front_matter.doi)
           .appendTo(doi_p);
      }

       // change plural form of authors/affiliations
      if (front_matter.authors.length === 1) {
        var grid = $('.authors-affiliations');
        grid.children('h3:contains("Authors")').text('Author');
        grid.children('h3:contains("Affiliations")').text('Affiliation');
      }

      // remove d-appendix and d-footnote-list local styles
      $('d-appendix > style:first-child').remove();
      $('d-footnote-list > style:first-child').remove();

      // move appendix-bottom entries to the bottom
      $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
      $('.appendix-bottom').remove();

      // hoverable references
      $('span.citation[data-cites]').each(function() {
        var refs = $(this).attr('data-cites').split(" ");
        var refHtml = refs.map(function(ref) {
          return "<p>" + $('#ref-' + ref).html() + "</p>";
        }).join("\n");
        window.tippy(this, {
          allowHTML: true,
          content: refHtml,
          maxWidth: 500,
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        });
      });

      // clear polling timer
      clearInterval(tid);

      // show body now that everything is ready
      on_load_complete();
    }

    var tid = setInterval(distill_post_process, 50);
    distill_post_process();

  }

  function init_downlevel() {

    init_common();

     // insert hr after d-title
    $('.d-title').after($('<hr class="section-separator"/>'));

    // check if we have authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;

    // manage byline/border
    if (!have_authors)
      $('.d-byline').remove();
    $('.d-byline').after($('<hr class="section-separator"/>'));
    $('.d-byline a').remove();

    // remove toc
    $('.d-contents').remove();

    // move appendix elements
    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
    });


    // inject headers into references and footnotes
    var refs_header = $('<h3></h3>');
    refs_header.text('References');
    $('#refs').prepend(refs_header);

    var footnotes_header = $('<h3></h3');
    footnotes_header.text('Footnotes');
    $('.footnotes').children('hr').first().replaceWith(footnotes_header);

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // remove appendix if it's empty
    if ($('.d-appendix').children().length === 0)
      $('.d-appendix').remove();

    // prepend separator above appendix
    $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

    // trim code
    $('pre>code').each(function(i, val) {
      $(this).html($.trim($(this).html()));
    });

    // move posts-container right before article
    $('.posts-container').insertBefore($('.d-article'));

    $('body').addClass('downlevel');

    on_load_complete();
  }


  function init_common() {

    // jquery plugin to change element types
    (function($) {
      $.fn.changeElementType = function(newType) {
        var attrs = {};

        $.each(this[0].attributes, function(idx, attr) {
          attrs[attr.nodeName] = attr.nodeValue;
        });

        this.replaceWith(function() {
          return $("<" + newType + "/>", attrs).append($(this).contents());
        });
      };
    })(jQuery);

    // prevent underline for linked images
    $('a > img').parent().css({'border-bottom' : 'none'});

    // mark non-body figures created by knitr chunks as 100% width
    $('.layout-chunk').each(function(i, val) {
      var figures = $(this).find('img, .html-widget');
      if ($(this).attr('data-layout') !== "l-body") {
        figures.css('width', '100%');
      } else {
        figures.css('max-width', '100%');
        figures.filter("[width]").each(function(i, val) {
          var fig = $(this);
          fig.css('width', fig.attr('width') + 'px');
        });

      }
    });

    // auto-append index.html to post-preview links in file: protocol
    // and in rstudio ide preview
    $('.post-preview').each(function(i, val) {
      if (window.location.protocol === "file:")
        $(this).attr('href', $(this).attr('href') + "index.html");
    });

    // get rid of index.html references in header
    if (window.location.protocol !== "file:") {
      $('.distill-site-header a[href]').each(function(i,val) {
        $(this).attr('href', $(this).attr('href').replace("index.html", "./"));
      });
    }

    // add class to pandoc style tables
    $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
    $('.kable-table').children('table').addClass('pandoc-table');

    // add figcaption style to table captions
    $('caption').parent('table').addClass("figcaption");

    // initialize posts list
    if (window.init_posts_list)
      window.init_posts_list();

    // implmement disqus comment link
    $('.disqus-comment-count').click(function() {
      window.headroom_prevent_pin = true;
      $('#disqus_thread').toggleClass('hidden');
      if (!$('#disqus_thread').hasClass('hidden')) {
        var offset = $(this).offset();
        $(window).resize();
        $('html, body').animate({
          scrollTop: offset.top - 35
        });
      }
    });
  }

  document.addEventListener('DOMContentLoaded', function() {
    if (is_downlevel_browser())
      init_downlevel();
    else
      window.addEventListener('WebComponentsReady', init_distill);
  });

  </script>

  <style type="text/css">
  /* base variables */

  /* Edit the CSS properties in this file to create a custom
     Distill theme. Only edit values in the right column
     for each row; values shown are the CSS defaults.
     To return any property to the default,
     you may set its value to: unset
     All rows must end with a semi-colon.                      */

  /* Optional: embed custom fonts here with `@import`          */
  /* This must remain at the top of this file.                 */



  html {
    /*-- Main font sizes --*/
    --title-size:      50px;
    --body-size:       1.06rem;
    --code-size:       14px;
    --aside-size:      12px;
    --fig-cap-size:    13px;
    /*-- Main font colors --*/
    --title-color:     #000000;
    --header-color:    rgba(0, 0, 0, 0.8);
    --body-color:      rgba(0, 0, 0, 0.8);
    --aside-color:     rgba(0, 0, 0, 0.6);
    --fig-cap-color:   rgba(0, 0, 0, 0.6);
    /*-- Specify custom fonts ~~~ must be imported above   --*/
    --heading-font:    sans-serif;
    --mono-font:       monospace;
    --body-font:       sans-serif;
    --navbar-font:     sans-serif;  /* websites + blogs only */
  }

  /*-- ARTICLE METADATA --*/
  d-byline {
    --heading-size:    0.6rem;
    --heading-color:   rgba(0, 0, 0, 0.5);
    --body-size:       0.8rem;
    --body-color:      rgba(0, 0, 0, 0.8);
  }

  /*-- ARTICLE TABLE OF CONTENTS --*/
  .d-contents {
    --heading-size:    18px;
    --contents-size:   13px;
  }

  /*-- ARTICLE APPENDIX --*/
  d-appendix {
    --heading-size:    15px;
    --heading-color:   rgba(0, 0, 0, 0.65);
    --text-size:       0.8em;
    --text-color:      rgba(0, 0, 0, 0.5);
  }

  /*-- WEBSITE HEADER + FOOTER --*/
  /* These properties only apply to Distill sites and blogs  */

  .distill-site-header {
    --title-size:       18px;
    --text-color:       rgba(255, 255, 255, 0.8);
    --text-size:        15px;
    --hover-color:      white;
    --bkgd-color:       #0F2E3D;
  }

  .distill-site-footer {
    --text-color:       rgba(255, 255, 255, 0.8);
    --text-size:        15px;
    --hover-color:      white;
    --bkgd-color:       #0F2E3D;
  }

  /*-- Additional custom styles --*/
  /* Add any additional CSS rules below                      */
  </style>
  <style type="text/css">
  /* base variables */

  /* Edit the CSS properties in this file to create a custom
     Distill theme. Only edit values in the right column
     for each row; values shown are the CSS defaults.
     To return any property to the default,
     you may set its value to: unset
     All rows must end with a semi-colon.                      */

  /* Optional: embed custom fonts here with `@import`          */
  /* This must remain at the top of this file.                 */
  @import url('https://fonts.googleapis.com/css?family=Noto+Serif+JP:300, 300i&display=swap');
  @import url('https://fonts.googleapis.com/css?family=Lato:400,400i,700&display=swap');
  @import url('https://fonts.googleapis.com/css?family=IBM+Plex+Mono&display=swap');



  html {
    /*-- Main font sizes --*/
    --title-size:      50px;
    --body-size:       1.06rem;
    --code-size:       14px;
    --aside-size:      12px;
    --fig-cap-size:    13px;
    /*-- Main font colors --*/
    --title-color:     #ca225e;
    --header-color:    #ca225e;                    /* edited */
    --body-color:      #404040;                    /* edited */
    --aside-color:     rgba(0, 0, 0, 0.6);
    --fig-cap-color:   rgba(0, 0, 0, 0.6);
    /*-- Specify custom fonts ~~~ must be imported above   --*/
    --heading-font:    "Noto Serif JP", sans-serif; /* edited */
    --mono-font:       "IBM Plex Mono", monospace;  /* edited */
    --body-font:       "Lato", sans-serif;          /* edited */
    --navbar-font:     "Lato", sans-serif;          /* edited */
  }

  /*-- ARTICLE METADATA --*/
  d-byline {
    --heading-size:    0.9rem;                      /* edited */
    --heading-color:   rgba(0, 0, 0, 0.5);
    --body-size:       0.95rem;                     /* edited */
    --body-color:      rgba(0, 0, 0, 0.8);
  }

  /*-- ARTICLE TABLE OF CONTENTS --*/
  .d-contents {
    --heading-size:    18px;
    --contents-size:   13px;
  }


  /*-- ARTICLE APPENDIX --*/
  d-appendix {
    --heading-size:    15px;
    --heading-color:   rgba(0, 0, 0, 0.65);
    --text-size:       0.9rem;                    /* edited */
    --text-color:      #1a162d;                   /* edited */
  }


  /*-- WEBSITE HEADER + FOOTER --*/
  /* These properties only apply to Distill sites and blogs  */

  .distill-site-header {
    --title-size:       18px;
    --text-color:       #1f1f1f;                   /* edited */
    --text-size:        15px;
    --hover-color:      #787878;                   /* edited */
    --bkgd-color:       #fff;                 /* edited */
  }

  .distill-site-footer {
    --text-color:       #7e7b88;                   /* edited */
    --text-size:        15px;
    --hover-color:      white;
    --bkgd-color:       #ca225e3d;                 /* edited */
  }

  /*-- Additional custom styles --*/
  /* Add any additional CSS rules below                      */

  img { 
    max-width:  200px; 
    display: block;
  }

  img[alt="GitHub"] { 
    max-width:  30px; 
    display: block;
  }
  img[alt="Email"] { 
    max-width:  30px; 
    display: block;
  }
  img[alt="Phone"] { 
    max-width:  30px; 
    display: block;
  }

  ul > li::marker {
    color: #ca225e;
  }

  .distill-site-header { 
    letter-spacing: 2px;
    text-transform: uppercase;
  }

  h1, h2, h3, h4, h5, h6 {
    letter-spacing: 2px;
    font-weight: 300;
  }


  .distill-site-header {
    padding-top: 1rem;
  }

  d-title h1,
  d-article h2,
  .posts-list .description h2,
  .posts-list > h1 {
      font-weight: 300;
  }

  d-appendix {
    background-color: #fdf7f9;
    border-top: none;
  }</style>
  <style type="text/css">
  /* base style */

  /* FONT FAMILIES */

  :root {
    --heading-default: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
    --mono-default: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
    --body-default: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  }

  body,
  .posts-list .post-preview p,
  .posts-list .description p {
    font-family: var(--body-font), var(--body-default);
  }

  h1, h2, h3, h4, h5, h6,
  .posts-list .post-preview h2,
  .posts-list .description h2 {
    font-family: var(--heading-font), var(--heading-default);
  }

  d-article div.sourceCode code,
  d-article pre code {
    font-family: var(--mono-font), var(--mono-default);
  }


  /*-- TITLE --*/
  d-title h1,
  .posts-list > h1 {
    color: var(--title-color, black);
  }

  d-title h1 {
    font-size: var(--title-size, 50px);
  }

  /*-- HEADERS --*/
  d-article h1,
  d-article h2,
  d-article h3,
  d-article h4,
  d-article h5,
  d-article h6 {
    color: var(--header-color, rgba(0, 0, 0, 0.8));
  }

  /*-- BODY --*/
  d-article > p,  /* only text inside of <p> tags */
  d-article > ul, /* lists */
  d-article > ol {
    color: var(--body-color, rgba(0, 0, 0, 0.8));
    font-size: var(--body-size, 1.06rem);
  }


  /*-- CODE --*/
  d-article div.sourceCode code,
  d-article pre code {
    font-size: var(--code-size, 14px);
  }

  /*-- ASIDE --*/
  d-article aside {
    font-size: var(--aside-size, 12px);
    color: var(--aside-color, rgba(0, 0, 0, 0.6));
  }

  /*-- FIGURE CAPTIONS --*/
  figure .caption,
  figure figcaption,
  .figure .caption {
    font-size: var(--fig-cap-size, 13px);
    color: var(--fig-cap-color, rgba(0, 0, 0, 0.6));
  }

  /*-- METADATA --*/
  d-byline h3 {
    font-size: var(--heading-size, 0.6rem);
    color: var(--heading-color, rgba(0, 0, 0, 0.5));
  }

  d-byline {
    font-size: var(--body-size, 0.8rem);
    color: var(--body-color, rgba(0, 0, 0, 0.8));
  }

  d-byline a,
  d-article d-byline a {
    color: var(--body-color, rgba(0, 0, 0, 0.8));
  }

  /*-- TABLE OF CONTENTS --*/
  .d-contents nav h3 {
    font-size: var(--heading-size, 18px);
  }

  .d-contents nav a {
    font-size: var(--contents-size, 13px);
  }

  /*-- APPENDIX --*/
  d-appendix h3 {
    font-size: var(--heading-size, 15px);
    color: var(--heading-color, rgba(0, 0, 0, 0.65));
  }

  d-appendix {
    font-size: var(--text-size, 0.8em);
    color: var(--text-color, rgba(0, 0, 0, 0.5));
  }

  d-appendix d-footnote-list a.footnote-backlink {
    color: var(--text-color, rgba(0, 0, 0, 0.5));
  }

  /*-- WEBSITE HEADER + FOOTER --*/
  .distill-site-header .title {
    font-size: var(--title-size, 18px);
    font-family: var(--navbar-font), var(--heading-default);
  }

  .distill-site-header a,
  .nav-dropdown .nav-dropbtn {
    font-family: var(--navbar-font), var(--heading-default);
  }

  .nav-dropdown .nav-dropbtn {
    color: var(--text-color, rgba(255, 255, 255, 0.8));
    font-size: var(--text-size, 15px);
  }

  .distill-site-header a:hover,
  .nav-dropdown:hover .nav-dropbtn {
    color: var(--hover-color, white);
  }

  .distill-site-header {
    font-size: var(--text-size, 15px);
    color: var(--text-color, rgba(255, 255, 255, 0.8));
    background-color: var(--bkgd-color, #0F2E3D);
  }

  .distill-site-footer {
    font-size: var(--text-size, 15px);
    color: var(--text-color, rgba(255, 255, 255, 0.8));
    background-color: var(--bkgd-color, #0F2E3D);
  }

  .distill-site-footer a:hover {
    color: var(--hover-color, white);
  }</style>
  <!--/radix_placeholder_distill-->
  <script src="site_libs/header-attrs-2.11/header-attrs.js"></script>
  <script src="site_libs/popper-2.6.0/popper.min.js"></script>
  <link href="site_libs/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="site_libs/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="site_libs/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="site_libs/anchor-4.2.2/anchor.min.js"></script>
  <script src="site_libs/bowser-1.9.3/bowser.min.js"></script>
  <script src="site_libs/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="site_libs/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
  <!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"Projects","description":"My portfolio of data science projects","authors":[]}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<header class="header header--fixed" role="banner">
<nav class="distill-site-nav distill-site-header">
<div class="nav-left">
<span class="logo">
<img src="images/Profile_photo.jpg"/>
</span>
<a href="index.html" class="title">Meredith Palmore</a>
<input id="distill-search" class="nav-search hidden" type="text" placeholder="Search..."/>
</div>
<div class="nav-right">
<a href="index.html">Home</a>
<a href="projects.html">Projects</a>
<a href="cv.html">Resume</a>
<a href="https://github.com/mpalmore">
<i class="fa fa-github" aria-hidden="true"></i>
</a>
<a href="https://www.linkedin.com/in/meredith-p-b76a19109/">
<i class="fa fa-linkedin" aria-hidden="true"></i>
</a>
<a href="javascript:void(0);" class="nav-toggle">&#9776;</a>
</div>
</nav>
</header>
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>Projects</h1>
<!--radix_placeholder_categories-->
<!--/radix_placeholder_categories-->
<p><p>My portfolio of data science projects</p></p>
</div>


<div class="d-article">
<div class="d-contents d-contents-float">
<nav class="l-text toc figcaption" id="TOC">
<h3>Contents</h3>
<ul>
<li><a href="#behavioral-risk-factors-of-excessive-daytime-sleepiness-in-nhanes-2017-18">Behavioral Risk Factors of Excessive Daytime Sleepiness in NHANES 2017-18</a>
<ul>
<li><a href="#background">Background</a></li>
<li><a href="#study-design">Study Design</a></li>
<li><a href="#data">Data</a></li>
<li><a href="#wrangling-the-data">Wrangling the data</a></li>
<li><a href="#correcting-for-missingness">Correcting for missingness</a></li>
<li><a href="#statistical-methods">Statistical Methods</a></li>
<li><a href="#results">Results</a></li>
<li><a href="#conclusions-and-future-directions">Conclusions and future directions</a></li>
</ul></li>
</ul>
</nav>
</div>
<h2 id="behavioral-risk-factors-of-excessive-daytime-sleepiness-in-nhanes-2017-18">Behavioral Risk Factors of Excessive Daytime Sleepiness in NHANES 2017-18</h2>
<h3 id="background">Background</h3>
<p>Insufficient sleep duration and quality is associated with both morbidity and mortality from cardiometabolic disorders and affects neurobehavioral functioning (Gangwesh at al., 2006; Hall et al., 2008).</p>
<p>The 20th century has seen a downward trend in sleep duration and quality (Bixler, 2009).</p>
<p>Studies have identified health behaviors and personal characteristics that contribute to shortened sleep duration, such as age, race, obesity, low physical activity, heavy alcohol use, high caffeine consumption, smoking (Bixler, 2009; Phillips, 1995; Temple et al., 2017; Schoenborn &amp; Adams, 2019; Stein &amp; Friedmann, 2005; Kredlow, 2015).</p>
<p>Few research studies have sought to identify whether these relationships hold when the outcome is sleep quality rather than duration.</p>
<p>Sleep quality may be different from sleep duration. The sleep cycle is complex and sleep duration is not always indicative of high-quality sleep. In addition, sufficient sleep duration may also vary depending on the individual (Bin, 2016).</p>
<p>Understanding factors associated with poor sleep quality could provide insight to actionable avenues for intervention and ultimately impact quality of life, and even morbidity and mortality.</p>
<h3 id="study-design">Study Design</h3>
<p>Data were obtained from National Health and Nutritional Examination Survey (NHANES) 2017-2018, a cross-sectional complex survey. Home interviews and exams were conducted on a nationally representative sample of adults and children in the United States. A population-based sample was derived from a complex multistage, probability sampling design. 9,254 participants were interviewed, and 8,704 were examined. Only participants aged 18 and older were included in the analysis, resulting in a study sample size of 5,856.</p>
<h3 id="data">Data</h3>
<p>Since this is a risk factor study, all exposures were considered equally with no primary exposure of interest. Potential risk factors were derived from evidence in the literature. BMI and caffeine intake were measured in the examination stage. Alcohol use, excessive daytime sleepiness, current smoking, depression score, race and ethnicity, age, and participation in moderate to vigorous exercise were all collected at the interview stage. All risk factors except for income-to-poverty ratio, were transformed into categorical variables based on literature-informed criteria and conventions.</p>
<p>Excessive daytime sleepiness was chosen as the outcome of interest. This outcome was selected over self-reported hours of sleep because it is an indicator of sleep quality, rather than sleep duration. The question asked to participants was In the past month, how often did {you/survey participant} feel excessively or overly sleepy during the day? Following the convention of Lal et al., participants responded as Often or Almost always were categorized as Yes, and other responses were categorized as No.This study was exploratory in nature and meant to be hypothesis-generating and replicate prior associations between behavioral risk factors and sleep quality.</p>
<h3 id="wrangling-the-data">Wrangling the data</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://here.r-lib.org/'>here</a></span><span class='op'>)</span>
<span class='co'>#Open foreign package to convert from XPT to CSV</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://svn.r-project.org/R-packages/trunk/foreign/'>foreign</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://dplyr.tidyverse.org'>dplyr</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://tidyverse.tidyverse.org'>tidyverse</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://here.r-lib.org/'>here</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/ddsjoberg/gtsummary'>gtsummary</a></span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#read in alcohol data</span>
<span class='va'>ALQ</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/foreign/man/read.xport.html'>read.xport</a></span><span class='op'>(</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"code/sleep/ALQ_J.XPT"</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'>#select variables of interest</span>
<span class='va'>myvars</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"SEQN"</span>, <span class='st'>"ALQ111"</span>, <span class='st'>"ALQ121"</span>, <span class='st'>"ALQ130"</span><span class='op'>)</span>
<span class='va'>ALQ_filt</span> <span class='op'>&lt;-</span> <span class='va'>ALQ</span><span class='op'>[</span><span class='va'>myvars</span><span class='op'>]</span>

<span class='co'>#export to excel</span>

<span class='fu'><a href='https://rdrr.io/r/utils/write.table.html'>write.csv</a></span><span class='op'>(</span><span class='va'>ALQ_filt</span>,file<span class='op'>=</span><span class='st'>"Alcohol_NHANES_2017.csv"</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#read in outcome (sleep hours) data </span>

<span class='va'>sleep</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/foreign/man/read.xport.html'>read.xport</a></span><span class='op'>(</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"code/sleep/SLQ_J.XPT"</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'>#select variables of interest</span>
<span class='va'>myvars2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"SEQN"</span>, <span class='st'>"SLD012"</span>, <span class='st'>"SLD013"</span>, <span class='st'>"SLQ120"</span><span class='op'>)</span>
<span class='va'>SLQ_filt</span> <span class='op'>&lt;-</span> <span class='va'>sleep</span><span class='op'>[</span><span class='va'>myvars2</span><span class='op'>]</span>


<span class='co'>## dichotomize daytime sleepiness </span>
<span class='va'>SLQ_filt</span> <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span><span class='va'>SLQ_filt</span>, day_sleep <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>SLQ_filt</span><span class='op'>$</span><span class='va'>SLQ120</span> <span class='op'>==</span> <span class='st'>'3'</span> <span class='op'>|</span> <span class='va'>SLQ_filt</span><span class='op'>$</span><span class='va'>SLQ120</span> <span class='op'>==</span> <span class='st'>'4'</span>,<span class='fl'>1</span>,<span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/utils/write.table.html'>write.csv</a></span><span class='op'>(</span><span class='va'>SLQ_filt</span>,file<span class='op'>=</span><span class='st'>"Sleep_NHANES_2017.csv"</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#read in demographic and weighting data</span>
<span class='va'>demog</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/foreign/man/read.xport.html'>read.xport</a></span><span class='op'>(</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"code/sleep/DEMO_J.XPT"</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'>#select variables of interest</span>
<span class='va'>myvars3</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"SEQN"</span>, <span class='st'>"RIAGENDR"</span>, <span class='st'>"RIDAGEYR"</span>, <span class='st'>"RIDRETH3"</span>, 
             <span class='st'>"WTINT2YR"</span>, <span class='st'>"WTMEC2YR"</span>, <span class='st'>"SDMVPSU"</span>, <span class='st'>"SDMVSTRA"</span>, <span class='st'>"INDFMPIR"</span><span class='op'>)</span>
<span class='va'>Demo_filt</span> <span class='op'>&lt;-</span> <span class='va'>demog</span><span class='op'>[</span><span class='va'>myvars3</span><span class='op'>]</span>

<span class='co'>#export to excel</span>

<span class='fu'><a href='https://rdrr.io/r/utils/write.table.html'>write.csv</a></span><span class='op'>(</span><span class='va'>Demo_filt</span>,file<span class='op'>=</span><span class='st'>"Demo_NHANES_2017.csv"</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#read in covariate (smoking) data</span>
<span class='va'>SMO</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/foreign/man/read.xport.html'>read.xport</a></span><span class='op'>(</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"code/sleep/SMQRTU_J.XPT"</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'>#select variables of interest</span>
<span class='va'>myvars</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"SEQN"</span>, <span class='st'>"SMQ681"</span><span class='op'>)</span>
<span class='va'>SMO_filt</span> <span class='op'>&lt;-</span> <span class='va'>SMO</span><span class='op'>[</span><span class='va'>myvars</span><span class='op'>]</span>

<span class='co'>#export to excel</span>

<span class='fu'><a href='https://rdrr.io/r/utils/write.table.html'>write.csv</a></span><span class='op'>(</span><span class='va'>SMO_filt</span>,file<span class='op'>=</span><span class='st'>"SMOKING_NHANES_2017.csv"</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#read in covariate (BMI) data</span>
<span class='va'>BMI</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/foreign/man/read.xport.html'>read.xport</a></span><span class='op'>(</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"code/sleep/BMX_J.XPT"</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'>#select variables of interest</span>
<span class='va'>myvars</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"SEQN"</span>, <span class='st'>"BMXBMI"</span><span class='op'>)</span>
<span class='va'>BMI_filt</span> <span class='op'>&lt;-</span> <span class='va'>BMI</span><span class='op'>[</span><span class='va'>myvars</span><span class='op'>]</span>

<span class='co'>#export to excel</span>

<span class='fu'><a href='https://rdrr.io/r/utils/write.table.html'>write.csv</a></span><span class='op'>(</span><span class='va'>BMI_filt</span>,file<span class='op'>=</span><span class='st'>"BMI_NHANES_2017.csv"</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#read in covariate (caffeine) data</span>
<span class='va'>Caffeine_d1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/foreign/man/read.xport.html'>read.xport</a></span><span class='op'>(</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"code/sleep/DR1TOT_J.XPT"</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>Caffeine_d2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/foreign/man/read.xport.html'>read.xport</a></span><span class='op'>(</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"code/sleep/DR2TOT_J.XPT"</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'>#select variables of interest</span>
<span class='va'>myvars</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"SEQN"</span>, <span class='st'>"DR1TCAFF"</span><span class='op'>)</span>
<span class='va'>Caff_filt</span> <span class='op'>&lt;-</span> <span class='va'>Caffeine_d1</span><span class='op'>[</span><span class='va'>myvars</span><span class='op'>]</span>

<span class='va'>myvars</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"SEQN"</span>, <span class='st'>"DR2TCAFF"</span><span class='op'>)</span>
<span class='va'>Caff2_filt</span> <span class='op'>&lt;-</span> <span class='va'>Caffeine_d2</span><span class='op'>[</span><span class='va'>myvars</span><span class='op'>]</span>

<span class='co'>## average the two days of caffeine measurements</span>
<span class='va'>caffday1</span> <span class='op'>&lt;-</span> <span class='va'>Caff_filt</span>

<span class='va'>caffday2</span> <span class='op'>&lt;-</span> <span class='va'>Caff2_filt</span>

<span class='va'>caffday1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate-joins.html'>left_join</a></span><span class='op'>(</span><span class='va'>caffday1</span>, <span class='va'>caffday2</span>, by <span class='op'>=</span> <span class='st'>"SEQN"</span><span class='op'>)</span>

<span class='va'>caffday1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/as.data.frame.html'>as.data.frame</a></span><span class='op'>(</span><span class='va'>caffday1</span><span class='op'>)</span>

<span class='va'>caffday1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span><span class='va'>caffday1</span>, avg_mg_caffeine<span class='op'>=</span><span class='op'>(</span><span class='va'>DR1TCAFF</span><span class='op'>+</span><span class='va'>DR2TCAFF</span><span class='op'>)</span><span class='op'>/</span><span class='fl'>2</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/utils/write.table.html'>write.csv</a></span><span class='op'>(</span><span class='va'>caffday1</span>, file<span class='op'>=</span><span class='st'>"Caffeine_NHANES_2017.csv"</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#read in covariate (Physical Activity) data</span>
<span class='va'>PA</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/foreign/man/read.xport.html'>read.xport</a></span><span class='op'>(</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"code/sleep/PAQ_J.XPT"</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'>#select variables of interest</span>
<span class='va'>myvars</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"SEQN"</span>, <span class='st'>"PAQ605"</span>,<span class='st'>"PAQ620"</span>,<span class='st'>"PAQ650"</span>,<span class='st'>"PAQ665"</span><span class='op'>)</span>
<span class='va'>PA_filt</span> <span class='op'>&lt;-</span> <span class='va'>PA</span><span class='op'>[</span><span class='va'>myvars</span><span class='op'>]</span>

<span class='co'>#export to excel</span>

<span class='fu'><a href='https://rdrr.io/r/utils/write.table.html'>write.csv</a></span><span class='op'>(</span><span class='va'>PA_filt</span>,file<span class='op'>=</span><span class='st'>"Activity_NHANES_2017.csv"</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#read in covariate (Depression) data</span>
<span class='va'>Depress</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/foreign/man/read.xport.html'>read.xport</a></span><span class='op'>(</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"code/sleep/DPQ_J.XPT"</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'>#All variables are of interest</span>

<span class='co'>#export to excel</span>

<span class='fu'><a href='https://rdrr.io/r/utils/write.table.html'>write.csv</a></span><span class='op'>(</span><span class='va'>Depress</span>,file<span class='op'>=</span><span class='st'>"Depression_NHANES_2017.csv"</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>Read the Excel files back into R to come back to later.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>demog</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://readr.tidyverse.org/reference/read_delim.html'>read_csv</a></span><span class='op'>(</span><span class='st'>"Demo_NHANES_2017.csv"</span>, show_col_types <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>

<span class='va'>sleep</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://readr.tidyverse.org/reference/read_delim.html'>read_csv</a></span><span class='op'>(</span><span class='st'>"Sleep_NHANES_2017.csv"</span>, show_col_types <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>

<span class='va'>alc</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://readr.tidyverse.org/reference/read_delim.html'>read_csv</a></span><span class='op'>(</span><span class='st'>"Alcohol_NHANES_2017.csv"</span>, show_col_types <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>Some of the data are labeled as numeric values if they were missing. Referring to NHANES documentation, you can see which numbers correspond to missing data, depending on the variable. It would be a good idea to convert them into simple NAs.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>alc</span><span class='op'>$</span><span class='va'>ALQ121</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/na_if.html'>na_if</a></span><span class='op'>(</span><span class='va'>alc</span><span class='op'>$</span><span class='va'>ALQ121</span>,<span class='fl'>77</span><span class='op'>)</span>
<span class='va'>alc</span><span class='op'>$</span><span class='va'>ALQ121</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/na_if.html'>na_if</a></span><span class='op'>(</span><span class='va'>alc</span><span class='op'>$</span><span class='va'>ALQ121</span>,<span class='fl'>99</span><span class='op'>)</span>

<span class='va'>alc</span><span class='op'>$</span><span class='va'>ALQ130</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/na_if.html'>na_if</a></span><span class='op'>(</span><span class='va'>alc</span><span class='op'>$</span><span class='va'>ALQ130</span>,<span class='fl'>777</span><span class='op'>)</span>
<span class='va'>alc</span><span class='op'>$</span><span class='va'>ALQ130</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/na_if.html'>na_if</a></span><span class='op'>(</span><span class='va'>alc</span><span class='op'>$</span><span class='va'>ALQ130</span>,<span class='fl'>999</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>activity</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://readr.tidyverse.org/reference/read_delim.html'>read_csv</a></span><span class='op'>(</span><span class='st'>"Activity_NHANES_2017.csv"</span>, show_col_types <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>

<span class='co'>#change to missing if "Refused" or "Don't Know"</span>
<span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>activity</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] &quot;...1&quot;   &quot;SEQN&quot;   &quot;PAQ605&quot; &quot;PAQ620&quot; &quot;PAQ650&quot; &quot;PAQ665&quot;</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>activity</span><span class='op'>$</span><span class='va'>PAQ605</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/na_if.html'>na_if</a></span><span class='op'>(</span><span class='va'>activity</span><span class='op'>$</span><span class='va'>PAQ605</span>,<span class='fl'>9</span><span class='op'>)</span>
<span class='va'>activity</span><span class='op'>$</span><span class='va'>PAQ620</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/na_if.html'>na_if</a></span><span class='op'>(</span><span class='va'>activity</span><span class='op'>$</span><span class='va'>PAQ620</span>,<span class='fl'>9</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>bmi</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://readr.tidyverse.org/reference/read_delim.html'>read_csv</a></span><span class='op'>(</span><span class='st'>"BMI_NHANES_2017.csv"</span>, show_col_types <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>

<span class='va'>caffeine</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://readr.tidyverse.org/reference/read_delim.html'>read_csv</a></span><span class='op'>(</span><span class='st'>"Caffeine_NHANES_2017.csv"</span>, show_col_types <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>

<span class='va'>Depress</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://readr.tidyverse.org/reference/read_delim.html'>read_csv</a></span><span class='op'>(</span><span class='st'>"Depression_NHANES_2017.csv"</span>, show_col_types <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>

<span class='co'>#change to missing if "Refused" or "Don't Know"</span>
<span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>Depress</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code> [1] &quot;...1&quot;   &quot;SEQN&quot;   &quot;DPQ010&quot; &quot;DPQ020&quot; &quot;DPQ030&quot; &quot;DPQ040&quot; &quot;DPQ050&quot;
 [8] &quot;DPQ060&quot; &quot;DPQ070&quot; &quot;DPQ080&quot; &quot;DPQ090&quot; &quot;DPQ100&quot;</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>Depress</span><span class='op'>$</span><span class='va'>DPQ010</span> <span class='op'>=</span> <span class='va'>Depress</span><span class='op'>$</span><span class='va'>DPQ010</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/na_if.html'>na_if</a></span><span class='op'>(</span><span class='fl'>9</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/na_if.html'>na_if</a></span><span class='op'>(</span><span class='fl'>7</span><span class='op'>)</span>

<span class='va'>Depress</span><span class='op'>$</span><span class='va'>DPQ020</span> <span class='op'>=</span> <span class='va'>Depress</span><span class='op'>$</span><span class='va'>DPQ020</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/na_if.html'>na_if</a></span><span class='op'>(</span><span class='fl'>9</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/na_if.html'>na_if</a></span><span class='op'>(</span><span class='fl'>7</span><span class='op'>)</span>

<span class='va'>Depress</span><span class='op'>$</span><span class='va'>DPQ030</span> <span class='op'>=</span> <span class='va'>Depress</span><span class='op'>$</span><span class='va'>DPQ030</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/na_if.html'>na_if</a></span><span class='op'>(</span><span class='fl'>9</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/na_if.html'>na_if</a></span><span class='op'>(</span><span class='fl'>7</span><span class='op'>)</span>

<span class='va'>Depress</span><span class='op'>$</span><span class='va'>DPQ040</span> <span class='op'>=</span> <span class='va'>Depress</span><span class='op'>$</span><span class='va'>DPQ040</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/na_if.html'>na_if</a></span><span class='op'>(</span><span class='fl'>9</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/na_if.html'>na_if</a></span><span class='op'>(</span><span class='fl'>7</span><span class='op'>)</span>

<span class='va'>Depress</span><span class='op'>$</span><span class='va'>DPQ050</span> <span class='op'>=</span> <span class='va'>Depress</span><span class='op'>$</span><span class='va'>DPQ050</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/na_if.html'>na_if</a></span><span class='op'>(</span><span class='fl'>9</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/na_if.html'>na_if</a></span><span class='op'>(</span><span class='fl'>7</span><span class='op'>)</span>

<span class='va'>Depress</span><span class='op'>$</span><span class='va'>DPQ050</span> <span class='op'>=</span> <span class='va'>Depress</span><span class='op'>$</span><span class='va'>DPQ050</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/na_if.html'>na_if</a></span><span class='op'>(</span><span class='fl'>9</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/na_if.html'>na_if</a></span><span class='op'>(</span><span class='fl'>7</span><span class='op'>)</span>

<span class='va'>Depress</span><span class='op'>$</span><span class='va'>DPQ060</span> <span class='op'>=</span> <span class='va'>Depress</span><span class='op'>$</span><span class='va'>DPQ060</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/na_if.html'>na_if</a></span><span class='op'>(</span><span class='fl'>9</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/na_if.html'>na_if</a></span><span class='op'>(</span><span class='fl'>7</span><span class='op'>)</span>

<span class='va'>Depress</span><span class='op'>$</span><span class='va'>DPQ070</span> <span class='op'>=</span> <span class='va'>Depress</span><span class='op'>$</span><span class='va'>DPQ070</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/na_if.html'>na_if</a></span><span class='op'>(</span><span class='fl'>9</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/na_if.html'>na_if</a></span><span class='op'>(</span><span class='fl'>7</span><span class='op'>)</span>

<span class='va'>Depress</span><span class='op'>$</span><span class='va'>DPQ080</span> <span class='op'>=</span> <span class='va'>Depress</span><span class='op'>$</span><span class='va'>DPQ080</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/na_if.html'>na_if</a></span><span class='op'>(</span><span class='fl'>9</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/na_if.html'>na_if</a></span><span class='op'>(</span><span class='fl'>7</span><span class='op'>)</span>

<span class='va'>Depress</span><span class='op'>$</span><span class='va'>DPQ090</span> <span class='op'>=</span> <span class='va'>Depress</span><span class='op'>$</span><span class='va'>DPQ090</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/na_if.html'>na_if</a></span><span class='op'>(</span><span class='fl'>9</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/na_if.html'>na_if</a></span><span class='op'>(</span><span class='fl'>7</span><span class='op'>)</span>

<span class='va'>smoking</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://readr.tidyverse.org/reference/read_delim.html'>read_csv</a></span><span class='op'>(</span><span class='st'>"SMOKING_NHANES_2017.csv"</span>, show_col_types <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>Now we must merge all of the component files by the individuals identifying number (SEQN). I decide to left join with demography file as the leftmost column, because I want to retain the denominator of individuals even if some the predictor and outcome variables are missing.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>one_tmp</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate-joins.html'>left_join</a></span><span class='op'>(</span><span class='va'>demog</span>, <span class='va'>sleep</span>, by<span class='op'>=</span><span class='st'>"SEQN"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate-joins.html'>left_join</a></span><span class='op'>(</span><span class='va'>.</span>, <span class='va'>alc</span> , by<span class='op'>=</span><span class='st'>"SEQN"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate-joins.html'>left_join</a></span><span class='op'>(</span><span class='va'>.</span>, <span class='va'>activity</span>, by<span class='op'>=</span><span class='st'>"SEQN"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate-joins.html'>left_join</a></span><span class='op'>(</span><span class='va'>.</span>, <span class='va'>bmi</span>, by<span class='op'>=</span><span class='st'>"SEQN"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate-joins.html'>left_join</a></span><span class='op'>(</span><span class='va'>.</span>, <span class='va'>caffeine</span>, by<span class='op'>=</span><span class='st'>"SEQN"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate-joins.html'>left_join</a></span><span class='op'>(</span><span class='va'>.</span>, <span class='va'>Depress</span>, by<span class='op'>=</span><span class='st'>"SEQN"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate-joins.html'>left_join</a></span><span class='op'>(</span><span class='va'>.</span>, <span class='va'>smoking</span>, by<span class='op'>=</span><span class='st'>"SEQN"</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>I created a summary depression score by summing all question responses except for DPQ100 (which was more of a measure of life quality than magnitude of depression.)</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>one_tmp</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span><span class='va'>one_tmp</span>, depress_score<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/colSums.html'>rowSums</a></span><span class='op'>(</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>one_tmp</span>, <span class='fu'><a href='https://tidyselect.r-lib.org/reference/starts_with.html'>starts_with</a></span><span class='op'>(</span><span class='st'>"DPQ"</span><span class='op'>)</span><span class='op'>&amp;</span> <span class='op'>!</span><span class='fu'><a href='https://tidyselect.r-lib.org/reference/starts_with.html'>ends_with</a></span><span class='op'>(</span><span class='st'>"100"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<h4 id="categorize-variables-based-on-clinically-meaningful-guidelines">Categorize variables based on clinically meaningful guidelines</h4>
<p>Now I turn depression into a categorical variable</p>
<p>Depression is categorized (dichotomized) based on guidelines:</p>
<ol type="1">
<li>No depression: no_dep = 1 if total score &lt;5; 0 if total score &gt;= 5.</li>
<li>Mild depression: mild_dep = 1 if total score &lt;10 and &gt;4; 0 otherwise.</li>
<li>Moderate depression: mod_dep = 1 if total score &gt;9 and &lt;15; 0 therwise</li>
<li>Moderate to severe: mod_sev_dep = 1 if total score &gt;14 and &lt;20; 0 otherwise</li>
<li>Severe: sev_dep = 1 if total score &gt;19; 0 otherwise</li>
</ol>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>one_tmp</span> <span class='op'>=</span> <span class='va'>one_tmp</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>depress_cat <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/cut.html'>cut</a></span><span class='op'>(</span><span class='va'>depress_score</span>, breaks <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='cn'>Inf</span>,<span class='fl'>4.5</span>,<span class='fl'>9.5</span>,<span class='fl'>14.5</span>,<span class='fl'>19.5</span>,<span class='cn'>Inf</span><span class='op'>)</span>, labels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>'nodep'</span>,<span class='st'>'mild_dep'</span>,<span class='st'>'mod_dep'</span>,<span class='st'>'mod_sev_dep'</span>,<span class='st'>'sev_dep'</span><span class='op'>)</span><span class='op'>)</span>
<span class='op'>)</span>
</code></pre>
</div>
</div>
<p>Create race and Hispanic ethnicity categories. Combined Non-Hispanic white and Non-Hispanic other and multiple races, to approximate the sampling domains.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>one_tmp</span> <span class='op'>=</span> <span class='va'>one_tmp</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>
  race1 <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>3</span>, <span class='fl'>3</span>, <span class='fl'>4</span>, <span class='fl'>1</span>, <span class='cn'>NA</span>, <span class='fl'>2</span>, <span class='fl'>4</span><span class='op'>)</span><span class='op'>[</span><span class='va'>RIDRETH3</span><span class='op'>]</span>,
                 labels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>'NH Black'</span>,<span class='st'>'NH Asian'</span>, <span class='st'>'Hispanic'</span>, <span class='st'>'NH White and Other'</span><span class='op'>)</span><span class='op'>)</span>,
  <span class='co'># Create race and Hispanic ethnicity categories for hypertension analysis </span>
  raceEthCat<span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>4</span>, <span class='fl'>4</span>, <span class='fl'>1</span>, <span class='fl'>2</span>, <span class='cn'>NA</span>, <span class='fl'>3</span>, <span class='fl'>5</span><span class='op'>)</span><span class='op'>[</span><span class='va'>RIDRETH3</span><span class='op'>]</span>,
                     labels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>'NH White'</span>, <span class='st'>'NH Black'</span>, <span class='st'>'NH Asian'</span>, <span class='st'>'Hispanic'</span>, <span class='st'>'NH Other/Multiple'</span><span class='op'>)</span><span class='op'>)</span>,
  <span class='co'># Create age categories for adults aged 18 and over: ages 18-39, 40-59, 60 and over</span>
  ageCat_18 <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/cut.html'>cut</a></span><span class='op'>(</span><span class='va'>RIDAGEYR</span>, breaks <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>17</span>, <span class='fl'>39</span>, <span class='fl'>59</span>, <span class='cn'>Inf</span><span class='op'>)</span>,
                  labels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>'18-39'</span>,<span class='st'>'40-59'</span>,<span class='st'>'60+'</span><span class='op'>)</span><span class='op'>)</span>
<span class='op'>)</span>
</code></pre>
</div>
</div>
<p>Regular moderate or vigorous activity reported? 1 = yes; 0 = no</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>one_tmp</span> <span class='op'>&lt;-</span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span><span class='va'>one_tmp</span>, activity<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>PAQ605</span><span class='op'>==</span><span class='fl'>1</span><span class='op'>|</span><span class='va'>PAQ620</span><span class='op'>==</span><span class='fl'>1</span><span class='op'>|</span><span class='va'>PAQ650</span><span class='op'>==</span><span class='fl'>1</span><span class='op'>|</span><span class='va'>PAQ665</span><span class='op'>==</span><span class='fl'>1</span>, <span class='fl'>1</span>, <span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>Recommended caffeine dose is 400 mg. Dichotomize to above and below that threshold:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>one_tmp</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span><span class='va'>one_tmp</span>, hi_caffeine<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>avg_mg_caffeine</span><span class='op'>&gt;</span><span class='fl'>400.0</span>,<span class='fl'>1</span>,<span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>There are standards for categorizing BMI. Lets carry them out here:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>one_tmp</span> <span class='op'>=</span> <span class='va'>one_tmp</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>BMI_cat <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/cut.html'>cut</a></span><span class='op'>(</span><span class='va'>BMXBMI</span>, breaks <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='cn'>Inf</span>,<span class='fl'>18.49</span>,<span class='fl'>24.9</span>, <span class='fl'>29.9</span>,<span class='cn'>Inf</span><span class='op'>)</span>, labels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>'underweight'</span>,<span class='st'>'normal'</span>,<span class='st'>'overweight'</span>,<span class='st'>'obese'</span><span class='op'>)</span><span class='op'>)</span>
<span class='op'>)</span>
</code></pre>
</div>
</div>
<p>Categorize alcohol use</p>
<p>Above 2 drinks a day for men or above 1 drink a day for women are considered in excess of moderate drinking. <a href="https://www.niaaa.nih.gov/alcohol-health/overview-alcohol-consumption/moderate-binge-drinking" class="uri">https://www.niaaa.nih.gov/alcohol-health/overview-alcohol-consumption/moderate-binge-drinking</a></p>
<p>Must account for those who responded that they were non-drinkers. Re-code alcohol consumption accounting for those who dont drink to correct missingness</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>one_tmp</span> <span class='op'>&lt;-</span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span><span class='va'>one_tmp</span>, 
                   heavy_drink <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='op'>(</span><span class='va'>ALQ130</span><span class='op'>&gt;</span><span class='fl'>2</span> <span class='op'>&amp;</span> <span class='va'>RIAGENDR</span> <span class='op'>==</span> <span class='fl'>1</span><span class='op'>)</span> 
                                        <span class='op'>|</span> <span class='op'>(</span><span class='va'>ALQ130</span><span class='op'>&gt;</span><span class='fl'>1</span> <span class='op'>&amp;</span> <span class='va'>RIAGENDR</span> <span class='op'>==</span> <span class='fl'>2</span><span class='op'>)</span>,<span class='fl'>1</span>, <span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>one_tmp</span> <span class='op'>=</span> <span class='va'>one_tmp</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>heavy_drink2 <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>ALQ111</span><span class='op'>==</span><span class='fl'>2</span> <span class='op'>|</span> <span class='va'>ALQ121</span><span class='op'>==</span><span class='fl'>0</span>, <span class='fl'>0</span>, <span class='va'>heavy_drink</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>Remove the columns that are artifcats of the conversion to .csv files.</p>
Filter the population to ages 18 and above
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>one_tmp</span> <span class='op'>=</span> <span class='va'>one_tmp</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://tidyselect.r-lib.org/reference/starts_with.html'>starts_with</a></span><span class='op'>(</span><span class='st'>"...1"</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>one_tmp</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code> [1] &quot;SEQN&quot;            &quot;RIAGENDR&quot;        &quot;RIDAGEYR&quot;       
 [4] &quot;RIDRETH3&quot;        &quot;WTINT2YR&quot;        &quot;WTMEC2YR&quot;       
 [7] &quot;SDMVPSU&quot;         &quot;SDMVSTRA&quot;        &quot;INDFMPIR&quot;       
[10] &quot;SLD012&quot;          &quot;SLD013&quot;          &quot;SLQ120&quot;         
[13] &quot;day_sleep&quot;       &quot;ALQ111&quot;          &quot;ALQ121&quot;         
[16] &quot;ALQ130&quot;          &quot;PAQ605&quot;          &quot;PAQ620&quot;         
[19] &quot;PAQ650&quot;          &quot;PAQ665&quot;          &quot;BMXBMI&quot;         
[22] &quot;DR1TCAFF&quot;        &quot;DR2TCAFF&quot;        &quot;avg_mg_caffeine&quot;
[25] &quot;DPQ010&quot;          &quot;DPQ020&quot;          &quot;DPQ030&quot;         
[28] &quot;DPQ040&quot;          &quot;DPQ050&quot;          &quot;DPQ060&quot;         
[31] &quot;DPQ070&quot;          &quot;DPQ080&quot;          &quot;DPQ090&quot;         
[34] &quot;DPQ100&quot;          &quot;SMQ681&quot;          &quot;depress_score&quot;  
[37] &quot;depress_cat&quot;     &quot;race1&quot;           &quot;raceEthCat&quot;     
[40] &quot;ageCat_18&quot;       &quot;activity&quot;        &quot;hi_caffeine&quot;    
[43] &quot;BMI_cat&quot;         &quot;heavy_drink&quot;     &quot;heavy_drink2&quot;   </code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Looks a lot better. </span>

<span class='va'>unweighted_data</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>one_tmp</span>, <span class='va'>RIDAGEYR</span> <span class='op'>&gt;=</span><span class='fl'>18</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<h3 id="correcting-for-missingness">Correcting for missingness</h3>
<p>How many are missing a the conventional 10% cutoff?</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>missing</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/colSums.html'>colSums</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>unweighted_data</span><span class='op'>)</span><span class='op'>)</span><span class='co'># Number of missing per variable</span>
<span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>unweighted_data</span><span class='op'>$</span><span class='va'>SEQN</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 5856</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>missing</span> <span class='op'>&lt;-</span> <span class='va'>missing</span><span class='op'>/</span><span class='fl'>5856</span>

<span class='va'>missing</span>
</code></pre>
</div>
<pre><code>           SEQN        RIAGENDR        RIDAGEYR        RIDRETH3 
   0.0000000000    0.0000000000    0.0000000000    0.0000000000 
       WTINT2YR        WTMEC2YR         SDMVPSU        SDMVSTRA 
   0.0000000000    0.0000000000    0.0000000000    0.0000000000 
       INDFMPIR          SLD012          SLD013          SLQ120 
   0.1425887978    0.0080259563    0.0095628415    0.0000000000 
      day_sleep          ALQ111          ALQ121          ALQ130 
   0.0000000000    0.1239754098    0.2245560109    0.4042008197 
         PAQ605          PAQ620          PAQ650          PAQ665 
   0.0010245902    0.0008538251    0.0000000000    0.0000000000 
         BMXBMI        DR1TCAFF        DR2TCAFF avg_mg_caffeine 
   0.0720628415    0.1490778689    0.2590505464    0.2590505464 
         DPQ010          DPQ020          DPQ030          DPQ040 
   0.1314890710    0.1313183060    0.1314890710    0.1316598361 
         DPQ050          DPQ060          DPQ070          DPQ080 
   0.1313183060    0.1320013661    0.1314890710    0.1318306011 
         DPQ090          DPQ100          SMQ681   depress_score 
   0.1316598361    0.4258879781    0.1236338798    0.1345628415 
    depress_cat           race1      raceEthCat       ageCat_18 
   0.1345628415    0.0000000000    0.0000000000    0.0000000000 
       activity     hi_caffeine         BMI_cat     heavy_drink 
   0.0011953552    0.2590505464    0.0720628415    0.4042008197 
   heavy_drink2 
   0.1256830601 </code></pre>
</div>
<p>Missingness: No individuals were missing the outcome. Missingness was below 15% for all covariates except for high caffeine intake, which was missing at a rate of 26%.</p>
<p>The data looks better now. Re-write full dataset to csv:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/utils/write.table.html'>write.csv</a></span><span class='op'>(</span><span class='va'>one_tmp</span>, <span class='st'>"fulldata_2017_NHANES.csv"</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>Now that we have cleaned the NHANES data to our liking, it is time to conduct the analysis.</p>
<p>Lets load the packages that we will need. Must load the tidyverse last because both the dplyr package from the tidyverse and the MASS package have a select() function and the one loaded last is the one that will be used.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'>if</span><span class='op'>(</span><span class='op'>!</span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>require</a></span><span class='op'>(</span><span class='va'><a href='https://r-forge.r-project.org/projects/car/'>car</a></span><span class='op'>)</span><span class='op'>)</span><span class='op'>{</span>   <span class='co'># for added variable plots, VIF</span>
    <span class='fu'><a href='https://rdrr.io/r/utils/install.packages.html'>install.packages</a></span><span class='op'>(</span><span class='st'>"car"</span><span class='op'>)</span>
    <span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://r-forge.r-project.org/projects/car/'>car</a></span><span class='op'>)</span>
<span class='op'>}</span>
<span class='kw'>if</span><span class='op'>(</span><span class='op'>!</span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>require</a></span><span class='op'>(</span><span class='va'><a href='https://sandwich.R-Forge.R-project.org/'>sandwich</a></span><span class='op'>)</span><span class='op'>)</span><span class='op'>{</span>   <span class='co'># for robust linear regression</span>
    <span class='fu'><a href='https://rdrr.io/r/utils/install.packages.html'>install.packages</a></span><span class='op'>(</span><span class='st'>"sandwich"</span><span class='op'>)</span>
    <span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://sandwich.R-Forge.R-project.org/'>sandwich</a></span><span class='op'>)</span>
<span class='op'>}</span>
<span class='kw'>if</span><span class='op'>(</span><span class='op'>!</span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>require</a></span><span class='op'>(</span><span class='va'><a href='https://ggobi.github.io/ggally/'>GGally</a></span><span class='op'>)</span><span class='op'>)</span><span class='op'>{</span>   <span class='co'># for fancier scatterplot matrices</span>
    <span class='fu'><a href='https://rdrr.io/r/utils/install.packages.html'>install.packages</a></span><span class='op'>(</span><span class='st'>"GGally"</span><span class='op'>)</span>
    <span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://ggobi.github.io/ggally/'>GGally</a></span><span class='op'>)</span>
<span class='op'>}</span>
  
<span class='kw'>if</span><span class='op'>(</span><span class='op'>!</span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>require</a></span><span class='op'>(</span><span class='va'><a href='https://broom.tidymodels.org/'>broom</a></span><span class='op'>)</span><span class='op'>)</span><span class='op'>{</span>   <span class='co'># for tidy model output using tidy() function</span>
    <span class='fu'><a href='https://rdrr.io/r/utils/install.packages.html'>install.packages</a></span><span class='op'>(</span><span class='st'>"broom"</span><span class='op'>)</span>
    <span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://broom.tidymodels.org/'>broom</a></span><span class='op'>)</span>
<span class='op'>}</span>  
 
<span class='kw'>if</span><span class='op'>(</span><span class='op'>!</span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>require</a></span><span class='op'>(</span><span class='va'>lmtest</span><span class='op'>)</span><span class='op'>)</span><span class='op'>{</span>   <span class='co'># coefficient test for robust variance</span>
    <span class='fu'><a href='https://rdrr.io/r/utils/install.packages.html'>install.packages</a></span><span class='op'>(</span><span class='st'>"lmtest"</span><span class='op'>)</span>
    <span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'>lmtest</span><span class='op'>)</span>
<span class='op'>}</span> 

<span class='kw'>if</span><span class='op'>(</span><span class='op'>!</span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>require</a></span><span class='op'>(</span><span class='va'><a href='https://tidyverse.tidyverse.org'>tidyverse</a></span><span class='op'>)</span><span class='op'>)</span><span class='op'>{</span>   <span class='co'># general functions for working with data</span>
    <span class='fu'><a href='https://rdrr.io/r/utils/install.packages.html'>install.packages</a></span><span class='op'>(</span><span class='st'>"tidyverse"</span><span class='op'>)</span>
    <span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://tidyverse.tidyverse.org'>tidyverse</a></span><span class='op'>)</span>
<span class='op'>}</span> 

<span class='kw'>if</span><span class='op'>(</span><span class='op'>!</span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>require</a></span><span class='op'>(</span><span class='va'><a href='http://r-survey.r-forge.r-project.org/survey/'>survey</a></span><span class='op'>)</span><span class='op'>)</span><span class='op'>{</span>   <span class='co'># general functions for working with data</span>
    <span class='fu'><a href='https://rdrr.io/r/utils/install.packages.html'>install.packages</a></span><span class='op'>(</span><span class='st'>"survey"</span><span class='op'>)</span>
    <span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='http://r-survey.r-forge.r-project.org/survey/'>survey</a></span><span class='op'>)</span>
<span class='op'>}</span> 
</code></pre>
</div>
</div>
<p>Subset the dataset to individuals 18 and older, because that is the population we would like to make inferences to.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>data</span> <span class='op'>&lt;-</span> <span class='va'>one_tmp</span>
<span class='va'>data</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span><span class='va'>data</span>,inAnalysis<span class='op'>=</span><span class='op'>(</span><span class='va'>RIDAGEYR</span> <span class='op'>&gt;=</span><span class='fl'>18</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'># explore data </span>
<span class='fu'><a href='https://pillar.r-lib.org/reference/glimpse.html'>glimpse</a></span><span class='op'>(</span><span class='va'>data</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Rows: 9,254
Columns: 46
$ SEQN            &lt;dbl&gt; 93703, 93704, 93705, 93706, 93707, 93708, 93~
$ RIAGENDR        &lt;dbl&gt; 2, 1, 2, 1, 1, 2, 2, 2, 1, 1, 1, 2, 1, 1, 1,~
$ RIDAGEYR        &lt;dbl&gt; 2, 2, 66, 18, 13, 66, 75, 0, 56, 18, 67, 54,~
$ RIDRETH3        &lt;dbl&gt; 6, 3, 4, 6, 7, 6, 4, 3, 6, 1, 3, 4, 7, 6, 3,~
$ WTINT2YR        &lt;dbl&gt; 9246.492, 37338.768, 8614.571, 8548.633, 676~
$ WTMEC2YR        &lt;dbl&gt; 8539.731, 42566.615, 8338.420, 8723.440, 706~
$ SDMVPSU         &lt;dbl&gt; 2, 1, 2, 2, 1, 2, 1, 1, 2, 2, 1, 1, 2, 1, 1,~
$ SDMVSTRA        &lt;dbl&gt; 145, 143, 145, 134, 138, 138, 136, 134, 134,~
$ INDFMPIR        &lt;dbl&gt; 5.00, 5.00, 0.82, NA, 1.88, 1.63, 0.41, 4.90~
$ SLD012          &lt;dbl&gt; NA, NA, 8.0, 10.5, NA, 8.0, 7.0, NA, 7.0, 7.~
$ SLD013          &lt;dbl&gt; NA, NA, 8.0, 11.5, NA, 8.0, 6.5, NA, 9.0, 9.~
$ SLQ120          &lt;dbl&gt; NA, NA, 0, 1, NA, 2, 1, NA, 3, 2, 2, 3, 4, 3~
$ day_sleep       &lt;dbl&gt; NA, NA, 0, 0, NA, 0, 0, NA, 1, 0, 0, 1, 1, 1~
$ ALQ111          &lt;dbl&gt; NA, NA, 1, 2, NA, 2, NA, NA, 1, 1, 1, 1, 1, ~
$ ALQ121          &lt;dbl&gt; NA, NA, 7, NA, NA, NA, NA, NA, 5, 0, 6, 9, 0~
$ ALQ130          &lt;dbl&gt; NA, NA, 1, NA, NA, NA, NA, NA, 1, NA, 3, 1, ~
$ PAQ605          &lt;dbl&gt; NA, NA, 2, 2, NA, 2, 2, NA, 2, 1, 2, 2, 1, 2~
$ PAQ620          &lt;dbl&gt; NA, NA, 2, 2, NA, 2, 1, NA, 2, 1, 2, 2, 1, 2~
$ PAQ650          &lt;dbl&gt; NA, NA, 2, 2, NA, 2, 2, NA, 1, 1, 2, 2, 1, 1~
$ PAQ665          &lt;dbl&gt; NA, NA, 1, 1, NA, 1, 2, NA, 1, 1, 1, 2, 2, 1~
$ BMXBMI          &lt;dbl&gt; 17.5, 15.7, 31.7, 21.5, 18.1, 23.7, 38.9, NA~
$ DR1TCAFF        &lt;dbl&gt; NA, 8, 361, 0, 21, 33, NA, 0, 347, 0, 385, 6~
$ DR2TCAFF        &lt;dbl&gt; NA, 6, 146, NA, 10, 0, NA, 1, 331, 137, 339,~
$ avg_mg_caffeine &lt;dbl&gt; NA, 7.0, 253.5, NA, 15.5, 16.5, NA, 0.5, 339~
$ DPQ010          &lt;dbl&gt; NA, NA, 0, 0, NA, 0, NA, NA, 1, 0, 1, 1, 0, ~
$ DPQ020          &lt;dbl&gt; NA, NA, 0, 0, NA, 0, NA, NA, 0, 0, 1, 0, 0, ~
$ DPQ030          &lt;dbl&gt; NA, NA, 0, 0, NA, 0, NA, NA, 1, 1, 2, 0, 3, ~
$ DPQ040          &lt;dbl&gt; NA, NA, 0, 0, NA, 0, NA, NA, 0, 0, 0, 1, 1, ~
$ DPQ050          &lt;dbl&gt; NA, NA, 0, 0, NA, 0, NA, NA, 0, 0, 1, 0, 0, ~
$ DPQ060          &lt;dbl&gt; NA, NA, 0, 0, NA, 0, NA, NA, 0, 0, 1, 0, 0, ~
$ DPQ070          &lt;dbl&gt; NA, NA, 0, 0, NA, 0, NA, NA, 0, 0, 2, 0, 0, ~
$ DPQ080          &lt;dbl&gt; NA, NA, 0, 0, NA, 0, NA, NA, 0, 0, 0, 0, 0, ~
$ DPQ090          &lt;dbl&gt; NA, NA, 0, 0, NA, 0, NA, NA, 0, 0, 0, 0, 0, ~
$ DPQ100          &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, 0, 0, 1, 0, ~
$ SMQ681          &lt;dbl&gt; NA, NA, 2, 2, 2, 2, NA, NA, 2, 1, 1, 2, 1, 2~
$ depress_score   &lt;dbl&gt; NA, NA, 0, 0, NA, 0, NA, NA, 2, 1, 8, 2, 4, ~
$ depress_cat     &lt;fct&gt; NA, NA, nodep, nodep, NA, nodep, NA, NA, nod~
$ race1           &lt;fct&gt; NH Asian, NH White and Other, NH Black, NH A~
$ raceEthCat      &lt;fct&gt; NH Asian, NH White, NH Black, NH Asian, NH O~
$ ageCat_18       &lt;fct&gt; NA, NA, 60+, 18-39, NA, 60+, 60+, NA, 40-59,~
$ activity        &lt;dbl&gt; NA, NA, 1, 1, NA, 1, 1, NA, 1, 1, 1, 0, 1, 1~
$ hi_caffeine     &lt;dbl&gt; NA, 0, 0, NA, 0, 0, NA, 0, 0, 0, 0, 0, 0, 0,~
$ BMI_cat         &lt;fct&gt; underweight, underweight, obese, normal, und~
$ heavy_drink     &lt;dbl&gt; NA, NA, 0, NA, NA, NA, NA, NA, 0, NA, 1, 0, ~
$ heavy_drink2    &lt;dbl&gt; NA, NA, 0, 0, NA, 0, NA, NA, 0, 0, 1, 0, 0, ~
$ inAnalysis      &lt;lgl&gt; FALSE, FALSE, TRUE, TRUE, FALSE, TRUE, TRUE,~</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>data</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code> [1] &quot;SEQN&quot;            &quot;RIAGENDR&quot;        &quot;RIDAGEYR&quot;       
 [4] &quot;RIDRETH3&quot;        &quot;WTINT2YR&quot;        &quot;WTMEC2YR&quot;       
 [7] &quot;SDMVPSU&quot;         &quot;SDMVSTRA&quot;        &quot;INDFMPIR&quot;       
[10] &quot;SLD012&quot;          &quot;SLD013&quot;          &quot;SLQ120&quot;         
[13] &quot;day_sleep&quot;       &quot;ALQ111&quot;          &quot;ALQ121&quot;         
[16] &quot;ALQ130&quot;          &quot;PAQ605&quot;          &quot;PAQ620&quot;         
[19] &quot;PAQ650&quot;          &quot;PAQ665&quot;          &quot;BMXBMI&quot;         
[22] &quot;DR1TCAFF&quot;        &quot;DR2TCAFF&quot;        &quot;avg_mg_caffeine&quot;
[25] &quot;DPQ010&quot;          &quot;DPQ020&quot;          &quot;DPQ030&quot;         
[28] &quot;DPQ040&quot;          &quot;DPQ050&quot;          &quot;DPQ060&quot;         
[31] &quot;DPQ070&quot;          &quot;DPQ080&quot;          &quot;DPQ090&quot;         
[34] &quot;DPQ100&quot;          &quot;SMQ681&quot;          &quot;depress_score&quot;  
[37] &quot;depress_cat&quot;     &quot;race1&quot;           &quot;raceEthCat&quot;     
[40] &quot;ageCat_18&quot;       &quot;activity&quot;        &quot;hi_caffeine&quot;    
[43] &quot;BMI_cat&quot;         &quot;heavy_drink&quot;     &quot;heavy_drink2&quot;   
[46] &quot;inAnalysis&quot;     </code></pre>
</div>
<p>Now, we would like to specify the categorical data as either nominal or ordinal data for our models. BMI categories, race, and age groups should be considered separately as nominal categories. Depression questionnaire scores have a natural ordered relationship, so we will specify the depression variable as an ordinal variable.</p>
<p>We must also set a reference group for the generalized linear models to improve our interpretations.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>data</span><span class='op'>$</span><span class='va'>BMI_cat</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>data</span><span class='op'>$</span><span class='va'>BMI_cat</span>, ordered <span class='op'>=</span> <span class='cn'>FALSE</span> <span class='op'>)</span>
<span class='va'>data</span><span class='op'>$</span><span class='va'>raceEthCat</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>data</span><span class='op'>$</span><span class='va'>raceEthCat</span>, ordered <span class='op'>=</span> <span class='cn'>FALSE</span> <span class='op'>)</span>
<span class='va'>data</span><span class='op'>$</span><span class='va'>ageCat_18</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>data</span><span class='op'>$</span><span class='va'>ageCat_18</span>, ordered <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
<span class='va'>data</span><span class='op'>$</span><span class='va'>depress_cat</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>ordered</a></span><span class='op'>(</span><span class='va'>data</span><span class='op'>$</span><span class='va'>depress_cat</span>, levels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"nodep"</span>,<span class='st'>"mild_dep"</span>,<span class='st'>"mod_dep"</span>,<span class='st'>"mod_sev_dep"</span>,<span class='st'>"sev_dep"</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'>#Set reference groups for statistical models</span>
<span class='va'>data</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/with.html'>within</a></span><span class='op'>(</span><span class='va'>data</span>, <span class='va'>raceEthCat</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/relevel.html'>relevel</a></span><span class='op'>(</span><span class='va'>raceEthCat</span>, ref <span class='op'>=</span> <span class='st'>"NH White"</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>data</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/with.html'>within</a></span><span class='op'>(</span><span class='va'>data</span>, <span class='va'>BMI_cat</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/relevel.html'>relevel</a></span><span class='op'>(</span><span class='va'>BMI_cat</span>, ref <span class='op'>=</span> <span class='st'>"normal"</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>data</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/with.html'>within</a></span><span class='op'>(</span><span class='va'>data</span>, <span class='va'>ageCat_18</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/relevel.html'>relevel</a></span><span class='op'>(</span><span class='va'>ageCat_18</span>, ref <span class='op'>=</span> <span class='st'>"18-39"</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<h4 id="table-1">Table 1</h4>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/kaz-yos/tableone'>tableone</a></span><span class='op'>)</span>
<span class='va'>listVars</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"RIAGENDR"</span>, <span class='st'>"ageCat_18"</span>, <span class='st'>"INDFMPIR"</span>, <span class='st'>"SMQ681"</span>, <span class='st'>"raceEthCat"</span>, <span class='st'>"activity"</span>, <span class='st'>"hi_caffeine"</span>, <span class='st'>"BMI_cat"</span>, <span class='st'>"heavy_drink2"</span>, <span class='st'>"depress_cat"</span><span class='op'>)</span>
<span class='va'>catVars</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"RIAGENDR"</span>, <span class='st'>"ageCat_18"</span>, <span class='st'>"SMQ681"</span>, <span class='st'>"raceEthCat"</span>, <span class='st'>"activity"</span>, <span class='st'>"hi_caffeine"</span>, <span class='st'>"BMI_cat"</span>, <span class='st'>"heavy_drink2"</span>, <span class='st'>"depress_cat"</span><span class='op'>)</span>

<span class='va'>table1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/tableone/man/CreateTableOne.html'>CreateTableOne</a></span><span class='op'>(</span>vars <span class='op'>=</span> <span class='va'>listVars</span>, data <span class='op'>=</span> <span class='va'>unweighted_data</span>, factorVars <span class='op'>=</span> <span class='va'>catVars</span>, strata<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"day_sleep"</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>dotable1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='va'>table1</span>, quote<span class='op'>=</span><span class='cn'>TRUE</span>, noSpaces<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>                        &quot;Stratified by day_sleep&quot;
 &quot;&quot;                      &quot;0&quot;           &quot;1&quot;           &quot;p&quot;      &quot;test&quot;
  &quot;n&quot;                    &quot;4339&quot;        &quot;1517&quot;        &quot;&quot;       &quot;&quot;    
  &quot;RIAGENDR = 2 (%)&quot;     &quot;2167 (49.9)&quot; &quot;849 (56.0)&quot;  &quot;&lt;0.001&quot; &quot;&quot;    
  &quot;ageCat_18 (%)&quot;        &quot;&quot;            &quot;&quot;            &quot;0.001&quot;  &quot;&quot;    
  &quot;   18-39&quot;             &quot;1405 (32.4)&quot; &quot;569 (37.5)&quot;  &quot;&quot;       &quot;&quot;    
  &quot;   40-59&quot;             &quot;1322 (30.5)&quot; &quot;410 (27.0)&quot;  &quot;&quot;       &quot;&quot;    
  &quot;   60+&quot;               &quot;1612 (37.2)&quot; &quot;538 (35.5)&quot;  &quot;&quot;       &quot;&quot;    
  &quot;INDFMPIR (mean (SD))&quot; &quot;2.60 (1.62)&quot; &quot;2.31 (1.57)&quot; &quot;&lt;0.001&quot; &quot;&quot;    
  &quot;SMQ681 = 2 (%)&quot;       &quot;3015 (79.5)&quot; &quot;1013 (75.5)&quot; &quot;0.003&quot;  &quot;&quot;    
  &quot;raceEthCat (%)&quot;       &quot;&quot;            &quot;&quot;            &quot;&lt;0.001&quot; &quot;&quot;    
  &quot;   NH White&quot;          &quot;1342 (30.9)&quot; &quot;690 (45.5)&quot;  &quot;&quot;       &quot;&quot;    
  &quot;   NH Black&quot;          &quot;1033 (23.8)&quot; &quot;310 (20.4)&quot;  &quot;&quot;       &quot;&quot;    
  &quot;   NH Asian&quot;          &quot;729 (16.8)&quot;  &quot;120 (7.9)&quot;   &quot;&quot;       &quot;&quot;    
  &quot;   Hispanic&quot;          &quot;1031 (23.8)&quot; &quot;304 (20.0)&quot;  &quot;&quot;       &quot;&quot;    
  &quot;   NH Other/Multiple&quot; &quot;204 (4.7)&quot;   &quot;93 (6.1)&quot;    &quot;&quot;       &quot;&quot;    
  &quot;activity = 1 (%)&quot;     &quot;2942 (67.9)&quot; &quot;1006 (66.4)&quot; &quot;0.325&quot;  &quot;&quot;    
  &quot;hi_caffeine = 1 (%)&quot;  &quot;139 (4.4)&quot;   &quot;81 (7.0)&quot;    &quot;0.001&quot;  &quot;&quot;    
  &quot;BMI_cat (%)&quot;          &quot;&quot;            &quot;&quot;            &quot;&lt;0.001&quot; &quot;&quot;    
  &quot;   underweight&quot;       &quot;76 (1.9)&quot;    &quot;23 (1.6)&quot;    &quot;&quot;       &quot;&quot;    
  &quot;   normal&quot;            &quot;1074 (26.7)&quot; &quot;298 (21.1)&quot;  &quot;&quot;       &quot;&quot;    
  &quot;   overweight&quot;        &quot;1333 (33.2)&quot; &quot;394 (27.9)&quot;  &quot;&quot;       &quot;&quot;    
  &quot;   obese&quot;             &quot;1538 (38.2)&quot; &quot;698 (49.4)&quot;  &quot;&quot;       &quot;&quot;    
  &quot;heavy_drink2 = 1 (%)&quot; &quot;1180 (31.2)&quot; &quot;503 (37.6)&quot;  &quot;&lt;0.001&quot; &quot;&quot;    
  &quot;depress_cat (%)&quot;      &quot;&quot;            &quot;&quot;            &quot;&lt;0.001&quot; &quot;&quot;    
  &quot;   nodep&quot;             &quot;3093 (82.5)&quot; &quot;679 (51.4)&quot;  &quot;&quot;       &quot;&quot;    
  &quot;   mild_dep&quot;          &quot;456 (12.2)&quot;  &quot;381 (28.8)&quot;  &quot;&quot;       &quot;&quot;    
  &quot;   mod_dep&quot;           &quot;134 (3.6)&quot;   &quot;158 (12.0)&quot;  &quot;&quot;       &quot;&quot;    
  &quot;   mod_sev_dep&quot;       &quot;48 (1.3)&quot;    &quot;76 (5.8)&quot;    &quot;&quot;       &quot;&quot;    
  &quot;   sev_dep&quot;           &quot;16 (0.4)&quot;    &quot;27 (2.0)&quot;    &quot;&quot;       &quot;&quot;    </code></pre>
</div>
<h4 id="figure-1-caffeine-intake-and-daytime-sleepiness">Figure 1: Caffeine intake and Daytime Sleepiness</h4>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#png("Barplot Caffeine.png")</span>
<span class='va'>counts</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span><span class='op'>(</span><span class='va'>unweighted_data</span><span class='op'>$</span><span class='va'>hi_caffeine</span>, <span class='va'>unweighted_data</span><span class='op'>$</span><span class='va'>day_sleep</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/barplot.html'>barplot</a></span><span class='op'>(</span><span class='va'>counts</span>, main<span class='op'>=</span><span class='st'>"High Caffeine Intake by Daytime Sleepiness"</span>,
        ylab <span class='op'>=</span> <span class='st'>"Number of Individuals"</span>,
        xlab<span class='op'>=</span><span class='st'>"Daytime Sleepiness"</span>, col<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"darkblue"</span>,<span class='st'>"purple"</span><span class='op'>)</span>,
        legend <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Low Caffeine Intake"</span>, <span class='st'>"High Caffeine Intake"</span><span class='op'>)</span>, beside<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
</code></pre>
</div>
<img src="projects_files/figure-html5/unnamed-chunk-28-1.png" width="624" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#dev.off()</span>
</code></pre>
</div>
</div>
<h4 id="figure-2-dperession-and-daytime-sleepiness">Figure 2: Dperession and Daytime Sleepiness</h4>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#png("Barplot Depression.png")</span>
<span class='va'>counts</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span><span class='op'>(</span><span class='va'>unweighted_data</span><span class='op'>$</span><span class='va'>depress_cat</span>, <span class='va'>unweighted_data</span><span class='op'>$</span><span class='va'>day_sleep</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/barplot.html'>barplot</a></span><span class='op'>(</span><span class='va'>counts</span>, main<span class='op'>=</span><span class='st'>"Depression Category Distribution by Daytime Sleepiness"</span>,
        ylab <span class='op'>=</span> <span class='st'>"Number of Individuals"</span>,
        xlab<span class='op'>=</span><span class='st'>"Daytime Sleepiness"</span>, col<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"darkblue"</span>,<span class='st'>"purple"</span>,<span class='st'>"orange"</span>,<span class='st'>"yellow"</span>,<span class='st'>"lightblue"</span><span class='op'>)</span>,
        legend <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"No Depression"</span>, <span class='st'>"Mild Depression"</span>, <span class='st'>"Moderate Depression"</span>, <span class='st'>"Moderate/severe Depression"</span>, <span class='st'>"Severe Depression"</span><span class='op'>)</span>, beside<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
</code></pre>
</div>
<img src="projects_files/figure-html5/unnamed-chunk-29-1.png" width="624" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#dev.off()</span>
</code></pre>
</div>
</div>
<h3 id="statistical-methods">Statistical Methods</h3>
<p>Lets develop a pipeline for our statistical analyses!</p>
<ul>
<li>Part a: Scatterplot matrices</li>
<li>Part b: Fit weighted and unweighted SLRs</li>
<li>Part c: Fit initial weighted and unweighted MLR model using all predictors</li>
<li>Part d: Best subset model selection and human-selected model</li>
<li>Part e. Compare model AICs and goodness of fit</li>
<li>Part f: Check model: Analysis of Residuals</li>
<li>Part f-1: Plot person residuals -vs- predicted values</li>
<li>Part f-2: Boxplot and list outlier studentized residuals</li>
<li>Part g: Check model: leverage boxplots</li>
<li>Part h: Check model: influence</li>
<li>Part h-1: Make boxplot and list outliers for influence</li>
<li>Part h-2: Leverage -vs- residual squared (L-R) plot</li>
<li>Part i: Sensitivity analysis: Re-fit without influential points</li>
<li>Part j: Check for multi-collinearity using variance inflation factors</li>
</ul>
<p class="heading" id="section"></p>
<h4 id="part-a-scatterplot-matrices">Part a: Scatterplot matrices</h4>
<p>Using the ggpairs() function, which is nice for getting a quick scatterplot matrix plot</p>
<p>We must first created an unweighted dataset of those &gt;=18.</p>
<p>Then we will make two separate scatterplot matrices. We must do this because if we make one matrix, it will be way too large and difficult to read. First we will make one of personal characteristics, and second, we will make one of lifestyle/behavioral characteristics.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>unweighted_data</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>data</span>, <span class='va'>RIDAGEYR</span> <span class='op'>&gt;=</span><span class='fl'>18</span><span class='op'>)</span>

<span class='co'>#pdf("scatterplot_matrices_person.pdf")</span>
<span class='va'>unweighted_data</span> <span class='op'><a href='https://ggobi.github.io/ggally/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>RIAGENDR</span>, <span class='va'>RIDAGEYR</span>, <span class='va'>INDFMPIR</span>,<span class='va'>depress_score</span>,<span class='va'>BMXBMI</span><span class='op'>)</span> <span class='op'><a href='https://ggobi.github.io/ggally/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://rdrr.io/r/graphics/pairs.html'>pairs</a></span><span class='op'>(</span>upper.panel<span class='op'>=</span><span class='cn'>NULL</span><span class='op'>)</span>
</code></pre>
</div>
<img src="projects_files/figure-html5/unnamed-chunk-30-1.png" width="624" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#dev.off()</span>

<span class='co'>#pdf("scatterplot_matrices_behavior.pdf")</span>
<span class='va'>unweighted_data</span> <span class='op'><a href='https://ggobi.github.io/ggally/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>avg_mg_caffeine</span>,<span class='va'>SMQ681</span>,<span class='va'>ALQ130</span>,<span class='va'>activity</span><span class='op'>)</span> <span class='op'><a href='https://ggobi.github.io/ggally/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://rdrr.io/r/graphics/pairs.html'>pairs</a></span><span class='op'>(</span>upper.panel<span class='op'>=</span><span class='cn'>NULL</span><span class='op'>)</span>
</code></pre>
</div>
<img src="projects_files/figure-html5/unnamed-chunk-30-2.png" width="624" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#dev.off()</span>
</code></pre>
</div>
</div>
<p>There is no clear correlation between Xs.</p>
<h4 id="part-b-fit-weighted-and-unweighted-slrs">Part b: Fit weighted and unweighted SLRs</h4>
<p>Create a survey weight object</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>NHANES_all</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/survey/man/svydesign.html'>svydesign</a></span><span class='op'>(</span>data<span class='op'>=</span><span class='va'>data</span>, id<span class='op'>=</span><span class='op'>~</span><span class='va'>SDMVPSU</span>, strata<span class='op'>=</span><span class='op'>~</span><span class='va'>SDMVSTRA</span>, weights<span class='op'>=</span><span class='op'>~</span><span class='va'>WTINT2YR</span>, nest<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
<span class='va'>NHANES_all_MEC</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/survey/man/svydesign.html'>svydesign</a></span><span class='op'>(</span>data<span class='op'>=</span><span class='va'>data</span>, id<span class='op'>=</span><span class='op'>~</span><span class='va'>SDMVPSU</span>, strata<span class='op'>=</span><span class='op'>~</span><span class='va'>SDMVSTRA</span>, weights<span class='op'>=</span><span class='op'>~</span><span class='va'>WTMEC2YR</span>, nest<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>

<span class='va'>NHANES</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/subset.html'>subset</a></span><span class='op'>(</span><span class='va'>NHANES_all</span>, <span class='va'>inAnalysis</span><span class='op'>==</span><span class='fl'>1</span><span class='op'>)</span>
<span class='va'>NHANES_MEC</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/subset.html'>subset</a></span><span class='op'>(</span><span class='va'>NHANES_all_MEC</span>, <span class='va'>inAnalysis</span><span class='op'>==</span><span class='fl'>1</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>Fit the weighted univariate models and store the results. We are calculating the change in log prevalence odds of daytime sleepiness, our outcome, among levels of the exposures. Our exposures of interest are sex, age groups, income, smoking, race/ethnicity, any activity, high caffeine intake, BMI categories, heavy drinking, and ordinal depression scores. Log-binomial regression is used to estimate crude associations.</p>
<div class="layout-chunk" data-layout="l-body">

</div>
<p>Lets also look at the univariate associations in unweighted models. We expect a change in the standard errors. It will not be as representative of the US population.</p>
<div class="layout-chunk" data-layout="l-body">

</div>
<h4 id="part-c-fit-initial-mlr-using-all-predictors">Part c: Fit initial MLR using all predictors</h4>
<p>Multivariable Poisson regression with robust standard errors will be used to estimate adjusted prevalence ratios. Unweighted multivariable candidate models were selected in 4 ways:</p>
<ol type="1">
<li>Including all predictors</li>
<li>Best subset selection</li>
<li>a-priori selection based on literature and common knowledge</li>
<li>Combination of a priori and best-subset</li>
</ol>
<p>First, lets run the models with every predictor</p>
<p>Note: logit models failed to converge. Use poisson model. From the svy package: svyglm always returns model-robust standard errors; the Horvitz-Thompson-type standard errors used everywhere in the survey package are a generalisation of the model-robust sandwich estimators. In particular, a quasi-Poisson svyglm will return correct standard errors for relative risk regression models.</p>
<p><strong>Using Exam weights (recommended):</strong></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>MLR_1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/survey/man/svyglm.html'>svyglm</a></span><span class='op'>(</span><span class='va'>day_sleep</span><span class='op'>~</span><span class='va'>RIAGENDR</span><span class='op'>+</span> <span class='va'>INDFMPIR</span> <span class='op'>+</span> <span class='va'>SMQ681</span> <span class='op'>+</span> <span class='va'>ageCat_18</span><span class='op'>+</span>
                           <span class='op'>+</span> <span class='va'>raceEthCat</span> <span class='op'>+</span> <span class='va'>activity</span> <span class='op'>+</span> <span class='va'>hi_caffeine</span> <span class='op'>+</span> <span class='va'>BMI_cat</span> <span class='op'>+</span> 
                             <span class='va'>heavy_drink2</span> <span class='op'>+</span> <span class='va'>depress_cat</span>, design<span class='op'>=</span><span class='va'>NHANES_MEC</span>, 
                           family<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/stats/family.html'>quasipoisson</a></span><span class='op'>(</span>link<span class='op'>=</span><span class='st'>"log"</span><span class='op'>)</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>MLR_1</span>, df.resid <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/survey/man/svychisq.html'>degf</a></span><span class='op'>(</span><span class='va'>NHANES_MEC</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>
Call:
svyglm(formula = day_sleep ~ RIAGENDR + INDFMPIR + SMQ681 + ageCat_18 + 
    +raceEthCat + activity + hi_caffeine + BMI_cat + heavy_drink2 + 
    depress_cat, design = NHANES_MEC, family = quasipoisson(link = &quot;log&quot;))

Survey design:
subset(NHANES_all_MEC, inAnalysis == 1)

Coefficients:
                             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                 -1.082160   0.233512  -4.634 0.000324 ***
RIAGENDR                     0.121471   0.078823   1.541 0.144130    
INDFMPIR                    -0.052522   0.019994  -2.627 0.019049 *  
SMQ681                       0.095709   0.068990   1.387 0.185622    
ageCat_1840-59              -0.226165   0.095069  -2.379 0.031076 *  
ageCat_1860+                -0.238507   0.081341  -2.932 0.010300 *  
raceEthCatNH Black          -0.238056   0.105131  -2.264 0.038800 *  
raceEthCatNH Asian          -0.557554   0.173805  -3.208 0.005868 ** 
raceEthCatHispanic          -0.307914   0.099593  -3.092 0.007442 ** 
raceEthCatNH Other/Multiple  0.064766   0.159042   0.407 0.689595    
activity                     0.026327   0.057780   0.456 0.655168    
hi_caffeine                  0.226425   0.095594   2.369 0.031709 *  
BMI_catunderweight          -0.062413   0.362150  -0.172 0.865473    
BMI_catoverweight            0.105170   0.160207   0.656 0.521471    
BMI_catobese                 0.380563   0.106197   3.584 0.002716 ** 
heavy_drink2                 0.058645   0.083379   0.703 0.492609    
depress_cat.L                0.643917   0.102021   6.312 1.39e-05 ***
depress_cat.Q               -0.426273   0.084199  -5.063 0.000140 ***
depress_cat.C                0.239641   0.093666   2.558 0.021828 *  
depress_cat^4               -0.005434   0.075550  -0.072 0.943615    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Zero or negative residual df; p-values not defined

(Dispersion parameter for quasipoisson family taken to be 0.8208122)

Number of Fisher Scoring iterations: 6</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#linearHypothesis(MLR_1, "ageCat_1818-39=ageCat_1840-59")</span>
<span class='co'>#linearHypothesis(MLR_1, "ageCat_1818-39=ageCat_1860+")</span>

<span class='fu'><a href='https://rdrr.io/r/base/Log.html'>exp</a></span><span class='op'>(</span><span class='va'>MLR_1</span><span class='op'>$</span><span class='va'>coefficients</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>                (Intercept)                    RIAGENDR 
                  0.3388629                   1.1291569 
                   INDFMPIR                      SMQ681 
                  0.9488333                   1.1004391 
             ageCat_1840-59                ageCat_1860+ 
                  0.7975861                   0.7878033 
         raceEthCatNH Black          raceEthCatNH Asian 
                  0.7881582                   0.5726078 
         raceEthCatHispanic raceEthCatNH Other/Multiple 
                  0.7349785                   1.0669093 
                   activity                 hi_caffeine 
                  1.0266769                   1.2541089 
         BMI_catunderweight           BMI_catoverweight 
                  0.9394944                   1.1108992 
               BMI_catobese                heavy_drink2 
                  1.4631086                   1.0603987 
              depress_cat.L               depress_cat.Q 
                  1.9039230                   0.6529379 
              depress_cat.C               depress_cat^4 
                  1.2707934                   0.9945811 </code></pre>
</div>
<p><strong>Using Interview weights</strong></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>MLR_2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/survey/man/svyglm.html'>svyglm</a></span><span class='op'>(</span><span class='va'>day_sleep</span><span class='op'>~</span><span class='va'>RIAGENDR</span> <span class='op'>+</span> <span class='va'>ageCat_18</span> <span class='op'>+</span> <span class='va'>INDFMPIR</span> <span class='op'>+</span> <span class='va'>SMQ681</span> 
                <span class='op'>+</span> <span class='va'>raceEthCat</span> <span class='op'>+</span> <span class='va'>activity</span> <span class='op'>+</span> <span class='va'>hi_caffeine</span> <span class='op'>+</span> <span class='va'>BMI_cat</span> <span class='op'>+</span> 
                  <span class='va'>heavy_drink2</span> <span class='op'>+</span> <span class='va'>depress_cat</span>, design<span class='op'>=</span><span class='va'>NHANES</span>, 
                family<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/stats/family.html'>quasipoisson</a></span><span class='op'>(</span>link<span class='op'>=</span><span class='st'>"log"</span><span class='op'>)</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>MLR_2</span>, df.resid <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/survey/man/svychisq.html'>degf</a></span><span class='op'>(</span><span class='va'>NHANES</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>
Call:
svyglm(formula = day_sleep ~ RIAGENDR + ageCat_18 + INDFMPIR + 
    SMQ681 + raceEthCat + activity + hi_caffeine + BMI_cat + 
    heavy_drink2 + depress_cat, design = NHANES, family = quasipoisson(link = &quot;log&quot;))

Survey design:
subset(NHANES_all, inAnalysis == 1)

Coefficients:
                             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                 -1.089417   0.237501  -4.587 0.000356 ***
RIAGENDR                     0.125684   0.080332   1.565 0.138535    
ageCat_1840-59              -0.226016   0.093995  -2.405 0.029561 *  
ageCat_1860+                -0.252454   0.080819  -3.124 0.006972 ** 
INDFMPIR                    -0.052001   0.019399  -2.681 0.017113 *  
SMQ681                       0.093046   0.069257   1.343 0.199087    
raceEthCatNH Black          -0.239878   0.105846  -2.266 0.038658 *  
raceEthCatNH Asian          -0.556917   0.176800  -3.150 0.006607 ** 
raceEthCatHispanic          -0.306654   0.098127  -3.125 0.006952 ** 
raceEthCatNH Other/Multiple  0.065960   0.164823   0.400 0.694660    
activity                     0.039479   0.059561   0.663 0.517487    
hi_caffeine                  0.235958   0.094373   2.500 0.024492 *  
BMI_catunderweight          -0.097781   0.377249  -0.259 0.799009    
BMI_catoverweight            0.107206   0.162556   0.660 0.519570    
BMI_catobese                 0.380365   0.107844   3.527 0.003050 ** 
heavy_drink2                 0.052873   0.082232   0.643 0.529948    
depress_cat.L                0.643541   0.105453   6.103 2.02e-05 ***
depress_cat.Q               -0.422803   0.083392  -5.070 0.000138 ***
depress_cat.C                0.250825   0.089710   2.796 0.013570 *  
depress_cat^4                0.001431   0.076402   0.019 0.985299    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Zero or negative residual df; p-values not defined

(Dispersion parameter for quasipoisson family taken to be 0.7764147)

Number of Fisher Scoring iterations: 6</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>exp</a></span><span class='op'>(</span><span class='va'>MLR_2</span><span class='op'>$</span><span class='va'>coefficients</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>                (Intercept)                    RIAGENDR 
                  0.3364125                   1.1339234 
             ageCat_1840-59                ageCat_1860+ 
                  0.7977057                   0.7768921 
                   INDFMPIR                      SMQ681 
                  0.9493281                   1.0975126 
         raceEthCatNH Black          raceEthCatNH Asian 
                  0.7867238                   0.5729726 
         raceEthCatHispanic raceEthCatNH Other/Multiple 
                  0.7359049                   1.0681840 
                   activity                 hi_caffeine 
                  1.0402691                   1.2661215 
         BMI_catunderweight           BMI_catoverweight 
                  0.9068478                   1.1131640 
               BMI_catobese                heavy_drink2 
                  1.4628178                   1.0542955 
              depress_cat.L               depress_cat.Q 
                  1.9032081                   0.6552077 
              depress_cat.C               depress_cat^4 
                  1.2850850                   1.0014325 </code></pre>
</div>
<p><strong>Un-weighted</strong></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>MLR_3</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/glm.html'>glm</a></span><span class='op'>(</span><span class='va'>day_sleep</span><span class='op'>~</span><span class='va'>RIAGENDR</span> <span class='op'>+</span> <span class='va'>ageCat_18</span> <span class='op'>+</span> <span class='va'>INDFMPIR</span> <span class='op'>+</span> <span class='va'>SMQ681</span> 
             <span class='op'>+</span> <span class='va'>raceEthCat</span> <span class='op'>+</span> <span class='va'>activity</span> <span class='op'>+</span> <span class='va'>hi_caffeine</span> <span class='op'>+</span> <span class='va'>BMI_cat</span> <span class='op'>+</span> 
               <span class='va'>heavy_drink2</span> <span class='op'>+</span> <span class='va'>depress_cat</span>, family<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/stats/family.html'>poisson</a></span><span class='op'>(</span>link<span class='op'>=</span><span class='st'>"log"</span><span class='op'>)</span>, data <span class='op'>=</span> <span class='va'>unweighted_data</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>MLR_3</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>
Call:
glm(formula = day_sleep ~ RIAGENDR + ageCat_18 + INDFMPIR + SMQ681 + 
    raceEthCat + activity + hi_caffeine + BMI_cat + heavy_drink2 + 
    depress_cat, family = poisson(link = &quot;log&quot;), data = unweighted_data)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-1.3717  -0.6854  -0.5868   0.3796   1.7553  

Coefficients:
                            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                 -0.80381    0.20016  -4.016 5.92e-05 ***
RIAGENDR                     0.06662    0.06524   1.021  0.30718    
ageCat_1840-59              -0.18448    0.08036  -2.296  0.02169 *  
ageCat_1860+                -0.19778    0.08158  -2.424  0.01534 *  
INDFMPIR                    -0.03071    0.02143  -1.433  0.15184    
SMQ681                       0.10030    0.08124   1.235  0.21696    
raceEthCatNH Black          -0.34815    0.08526  -4.083 4.44e-05 ***
raceEthCatNH Asian          -0.64845    0.13840  -4.686 2.79e-06 ***
raceEthCatHispanic          -0.37725    0.08883  -4.247 2.17e-05 ***
raceEthCatNH Other/Multiple -0.13584    0.13158  -1.032  0.30192    
activity                    -0.06755    0.07090  -0.953  0.34068    
hi_caffeine                  0.11217    0.12508   0.897  0.36983    
BMI_catunderweight          -0.26905    0.28795  -0.934  0.35012    
BMI_catoverweight            0.08017    0.09485   0.845  0.39798    
BMI_catobese                 0.23308    0.08521   2.735  0.00623 ** 
heavy_drink2                 0.02428    0.07038   0.345  0.73014    
depress_cat.L                0.72063    0.15763   4.572 4.84e-06 ***
depress_cat.Q               -0.43440    0.14050  -3.092  0.00199 ** 
depress_cat.C                0.21783    0.12248   1.779  0.07531 .  
depress_cat^4               -0.05760    0.10252  -0.562  0.57419    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 2612.4  on 3678  degrees of freedom
Residual deviance: 2320.8  on 3659  degrees of freedom
  (2177 observations deleted due to missingness)
AIC: 4384.8

Number of Fisher Scoring iterations: 6</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/pkg/lmtest/man/coeftest.html'>coeftest</a></span><span class='op'>(</span><span class='va'>MLR_3</span>, vcov <span class='op'>=</span> <span class='va'>sandwich</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>
z test of coefficients:

                             Estimate Std. Error z value  Pr(&gt;|z|)
(Intercept)                 -0.803810   0.155923 -5.1552 2.534e-07
RIAGENDR                     0.066625   0.052285  1.2743  0.202572
ageCat_1840-59              -0.184479   0.063186 -2.9196  0.003504
ageCat_1860+                -0.197776   0.065378 -3.0251  0.002485
INDFMPIR                    -0.030711   0.017555 -1.7494  0.080213
SMQ681                       0.100302   0.064105  1.5647  0.117662
raceEthCatNH Black          -0.348150   0.069915 -4.9796 6.370e-07
raceEthCatNH Asian          -0.648454   0.123021 -5.2711 1.356e-07
raceEthCatHispanic          -0.377252   0.071291 -5.2917 1.212e-07
raceEthCatNH Other/Multiple -0.135836   0.098084 -1.3849  0.166087
activity                    -0.067554   0.056518 -1.1952  0.231990
hi_caffeine                  0.112169   0.094040  1.1928  0.232956
BMI_catunderweight          -0.269051   0.228246 -1.1788  0.238488
BMI_catoverweight            0.080168   0.079409  1.0096  0.312710
BMI_catobese                 0.233082   0.070999  3.2829  0.001027
heavy_drink2                 0.024277   0.056023  0.4333  0.664765
depress_cat.L                0.720634   0.097246  7.4104 1.259e-13
depress_cat.Q               -0.434399   0.086629 -5.0145 5.318e-07
depress_cat.C                0.217833   0.075467  2.8864  0.003896
depress_cat^4               -0.057602   0.065414 -0.8806  0.378544
                               
(Intercept)                 ***
RIAGENDR                       
ageCat_1840-59              ** 
ageCat_1860+                ** 
INDFMPIR                    .  
SMQ681                         
raceEthCatNH Black          ***
raceEthCatNH Asian          ***
raceEthCatHispanic          ***
raceEthCatNH Other/Multiple    
activity                       
hi_caffeine                    
BMI_catunderweight             
BMI_catoverweight              
BMI_catobese                ** 
heavy_drink2                   
depress_cat.L               ***
depress_cat.Q               ***
depress_cat.C               ** 
depress_cat^4                  
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>exp</a></span><span class='op'>(</span><span class='va'>MLR_3</span><span class='op'>$</span><span class='va'>coefficients</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>                (Intercept)                    RIAGENDR 
                  0.4476202                   1.0688942 
             ageCat_1840-59                ageCat_1860+ 
                  0.8315377                   0.8205536 
                   INDFMPIR                      SMQ681 
                  0.9697560                   1.1055052 
         raceEthCatNH Black          raceEthCatNH Asian 
                  0.7059933                   0.5228535 
         raceEthCatHispanic raceEthCatNH Other/Multiple 
                  0.6857430                   0.8729861 
                   activity                 hi_caffeine 
                  0.9346777                   1.1187019 
         BMI_catunderweight           BMI_catoverweight 
                  0.7641043                   1.0834689 
               BMI_catobese                heavy_drink2 
                  1.2624850                   1.0245741 
              depress_cat.L               depress_cat.Q 
                  2.0557369                   0.6476537 
              depress_cat.C               depress_cat^4 
                  1.2433790                   0.9440252 </code></pre>
</div>
<p>The unweighted regression results are qualitatively the same as the weighted regression results. I I also am not able to easily perform regression diagnostics with the survey weighted glm, so I will proceed with the unweighted model 3 for simplicity. This is reasonable, since we are trying to observe risk factors to daytime sleepiness in our sample and are not trying to predict prevalence of these risk factors in the United States population.</p>
<h4 id="part-d-selection-of-best-model-using-aic-and-a-priori">Part d: selection of best model using AIC and a priori</h4>
<p>Next, we will run our best subset AI model to select the most parsimonious predictors</p>
<p>We will also attempt best-subset model selection to ensure that we are not missing any potentially relevant variables in our a-priori models.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>analytic_data</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/na.fail.html'>na.omit</a></span><span class='op'>(</span><span class='va'>unweighted_data</span><span class='op'>)</span>

<span class='co'># can do this all at once with step function when done by AIC</span>
<span class='va'>model_0</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/glm.html'>glm</a></span><span class='op'>(</span><span class='va'>day_sleep</span> <span class='op'>~</span> <span class='fl'>1</span>, data <span class='op'>=</span> <span class='va'>analytic_data</span>, family <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/family.html'>poisson</a></span><span class='op'>(</span>link <span class='op'>=</span> <span class='st'>"log"</span><span class='op'>)</span><span class='op'>)</span>    <span class='co'># start with null model</span>
<span class='va'>mod_final</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/step.html'>step</a></span><span class='op'>(</span><span class='va'>model_0</span>, scope <span class='op'>=</span> <span class='op'>~</span> <span class='va'>.</span> <span class='op'>+</span> <span class='va'>RIAGENDR</span> <span class='op'>+</span> <span class='va'>ageCat_18</span> <span class='op'>+</span> <span class='va'>INDFMPIR</span><span class='op'>-</span><span class='fl'>1</span> <span class='op'>+</span> <span class='va'>SMQ681</span> 
                  <span class='op'>+</span> <span class='va'>activity</span> <span class='op'>+</span> <span class='va'>hi_caffeine</span> <span class='op'>+</span> <span class='va'>BMI_cat</span> <span class='op'>+</span> <span class='va'>raceEthCat</span> <span class='op'>+</span>
                    <span class='va'>heavy_drink2</span> <span class='op'>+</span> <span class='va'>depress_cat</span>, family<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/stats/family.html'>poisson</a></span><span class='op'>(</span>link<span class='op'>=</span><span class='st'>"log"</span><span class='op'>)</span>, 
                  data <span class='op'>=</span> <span class='va'>analytic_data</span>, direction <span class='op'>=</span> <span class='st'>"forward"</span>, na.rm <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>   <span class='co'># add terms one at a time using AIC</span>
</code></pre>
</div>
<pre><code>Start:  AIC=2514.33
day_sleep ~ 1

               Df Deviance    AIC
+ depress_cat   4   1198.9 2450.9
+ raceEthCat    4   1256.2 2508.2
+ INDFMPIR      1   1262.8 2508.8
+ BMI_cat       3   1262.0 2512.0
+ hi_caffeine   1   1267.4 2513.4
&lt;none&gt;              1270.3 2514.3
+ RIAGENDR      1   1269.2 2515.2
+ ageCat_18     2   1267.8 2515.8
+ heavy_drink2  1   1269.8 2515.8
+ SMQ681        1   1269.9 2515.9
+ activity      1   1270.2 2516.2

Step:  AIC=2450.89
day_sleep ~ depress_cat

               Df Deviance    AIC
+ raceEthCat    4   1187.4 2447.4
&lt;none&gt;              1198.9 2450.9
+ INDFMPIR      1   1197.1 2451.1
+ hi_caffeine   1   1197.8 2451.8
+ ageCat_18     2   1195.8 2451.8
+ RIAGENDR      1   1198.4 2452.4
+ BMI_cat       3   1194.5 2452.5
+ activity      1   1198.5 2452.5
+ SMQ681        1   1198.7 2452.7
+ heavy_drink2  1   1198.9 2452.9

Step:  AIC=2447.4
day_sleep ~ depress_cat + raceEthCat

               Df Deviance    AIC
+ ageCat_18     2   1183.2 2447.2
+ INDFMPIR      1   1185.3 2447.3
&lt;none&gt;              1187.4 2447.4
+ SMQ681        1   1186.8 2448.8
+ RIAGENDR      1   1187.1 2449.1
+ activity      1   1187.1 2449.1
+ hi_caffeine   1   1187.1 2449.1
+ heavy_drink2  1   1187.4 2449.4
+ BMI_cat       3   1183.4 2449.4

Step:  AIC=2447.2
day_sleep ~ depress_cat + raceEthCat + ageCat_18

               Df Deviance    AIC
&lt;none&gt;              1183.2 2447.2
+ INDFMPIR      1   1181.7 2447.7
+ SMQ681        1   1182.0 2448.0
+ BMI_cat       3   1178.4 2448.4
+ hi_caffeine   1   1182.7 2448.7
+ heavy_drink2  1   1183.0 2448.9
+ RIAGENDR      1   1183.0 2449.0
+ activity      1   1183.2 2449.2</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/pkg/lmtest/man/coeftest.html'>coeftest</a></span><span class='op'>(</span><span class='va'>mod_final</span>, vcov. <span class='op'>=</span> <span class='va'>sandwich</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>
z test of coefficients:

                             Estimate Std. Error z value  Pr(&gt;|z|)
(Intercept)                 -0.482284   0.063935 -7.5433 4.581e-14
depress_cat.L                0.576384   0.129384  4.4548 8.396e-06
depress_cat.Q               -0.392328   0.115405 -3.3996 0.0006749
depress_cat.C                0.042799   0.092111  0.4646 0.6421856
depress_cat^4               -0.041453   0.074945 -0.5531 0.5801898
raceEthCatNH Black          -0.232862   0.083771 -2.7798 0.0054400
raceEthCatNH Asian          -0.448282   0.149246 -3.0036 0.0026677
raceEthCatHispanic          -0.277537   0.084456 -3.2862 0.0010156
raceEthCatNH Other/Multiple -0.150954   0.115582 -1.3060 0.1915424
ageCat_1840-59              -0.115274   0.071351 -1.6156 0.1061843
ageCat_1860+                -0.204843   0.079876 -2.5645 0.0103322
                               
(Intercept)                 ***
depress_cat.L               ***
depress_cat.Q               ***
depress_cat.C                  
depress_cat^4                  
raceEthCatNH Black          ** 
raceEthCatNH Asian          ** 
raceEthCatHispanic          ** 
raceEthCatNH Other/Multiple    
ageCat_1840-59                 
ageCat_1860+                *  
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>mod_final</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>
Call:
glm(formula = day_sleep ~ depress_cat + raceEthCat + ageCat_18, 
    family = poisson(link = &quot;log&quot;), data = analytic_data)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-1.2781  -0.7799  -0.6942   0.6298   1.3459  

Coefficients:
                            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                 -0.48228    0.09852  -4.895 9.81e-07 ***
depress_cat.L                0.57638    0.20265   2.844  0.00445 ** 
depress_cat.Q               -0.39233    0.18092  -2.169  0.03012 *  
depress_cat.C                0.04280    0.14962   0.286  0.77484    
depress_cat^4               -0.04145    0.12182  -0.340  0.73365    
raceEthCatNH Black          -0.23286    0.10737  -2.169  0.03009 *  
raceEthCatNH Asian          -0.44828    0.17580  -2.550  0.01077 *  
raceEthCatHispanic          -0.27754    0.10892  -2.548  0.01083 *  
raceEthCatNH Other/Multiple -0.15095    0.16024  -0.942  0.34617    
ageCat_1840-59              -0.11527    0.09378  -1.229  0.21900    
ageCat_1860+                -0.20484    0.10283  -1.992  0.04637 *  
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 1270.3  on 1726  degrees of freedom
Residual deviance: 1183.2  on 1716  degrees of freedom
AIC: 2447.2

Number of Fisher Scoring iterations: 5</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>exp</a></span><span class='op'>(</span><span class='va'>mod_final</span><span class='op'>$</span><span class='va'>coefficients</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>                (Intercept)               depress_cat.L 
                  0.6173715                   1.7795910 
              depress_cat.Q               depress_cat.C 
                  0.6754827                   1.0437281 
              depress_cat^4          raceEthCatNH Black 
                  0.9593946                   0.7922631 
         raceEthCatNH Asian          raceEthCatHispanic 
                  0.6387248                   0.7576473 
raceEthCatNH Other/Multiple              ageCat_1840-59 
                  0.8598874                   0.8911220 
               ageCat_1860+ 
                  0.8147754 </code></pre>
</div>
<p>We see the final model has depression category, race, and age as the most parsimonious predictors explaining daytime sleepiness in our sample</p>
<p>Now, lets look at our a-priori models</p>
<p><strong>Model using behavioral risk factors only (a priori)</strong></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>mod_behav</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/glm.html'>glm</a></span><span class='op'>(</span><span class='va'>day_sleep</span><span class='op'>~</span><span class='va'>SMQ681</span> <span class='op'>+</span> <span class='va'>activity</span> <span class='op'>+</span> <span class='va'>hi_caffeine</span> <span class='op'>+</span> <span class='va'>heavy_drink2</span>, 
                     family<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/stats/family.html'>poisson</a></span><span class='op'>(</span>link<span class='op'>=</span><span class='st'>"log"</span><span class='op'>)</span>, data <span class='op'>=</span> <span class='va'>unweighted_data</span><span class='op'>)</span>

<span class='co'>#robust variance</span>
<span class='fu'><a href='https://rdrr.io/pkg/lmtest/man/coeftest.html'>coeftest</a></span><span class='op'>(</span><span class='va'>mod_behav</span>, vcov <span class='op'>=</span> <span class='va'>sandwich</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>
z test of coefficients:

              Estimate Std. Error z value  Pr(&gt;|z|)    
(Intercept)  -1.161584   0.122919 -9.4500 &lt; 2.2e-16 ***
SMQ681       -0.085705   0.061396 -1.3959 0.1627367    
activity     -0.109537   0.054449 -2.0117 0.0442484 *  
hi_caffeine   0.320028   0.094668  3.3805 0.0007235 ***
heavy_drink2  0.149307   0.054189  2.7553 0.0058635 ** 
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#coefficents</span>
<span class='fu'><a href='https://rdrr.io/r/base/Log.html'>exp</a></span><span class='op'>(</span><span class='va'>mod_behav</span><span class='op'>$</span><span class='va'>coefficients</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code> (Intercept)       SMQ681     activity  hi_caffeine heavy_drink2 
   0.3129899    0.9178654    0.8962488    1.3771665    1.1610298 </code></pre>
</div>
<p><strong>Model combining a priori and best-subset selection</strong></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>mod_final_behav</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/glm.html'>glm</a></span><span class='op'>(</span><span class='va'>day_sleep</span><span class='op'>~</span><span class='va'>depress_cat</span> <span class='op'>+</span> <span class='va'>ageCat_18</span> <span class='op'>+</span> <span class='va'>SMQ681</span> <span class='op'>+</span> <span class='va'>activity</span> <span class='op'>+</span> <span class='va'>raceEthCat</span> <span class='op'>+</span>
                          <span class='va'>hi_caffeine</span> <span class='op'>+</span> <span class='va'>heavy_drink2</span>, family<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/stats/family.html'>poisson</a></span><span class='op'>(</span>link<span class='op'>=</span><span class='st'>"log"</span><span class='op'>)</span>, data <span class='op'>=</span> <span class='va'>unweighted_data</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>mod_final_behav</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>
Call:
glm(formula = day_sleep ~ depress_cat + ageCat_18 + SMQ681 + 
    activity + raceEthCat + hi_caffeine + heavy_drink2, family = poisson(link = &quot;log&quot;), 
    data = unweighted_data)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-1.3059  -0.6649  -0.5739   0.3749   1.7463  

Coefficients:
                            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                 -0.60500    0.15997  -3.782 0.000156 ***
depress_cat.L                0.83543    0.13796   6.056 1.40e-09 ***
depress_cat.Q               -0.40609    0.12492  -3.251 0.001151 ** 
depress_cat.C                0.29800    0.11183   2.665 0.007706 ** 
depress_cat^4               -0.03835    0.09589  -0.400 0.689213    
ageCat_1840-59              -0.18828    0.07594  -2.479 0.013167 *  
ageCat_1860+                -0.21188    0.07645  -2.772 0.005579 ** 
SMQ681                       0.10213    0.07482   1.365 0.172250    
activity                    -0.09067    0.06641  -1.365 0.172142    
raceEthCatNH Black          -0.34672    0.08010  -4.328 1.50e-05 ***
raceEthCatNH Asian          -0.78766    0.13358  -5.897 3.71e-09 ***
raceEthCatHispanic          -0.36168    0.08289  -4.363 1.28e-05 ***
raceEthCatNH Other/Multiple -0.13766    0.12599  -1.093 0.274537    
hi_caffeine                  0.11937    0.12200   0.978 0.327873    
heavy_drink2                 0.03806    0.06676   0.570 0.568567    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 2935.0  on 4164  degrees of freedom
Residual deviance: 2599.7  on 4150  degrees of freedom
  (1691 observations deleted due to missingness)
AIC: 4847.7

Number of Fisher Scoring iterations: 6</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/pkg/lmtest/man/coeftest.html'>coeftest</a></span><span class='op'>(</span><span class='va'>mod_final_behav</span>, vcov <span class='op'>=</span> <span class='va'>sandwich</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>
z test of coefficients:

                             Estimate Std. Error z value  Pr(&gt;|z|)
(Intercept)                 -0.604997   0.121445 -4.9817 6.304e-07
depress_cat.L                0.835431   0.081969 10.1920 &lt; 2.2e-16
depress_cat.Q               -0.406091   0.075380 -5.3872 7.156e-08
depress_cat.C                0.297997   0.071108  4.1908 2.780e-05
depress_cat^4               -0.038350   0.063182 -0.6070 0.5438610
ageCat_1840-59              -0.188282   0.060499 -3.1122 0.0018573
ageCat_1860+                -0.211885   0.061448 -3.4482 0.0005643
SMQ681                       0.102129   0.059907  1.7048 0.0882301
activity                    -0.090669   0.052991 -1.7110 0.0870746
raceEthCatNH Black          -0.346716   0.065189 -5.3187 1.045e-07
raceEthCatNH Asian          -0.787660   0.119233 -6.6061 3.946e-11
raceEthCatHispanic          -0.361676   0.067043 -5.3947 6.863e-08
raceEthCatNH Other/Multiple -0.137664   0.096014 -1.4338 0.1516323
hi_caffeine                  0.119369   0.092434  1.2914 0.1965662
heavy_drink2                 0.038062   0.053537  0.7110 0.4771127
                               
(Intercept)                 ***
depress_cat.L               ***
depress_cat.Q               ***
depress_cat.C               ***
depress_cat^4                  
ageCat_1840-59              ** 
ageCat_1860+                ***
SMQ681                      .  
activity                    .  
raceEthCatNH Black          ***
raceEthCatNH Asian          ***
raceEthCatHispanic          ***
raceEthCatNH Other/Multiple    
hi_caffeine                    
heavy_drink2                   
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
<h4 id="part-e-aic-and-goodness-of-fit-pearsons-chi-sq">Part e: AIC and Goodness of Fit (pearsons chi-sq)</h4>
<p>Calculate deviance residuals since the models are poisson, not linear.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/with.html'>with</a></span><span class='op'>(</span><span class='va'>mod_final_behav</span>, <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span>res.deviance <span class='op'>=</span> <span class='va'>deviance</span>, df <span class='op'>=</span> <span class='va'>df.residual</span>, p <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/Chisquare.html'>pchisq</a></span><span class='op'>(</span><span class='va'>deviance</span>, <span class='va'>df.residual</span>, lower.tail<span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>     res.deviance   df p
[1,]     2599.738 4150 1</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/with.html'>with</a></span><span class='op'>(</span><span class='va'>mod_final</span>, <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span>res.deviance <span class='op'>=</span> <span class='va'>deviance</span>, df <span class='op'>=</span> <span class='va'>df.residual</span>,
                            p <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/Chisquare.html'>pchisq</a></span><span class='op'>(</span><span class='va'>deviance</span>, <span class='va'>df.residual</span>, lower.tail<span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>     res.deviance   df p
[1,]     1183.199 1716 1</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/with.html'>with</a></span><span class='op'>(</span><span class='va'>MLR_3</span>, <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span>res.deviance <span class='op'>=</span> <span class='va'>deviance</span>, df <span class='op'>=</span> <span class='va'>df.residual</span>,
                            p <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/Chisquare.html'>pchisq</a></span><span class='op'>(</span><span class='va'>deviance</span>, <span class='va'>df.residual</span>, lower.tail<span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>     res.deviance   df p
[1,]     2320.764 3659 1</code></pre>
</div>
<p>Calculate the fit of the models using Aikakes Information Criterion, a measure of parsimony and model goodness of fit:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/stats/AIC.html'>AIC</a></span><span class='op'>(</span><span class='va'>mod_final</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 2447.199</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/stats/AIC.html'>AIC</a></span><span class='op'>(</span><span class='va'>MLR_3</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 4384.764</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/stats/AIC.html'>AIC</a></span><span class='op'>(</span><span class='va'>mod_final_behav</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 4847.738</code></pre>
</div>
<p>There was some lost data in the best subset regression since there was some missingness. Therefore, the AIC is not as great as it seems when run on the full dataset. Lets try the best subset model on the full data:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>Mod_bestsub</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/glm.html'>glm</a></span><span class='op'>(</span><span class='va'>day_sleep</span> <span class='op'>~</span> <span class='va'>ageCat_18</span> <span class='op'>+</span> <span class='va'>depress_cat</span> <span class='op'>+</span> <span class='va'>raceEthCat</span>, data <span class='op'>=</span> <span class='va'>unweighted_data</span>, family <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/family.html'>poisson</a></span><span class='op'>(</span>link <span class='op'>=</span> <span class='st'>"log"</span><span class='op'>)</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/stats/AIC.html'>AIC</a></span><span class='op'>(</span><span class='va'>Mod_bestsub</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 5802.821</code></pre>
</div>
<p>We see in the analyses above that the model with the best fit is the model including all covariates. However, since the epidemiologic question is seeking to understand which the behavioral risk factors may be most impactful on daytime sleepiness, we will proceed with the model including all behavioral covariates (ever smoking, moderate/high physical activity, race, high caffeine consumption, and heavy drinking) + the covariates identified in the best-subset model (age and depression)</p>
<h4 id="part-f-model-diagnostics">Part f: Model diagnostics</h4>
<p>Model diagnostics that we will perform include residual versus fitted plots, Q-Q plots, leverage boxplots, residual boxplots and influential point boxplots.</p>
<h6 id="part-f-1-plot-studentized-residual--vs--predicted-values">Part f-1: Plot studentized residual -vs- predicted values</h6>
<p>Calculate predicted values and residuals in <strong>weighted data - model w/ all covariates</strong></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>fit_dat</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/as.data.frame.html'>as.data.frame</a></span><span class='op'>(</span><span class='va'>MLR_1</span><span class='op'>$</span><span class='va'>fitted.values</span><span class='op'>)</span>
<span class='va'>pearson_res_w</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/residuals.html'>residuals</a></span><span class='op'>(</span><span class='va'>MLR_1</span>, type <span class='op'>=</span> <span class='st'>"pearson"</span><span class='op'>)</span>
<span class='va'>fit_dat</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='va'>fit_dat</span>, <span class='va'>pearson_res_w</span><span class='op'>)</span>



<span class='va'>fit_dat</span> <span class='op'><a href='https://ggobi.github.io/ggally/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>MLR_1</span><span class='op'>$</span><span class='va'>fitted.values</span>, y <span class='op'>=</span> <span class='va'>pearson_res_w</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_abline.html'>geom_hline</a></span><span class='op'>(</span>yintercept <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>2</span>, <span class='fl'>0</span>, <span class='fl'>2</span><span class='op'>)</span>, col<span class='op'>=</span><span class='st'>"red"</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_smooth.html'>geom_smooth</a></span><span class='op'>(</span>method <span class='op'>=</span> <span class='va'>lm</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='st'>"Fitted values"</span>, y <span class='op'>=</span> <span class='st'>"Pearson Residuals"</span>, title <span class='op'>=</span> <span class='st'>"Residuals vs. Fitted values"</span><span class='op'>)</span>
</code></pre>
</div>
<img src="projects_files/figure-html5/unnamed-chunk-45-1.png" width="624" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggsave.html'>ggsave</a></span><span class='op'>(</span><span class='st'>"pearson_resids_weighted.png"</span>, width <span class='op'>=</span> <span class='fl'>6</span>, height <span class='op'>=</span> <span class='fl'>4</span>, units <span class='op'>=</span> <span class='st'>"in"</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>Calculate predicted values and residuals in <strong>unweighted data - model w/ all covariates</strong></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>fit_dat2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/as.data.frame.html'>as.data.frame</a></span><span class='op'>(</span><span class='va'>MLR_3</span><span class='op'>$</span><span class='va'>fitted.values</span><span class='op'>)</span>
<span class='va'>pearson_res</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/residuals.html'>residuals</a></span><span class='op'>(</span><span class='va'>MLR_3</span>, type <span class='op'>=</span> <span class='st'>"pearson"</span><span class='op'>)</span>
<span class='va'>fit_dat2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='va'>fit_dat2</span>, <span class='va'>pearson_res</span><span class='op'>)</span>

<span class='va'>fit_dat2</span> <span class='op'><a href='https://ggobi.github.io/ggally/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>MLR_3</span><span class='op'>$</span><span class='va'>fitted.values</span>, y <span class='op'>=</span> <span class='va'>pearson_res</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_abline.html'>geom_hline</a></span><span class='op'>(</span>yintercept <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>2</span>, <span class='fl'>0</span>, <span class='fl'>2</span><span class='op'>)</span>, col<span class='op'>=</span><span class='st'>"red"</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_smooth.html'>geom_smooth</a></span><span class='op'>(</span>method <span class='op'>=</span> <span class='va'>lm</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='st'>"Fitted values"</span>, y <span class='op'>=</span> <span class='st'>"Pearson Residuals"</span>, title <span class='op'>=</span> <span class='st'>"Residuals vs. Fitted values"</span><span class='op'>)</span>
</code></pre>
</div>
<img src="projects_files/figure-html5/unnamed-chunk-46-1.png" width="624" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggsave.html'>ggsave</a></span><span class='op'>(</span><span class='st'>"pearson_resids_unweighted.png"</span>, width <span class='op'>=</span> <span class='fl'>6</span>, height <span class='op'>=</span> <span class='fl'>4</span>, units <span class='op'>=</span> <span class='st'>"in"</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>The loess line is flat, which means there is no trend in the residuals. Equal variances/ linear assumption is met.</p>
<p>Calculate predicted values and residuals in <strong>unweighted final model</strong></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>fit_dat_fin</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/as.data.frame.html'>as.data.frame</a></span><span class='op'>(</span><span class='va'>mod_final_behav</span><span class='op'>$</span><span class='va'>fitted.values</span><span class='op'>)</span>
<span class='va'>pearson_res_fin</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/residuals.html'>residuals</a></span><span class='op'>(</span><span class='va'>mod_final_behav</span>, type <span class='op'>=</span> <span class='st'>"pearson"</span><span class='op'>)</span>
<span class='va'>fit_dat_fin</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='va'>fit_dat_fin</span>, <span class='va'>pearson_res_fin</span><span class='op'>)</span>

<span class='va'>fit_dat_fin</span> <span class='op'><a href='https://ggobi.github.io/ggally/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>mod_final_behav</span><span class='op'>$</span><span class='va'>fitted.values</span>, y <span class='op'>=</span> <span class='va'>pearson_res_fin</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_abline.html'>geom_hline</a></span><span class='op'>(</span>yintercept <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>2</span>, <span class='fl'>0</span>, <span class='fl'>2</span><span class='op'>)</span>, col<span class='op'>=</span><span class='st'>"red"</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_smooth.html'>geom_smooth</a></span><span class='op'>(</span>method <span class='op'>=</span> <span class='va'>lm</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='st'>"Fitted values"</span>, y <span class='op'>=</span> <span class='st'>"Pearson Residuals"</span>, title <span class='op'>=</span> <span class='st'>"Residuals vs. Fitted values"</span><span class='op'>)</span>
</code></pre>
</div>
<img src="projects_files/figure-html5/unnamed-chunk-47-1.png" width="624" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggsave.html'>ggsave</a></span><span class='op'>(</span><span class='st'>"pearson_resids_final_behave_model.png"</span>, width <span class='op'>=</span> <span class='fl'>6</span>, height <span class='op'>=</span> <span class='fl'>4</span>, units <span class='op'>=</span> <span class='st'>"in"</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>Now, lets create a Q-Q plot of deviance residuals for the final model and the model including all covariates</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>fit_dat_fin_apriori</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/as.data.frame.html'>as.data.frame</a></span><span class='op'>(</span><span class='va'>mod_final_behav</span><span class='op'>$</span><span class='va'>fitted.values</span><span class='op'>)</span>
<span class='va'>deviance_res_apriori</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/residuals.html'>residuals</a></span><span class='op'>(</span><span class='va'>mod_final_behav</span>, type <span class='op'>=</span> <span class='st'>"deviance"</span><span class='op'>)</span>
<span class='va'>fit_dat_fin_apriori</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='va'>fit_dat_fin_apriori</span>, <span class='va'>deviance_res_apriori</span><span class='op'>)</span>

<span class='va'>fit_dat_fin_apriori</span> <span class='op'><a href='https://ggobi.github.io/ggally/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>sample <span class='op'>=</span> <span class='va'>deviance_res_apriori</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_qq.html'>geom_qq</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_qq.html'>geom_qq_line</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>title <span class='op'>=</span> <span class='st'>"Q-Q plot of deviance residuals"</span><span class='op'>)</span>
</code></pre>
</div>
<img src="projects_files/figure-html5/unnamed-chunk-48-1.png" width="624" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggsave.html'>ggsave</a></span><span class='op'>(</span><span class='st'>"Q-Q_final_behav_mod.png"</span>, width <span class='op'>=</span> <span class='fl'>6</span>, height <span class='op'>=</span> <span class='fl'>4</span>, units <span class='op'>=</span> <span class='st'>"in"</span><span class='op'>)</span>


<span class='va'>fit_dat_fin_all</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/as.data.frame.html'>as.data.frame</a></span><span class='op'>(</span><span class='va'>MLR_3</span><span class='op'>$</span><span class='va'>fitted.values</span><span class='op'>)</span>
<span class='va'>deviance_res_fin</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/residuals.html'>residuals</a></span><span class='op'>(</span><span class='va'>MLR_3</span>, type <span class='op'>=</span> <span class='st'>"deviance"</span><span class='op'>)</span>
<span class='va'>fit_dat_fin_all</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='va'>fit_dat_fin_all</span>, <span class='va'>deviance_res_fin</span><span class='op'>)</span>

<span class='va'>fit_dat_fin_all</span> <span class='op'><a href='https://ggobi.github.io/ggally/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>sample <span class='op'>=</span> <span class='va'>deviance_res_fin</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_qq.html'>geom_qq</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_qq.html'>geom_qq_line</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>title <span class='op'>=</span> <span class='st'>"Q-Q plot of deviance residuals"</span><span class='op'>)</span>
</code></pre>
</div>
<img src="projects_files/figure-html5/unnamed-chunk-48-2.png" width="624" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggsave.html'>ggsave</a></span><span class='op'>(</span><span class='st'>"Q-Q_all_variables.png"</span>, width <span class='op'>=</span> <span class='fl'>6</span>, height <span class='op'>=</span> <span class='fl'>4</span>, units <span class='op'>=</span> <span class='st'>"in"</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>Under the correct distribution of the response, we expect the points to align with the diagonal line. It is usual to have departures from the diagonal in the extremes other than in the center, even under normality. Assumption is met.</p>
<h5 id="part-f-2-check-outliers">Part f-2 : check outliers</h5>
<p>Identify the outliers in the <strong>final a-priori models</strong>:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>fit_dat_fin_apriori</span> <span class='op'><a href='https://ggobi.github.io/ggally/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_boxplot.html'>geom_boxplot</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>y <span class='op'>=</span> <span class='va'>pearson_res_fin</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>y<span class='op'>=</span><span class='st'>"Pearson residuals"</span>, title<span class='op'>=</span><span class='st'>"Boxplot of pearson residuals"</span><span class='op'>)</span>
</code></pre>
</div>
<img src="projects_files/figure-html5/unnamed-chunk-49-1.png" width="624" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Looking at the plot we can filter to see which observation is the outlier</span>
<span class='va'>fit_dat_fin_apriori</span> <span class='op'><a href='https://ggobi.github.io/ggally/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>pearson_res_fin</span> <span class='op'>&gt;</span> <span class='fl'>2.5</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>     mod_final_behav$fitted.values deviance_res_apriori
5                       0.09910205             1.679707
10                      0.09679036             1.692335
93                      0.08948051             1.733906
270                     0.09679036             1.692335
623                     0.10850747             1.630610
912                     0.08948051             1.733906
1218                    0.11963339             1.576678
1259                    0.09679036             1.692335
1371                    0.08739325             1.746271
1438                    0.08948051             1.733906
1456                    0.09910205             1.679707
1575                    0.10597638             1.643481
1764                    0.08739325             1.746271
2296                    0.11220921             1.612203
2674                    0.11963339             1.576678
2732                    0.11963339             1.576678
2798                    0.10597638             1.643481
3056                    0.09910205             1.679707
3257                    0.11271714             1.609715
3467                    0.09679036             1.692335
3534                    0.09910205             1.679707
3599                    0.10597638             1.643481
3712                    0.09910205             1.679707
3771                    0.10850747             1.630610
3931                    0.11963339             1.576678
3942                    0.10597638             1.643481
4147                    0.11963339             1.576678
4187                    0.09910205             1.679707
4257                    0.10294683             1.659210
4346                    0.10054545             1.671940
4475                    0.11963339             1.576678
4570                    0.11271714             1.609715
4606                    0.10850747             1.630610
4622                    0.09910205             1.679707
4887                    0.09910205             1.679707
4979                    0.11827016             1.583069
5215                    0.09910205             1.679707
5454                    0.11963339             1.576678
5496                    0.11963339             1.576678
5699                    0.08948051             1.733906</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggsave.html'>ggsave</a></span><span class='op'>(</span><span class='st'>"outlier_residuals_apriori.png"</span>, width <span class='op'>=</span> <span class='fl'>6</span>, height <span class='op'>=</span> <span class='fl'>4</span>, units <span class='op'>=</span> <span class='st'>"in"</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<h4 id="part-g-check-leverage">Part g : check leverage</h4>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>fit_dat_fin_apriori</span> <span class='op'>&lt;-</span> <span class='va'>fit_dat_fin_apriori</span> <span class='op'><a href='https://ggobi.github.io/ggally/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>lev <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/influence.measures.html'>hatvalues</a></span><span class='op'>(</span><span class='va'>mod_final_behav</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'># Boxplot of leverage values</span>
<span class='va'>fit_dat_fin_apriori</span> <span class='op'><a href='https://ggobi.github.io/ggally/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_boxplot.html'>geom_boxplot</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>y <span class='op'>=</span> <span class='va'>lev</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>y<span class='op'>=</span><span class='st'>"Leverage values"</span>, title<span class='op'>=</span><span class='st'>"Boxplot of leverages"</span><span class='op'>)</span>
</code></pre>
</div>
<img src="projects_files/figure-html5/unnamed-chunk-50-1.png" width="624" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>fit_dat_fin_apriori</span><span class='op'>$</span><span class='va'>lev</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
0.001112 0.001548 0.001979 0.003601 0.004278 0.048211 </code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>lev_outliers</span> <span class='op'>&lt;-</span> <span class='fl'>0.004278</span> <span class='op'>+</span> <span class='fl'>1.5</span><span class='op'>*</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/IQR.html'>IQR</a></span><span class='op'>(</span><span class='va'>fit_dat_fin_apriori</span><span class='op'>$</span><span class='va'>lev</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>list_lev_outliers</span> <span class='op'>&lt;-</span> <span class='va'>fit_dat_fin_apriori</span> <span class='op'><a href='https://ggobi.github.io/ggally/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>lev</span> <span class='op'>&gt;</span> <span class='va'>lev_outliers</span><span class='op'>)</span>

<span class='fu'><a href='https://pillar.r-lib.org/reference/glimpse.html'>glimpse</a></span><span class='op'>(</span><span class='va'>list_lev_outliers</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Rows: 336
Columns: 3
$ `mod_final_behav$fitted.values` &lt;dbl&gt; 0.5299878, 0.5505493, 0.6055~
$ deviance_res_apriori            &lt;dbl&gt; 0.5742631, 0.5429329, 0.4629~
$ lev                             &lt;dbl&gt; 0.010388046, 0.011440973, 0.~</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>list_lev_outliers</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 336</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggsave.html'>ggsave</a></span><span class='op'>(</span><span class='st'>"Leverages_apriori.png"</span>, width <span class='op'>=</span> <span class='fl'>6</span>, height <span class='op'>=</span> <span class='fl'>4</span>, units <span class='op'>=</span> <span class='st'>"in"</span><span class='op'>)</span>

<span class='co'># There are very many leverage outliers</span>
</code></pre>
</div>
</div>
<h4 id="part-h-check-model-influence">Part h: Check model: influence</h4>
<h6 id="part-h-1-make-boxplot-and-list-outliers-for-influence">Part h-1: Make boxplot and list outliers for influence</h6>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Calculate DFITS influence measure -- effect ith obs on overall fit</span>
<span class='co'># Add them to data set</span>
<span class='va'>fit_dat_fin_apriori</span> <span class='op'>&lt;-</span> <span class='va'>fit_dat_fin_apriori</span> <span class='op'><a href='https://ggobi.github.io/ggally/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>dfits <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/influence.measures.html'>dffits</a></span><span class='op'>(</span><span class='va'>mod_final_behav</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'># Boxplot of dfits values</span>
<span class='va'>fit_dat_fin_apriori</span> <span class='op'><a href='https://ggobi.github.io/ggally/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_boxplot.html'>geom_boxplot</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>y <span class='op'>=</span> <span class='va'>dfits</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>y<span class='op'>=</span><span class='st'>"DFITS values"</span>, title<span class='op'>=</span><span class='st'>"Boxplot of DFIT values"</span><span class='op'>)</span>
</code></pre>
</div>
<img src="projects_files/figure-html5/unnamed-chunk-51-1.png" width="624" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggsave.html'>ggsave</a></span><span class='op'>(</span><span class='st'>"dfits_apriori.png"</span>, width <span class='op'>=</span> <span class='fl'>6</span>, height <span class='op'>=</span> <span class='fl'>4</span>, units <span class='op'>=</span> <span class='st'>"in"</span><span class='op'>)</span>

<span class='co'># Look at outliers</span>
<span class='va'>fit_dat_fin_apriori</span> <span class='op'><a href='https://ggobi.github.io/ggally/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>dfits</span><span class='op'>)</span> <span class='op'><a href='https://ggobi.github.io/ggally/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>dfits</span> <span class='op'>&lt;=</span> <span class='fu'><a href='https://rdrr.io/r/stats/quantile.html'>quantile</a></span><span class='op'>(</span><span class='va'>dfits</span>, <span class='fl'>.25</span><span class='op'>)</span> <span class='op'>-</span> <span class='fl'>1.5</span><span class='op'>*</span><span class='fu'><a href='https://rdrr.io/r/stats/IQR.html'>IQR</a></span><span class='op'>(</span><span class='va'>dfits</span><span class='op'>)</span> <span class='op'>|</span> 
           <span class='va'>dfits</span> <span class='op'>&gt;=</span> <span class='fu'><a href='https://rdrr.io/r/stats/quantile.html'>quantile</a></span><span class='op'>(</span><span class='va'>dfits</span>, <span class='fl'>.75</span><span class='op'>)</span> <span class='op'>+</span> <span class='fl'>1.5</span><span class='op'>*</span><span class='fu'><a href='https://rdrr.io/r/stats/IQR.html'>IQR</a></span><span class='op'>(</span><span class='va'>dfits</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://ggobi.github.io/ggally/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/arrange.html'>arrange</a></span><span class='op'>(</span><span class='va'>dfits</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>          dfits
2876 -0.3788205
5791 -0.3478482
1373 -0.3398676
5401 -0.2887166
135  -0.2857840
5150 -0.2818225
4173 -0.2794537
1345 -0.2588681
1518 -0.2294205
1070 -0.2263443
2716 -0.2206460
1471 -0.2159121
76   -0.2156987
2237 -0.2130116
4467 -0.2098737
4591 -0.2058614
5856 -0.2028300
4980 -0.2020609
4022 -0.2017139
4892 -0.1994388
3993 -0.1937853
1871 -0.1917798
1889 -0.1917798
4684 -0.1917798
5830 -0.1901285
211  -0.1885887
5660 -0.1879037
170  -0.1867638
2887 -0.1837532
2705 -0.1810526
847  -0.1805569
946  -0.1794231
5517 -0.1787003
4038 -0.1754539
4519 -0.1754539
5531 -0.1744222
5042 -0.1730031
3680 -0.1714419
4208 -0.1714419
1253 -0.1695921
4485 -0.1684549
1258 -0.1680605
807  -0.1674679
3622 -0.1667499
2960 -0.1655617
1474 -0.1654669
2618 -0.1645108
890  -0.1627999
5228 -0.1627999
1245 -0.1620576
379  -0.1608886
4302 -0.1607836
4177 -0.1604200
2494 -0.1596280
1784 -0.1577042
5557 -0.1562778</code></pre>
</div>
<h5 id="part-h-2-leverage--vs--residual-squared-l-r-plot">Part h-2: Leverage -vs- residual squared (L-R) plot</h5>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>fit_dat_fin_apriori</span> <span class='op'><a href='https://ggobi.github.io/ggally/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>pearson_res_fin</span><span class='op'>^</span><span class='fl'>2</span>, y <span class='op'>=</span> <span class='va'>lev</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_abline.html'>geom_hline</a></span><span class='op'>(</span>yintercept <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>fit_dat_fin_apriori</span><span class='op'>$</span><span class='va'>lev</span><span class='op'>)</span>, col<span class='op'>=</span><span class='st'>"red"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_abline.html'>geom_vline</a></span><span class='op'>(</span>xintercept <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>fit_dat_fin_apriori</span><span class='op'>$</span><span class='va'>pearson_res_fin</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>)</span>, col<span class='op'>=</span><span class='st'>"red"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>title<span class='op'>=</span><span class='st'>"Leverage-Residual Plot"</span><span class='op'>)</span>
</code></pre>
</div>
<img src="projects_files/figure-html5/unnamed-chunk-52-1.png" width="624" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggsave.html'>ggsave</a></span><span class='op'>(</span><span class='st'>"L-R plot apriori.png"</span>, width <span class='op'>=</span> <span class='fl'>6</span>, height <span class='op'>=</span> <span class='fl'>4</span>, units <span class='op'>=</span> <span class='st'>"in"</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<h4 id="part-i-sensitivity-analysis-re-fit-without-influential-points">Part i: Sensitivity analysis: Re-fit without influential points</h4>
<p>Sensitivity analysis conducted on the 8 most influential points:</p>
<p>Create new data set without influential points:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>unweighted_data_noip</span> <span class='op'>&lt;-</span> <span class='va'>unweighted_data</span> <span class='op'><a href='https://ggobi.github.io/ggally/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>SEQN</span> <span class='op'>!=</span> <span class='fl'>2876</span>, <span class='va'>SEQN</span> <span class='op'>!=</span> <span class='fl'>5791</span>, <span class='va'>SEQN</span> <span class='op'>!=</span> <span class='fl'>1373</span>, <span class='va'>SEQN</span> <span class='op'>!=</span> <span class='fl'>5401</span>, <span class='va'>SEQN</span> <span class='op'>!=</span> <span class='fl'>135</span>,
         <span class='va'>SEQN</span> <span class='op'>!=</span> <span class='fl'>5150</span>, <span class='va'>SEQN</span> <span class='op'>!=</span> <span class='fl'>4173</span>, <span class='va'>SEQN</span> <span class='op'>!=</span> <span class='fl'>1345</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>Fit the model without the influential points:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>model_final_b_no_outliers</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/glm.html'>glm</a></span><span class='op'>(</span><span class='va'>day_sleep</span><span class='op'>~</span><span class='va'>depress_cat</span> <span class='op'>+</span> <span class='va'>ageCat_18</span> <span class='op'>+</span> <span class='va'>SMQ681</span> <span class='op'>+</span> <span class='va'>activity</span> <span class='op'>+</span> 
                                   <span class='va'>raceEthCat</span> <span class='op'>+</span> <span class='va'>hi_caffeine</span> <span class='op'>+</span> <span class='va'>heavy_drink2</span>, family<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/stats/family.html'>poisson</a></span><span class='op'>(</span>link<span class='op'>=</span><span class='st'>"log"</span><span class='op'>)</span>, data <span class='op'>=</span> <span class='va'>unweighted_data</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>model_final_b_no_outliers</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>
Call:
glm(formula = day_sleep ~ depress_cat + ageCat_18 + SMQ681 + 
    activity + raceEthCat + hi_caffeine + heavy_drink2, family = poisson(link = &quot;log&quot;), 
    data = unweighted_data)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-1.3059  -0.6649  -0.5739   0.3749   1.7463  

Coefficients:
                            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                 -0.60500    0.15997  -3.782 0.000156 ***
depress_cat.L                0.83543    0.13796   6.056 1.40e-09 ***
depress_cat.Q               -0.40609    0.12492  -3.251 0.001151 ** 
depress_cat.C                0.29800    0.11183   2.665 0.007706 ** 
depress_cat^4               -0.03835    0.09589  -0.400 0.689213    
ageCat_1840-59              -0.18828    0.07594  -2.479 0.013167 *  
ageCat_1860+                -0.21188    0.07645  -2.772 0.005579 ** 
SMQ681                       0.10213    0.07482   1.365 0.172250    
activity                    -0.09067    0.06641  -1.365 0.172142    
raceEthCatNH Black          -0.34672    0.08010  -4.328 1.50e-05 ***
raceEthCatNH Asian          -0.78766    0.13358  -5.897 3.71e-09 ***
raceEthCatHispanic          -0.36168    0.08289  -4.363 1.28e-05 ***
raceEthCatNH Other/Multiple -0.13766    0.12599  -1.093 0.274537    
hi_caffeine                  0.11937    0.12200   0.978 0.327873    
heavy_drink2                 0.03806    0.06676   0.570 0.568567    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 2935.0  on 4164  degrees of freedom
Residual deviance: 2599.7  on 4150  degrees of freedom
  (1691 observations deleted due to missingness)
AIC: 4847.7

Number of Fisher Scoring iterations: 6</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/pkg/lmtest/man/coeftest.html'>coeftest</a></span><span class='op'>(</span><span class='va'>mod_final_behav</span>, vcov <span class='op'>=</span> <span class='va'>sandwich</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>
z test of coefficients:

                             Estimate Std. Error z value  Pr(&gt;|z|)
(Intercept)                 -0.604997   0.121445 -4.9817 6.304e-07
depress_cat.L                0.835431   0.081969 10.1920 &lt; 2.2e-16
depress_cat.Q               -0.406091   0.075380 -5.3872 7.156e-08
depress_cat.C                0.297997   0.071108  4.1908 2.780e-05
depress_cat^4               -0.038350   0.063182 -0.6070 0.5438610
ageCat_1840-59              -0.188282   0.060499 -3.1122 0.0018573
ageCat_1860+                -0.211885   0.061448 -3.4482 0.0005643
SMQ681                       0.102129   0.059907  1.7048 0.0882301
activity                    -0.090669   0.052991 -1.7110 0.0870746
raceEthCatNH Black          -0.346716   0.065189 -5.3187 1.045e-07
raceEthCatNH Asian          -0.787660   0.119233 -6.6061 3.946e-11
raceEthCatHispanic          -0.361676   0.067043 -5.3947 6.863e-08
raceEthCatNH Other/Multiple -0.137664   0.096014 -1.4338 0.1516323
hi_caffeine                  0.119369   0.092434  1.2914 0.1965662
heavy_drink2                 0.038062   0.053537  0.7110 0.4771127
                               
(Intercept)                 ***
depress_cat.L               ***
depress_cat.Q               ***
depress_cat.C               ***
depress_cat^4                  
ageCat_1840-59              ** 
ageCat_1860+                ***
SMQ681                      .  
activity                    .  
raceEthCatNH Black          ***
raceEthCatNH Asian          ***
raceEthCatHispanic          ***
raceEthCatNH Other/Multiple    
hi_caffeine                    
heavy_drink2                   
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>exp</a></span><span class='op'>(</span><span class='va'>model_final_b_no_outliers</span><span class='op'>$</span><span class='va'>coefficients</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>                (Intercept)               depress_cat.L 
                  0.5460763                   2.3058075 
              depress_cat.Q               depress_cat.C 
                  0.6662495                   1.3471573 
              depress_cat^4              ageCat_1840-59 
                  0.9623758                   0.8283812 
               ageCat_1860+                      SMQ681 
                  0.8090580                   1.1075267 
                   activity          raceEthCatNH Black 
                  0.9133201                   0.7070058 
         raceEthCatNH Asian          raceEthCatHispanic 
                  0.4549079                   0.6965079 
raceEthCatNH Other/Multiple                 hi_caffeine 
                  0.8713918                   1.1267856 
               heavy_drink2 
                  1.0387961 </code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>exp</a></span><span class='op'>(</span><span class='va'>mod_final_behav</span><span class='op'>$</span><span class='va'>coefficients</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>                (Intercept)               depress_cat.L 
                  0.5460763                   2.3058075 
              depress_cat.Q               depress_cat.C 
                  0.6662495                   1.3471573 
              depress_cat^4              ageCat_1840-59 
                  0.9623758                   0.8283812 
               ageCat_1860+                      SMQ681 
                  0.8090580                   1.1075267 
                   activity          raceEthCatNH Black 
                  0.9133201                   0.7070058 
         raceEthCatNH Asian          raceEthCatHispanic 
                  0.4549079                   0.6965079 
raceEthCatNH Other/Multiple                 hi_caffeine 
                  0.8713918                   1.1267856 
               heavy_drink2 
                  1.0387961 </code></pre>
</div>
<h4 id="part-j-check-variance-inflation">Part j: Check variance inflation</h4>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/pkg/car/man/vif.html'>vif</a></span><span class='op'>(</span><span class='va'>MLR_3</span><span class='op'>)</span> <span class='co'>#check VIF of unweighted model with all risk factors</span>
</code></pre>
</div>
<pre><code>                 GVIF Df GVIF^(1/(2*Df))
RIAGENDR     1.059197  1        1.029173
ageCat_18    1.223982  2        1.051826
INDFMPIR     1.149586  1        1.072187
SMQ681       1.208305  1        1.099229
raceEthCat   1.225887  4        1.025785
activity     1.086719  1        1.042458
hi_caffeine  1.099705  1        1.048668
BMI_cat      1.114698  3        1.018262
heavy_drink2 1.160023  1        1.077044
depress_cat  1.126430  4        1.014993</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/pkg/car/man/vif.html'>vif</a></span><span class='op'>(</span><span class='va'>mod_final</span><span class='op'>)</span> <span class='co'># check VIF of best subset model</span>
</code></pre>
</div>
<pre><code>                GVIF Df GVIF^(1/(2*Df))
depress_cat 1.021293  4        1.002637
raceEthCat  1.044998  4        1.005517
ageCat_18   1.042034  2        1.010347</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/pkg/car/man/vif.html'>vif</a></span><span class='op'>(</span><span class='va'>mod_final_behav</span><span class='op'>)</span> <span class='co'># check VIF of a priori model</span>
</code></pre>
</div>
<pre><code>                 GVIF Df GVIF^(1/(2*Df))
depress_cat  1.060084  4        1.007320
ageCat_18    1.170830  2        1.040216
SMQ681       1.134808  1        1.065274
activity     1.056344  1        1.027786
raceEthCat   1.134959  4        1.015950
hi_caffeine  1.092136  1        1.045053
heavy_drink2 1.145752  1        1.070398</code></pre>
</div>
<h3 id="results">Results</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>unweighted_data</span> <span class='op'><a href='https://ggobi.github.io/ggally/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>day_sleep</span>, <span class='va'>RIAGENDR</span>, <span class='va'>ageCat_18</span>, <span class='va'>INDFMPIR</span>, <span class='va'>SMQ681</span>, <span class='va'>raceEthCat</span>, <span class='va'>activity</span>, <span class='va'>hi_caffeine</span>, <span class='va'>BMI_cat</span>, <span class='va'>heavy_drink2</span>, <span class='va'>depress_cat</span><span class='op'>)</span> <span class='op'><a href='https://ggobi.github.io/ggally/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='http://www.danieldsjoberg.com/gtsummary//reference/tbl_uvregression.html'>tbl_uvregression</a></span><span class='op'>(</span>
    method <span class='op'>=</span> <span class='va'>glm</span>,
    y <span class='op'>=</span> <span class='va'>day_sleep</span>,
    method.args <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>family <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/family.html'>binomial</a></span><span class='op'>(</span>link<span class='op'>=</span><span class='st'>"log"</span><span class='op'>)</span><span class='op'>)</span>,
    exponentiate <span class='op'>=</span> <span class='cn'>TRUE</span>,
    pvalue_fun <span class='op'>=</span> <span class='op'>~</span><span class='fu'><a href='http://www.danieldsjoberg.com/gtsummary//reference/style_pvalue.html'>style_pvalue</a></span><span class='op'>(</span><span class='va'>.x</span>, digits <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>
  <span class='op'>)</span> <span class='op'><a href='https://ggobi.github.io/ggally/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='http://www.danieldsjoberg.com/gtsummary//reference/add_global_p.html'>add_global_p</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://ggobi.github.io/ggally/reference/pipe.html'>%&gt;%</a></span>  <span class='co'># add global p-value</span>
  <span class='fu'><a href='http://www.danieldsjoberg.com/gtsummary//reference/add_q.html'>add_q</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://ggobi.github.io/ggally/reference/pipe.html'>%&gt;%</a></span>         <span class='co'># adjusts global p-values for multiple testing</span>
  <span class='fu'><a href='http://www.danieldsjoberg.com/gtsummary//reference/bold_p.html'>bold_p</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://ggobi.github.io/ggally/reference/pipe.html'>%&gt;%</a></span>        <span class='co'># bold p-values under a given threshold (default 0.05)</span>
  <span class='fu'><a href='http://www.danieldsjoberg.com/gtsummary//reference/bold_p.html'>bold_p</a></span><span class='op'>(</span>t <span class='op'>=</span> <span class='fl'>0.10</span>, q <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span> <span class='op'><a href='https://ggobi.github.io/ggally/reference/pipe.html'>%&gt;%</a></span> <span class='co'># now bold q-values under the threshold of 0.10</span>
  <span class='fu'><a href='http://www.danieldsjoberg.com/gtsummary//reference/modify.html'>modify_caption</a></span><span class='op'>(</span><span class='st'>"Crude Table"</span><span class='op'>)</span> <span class='op'><a href='https://ggobi.github.io/ggally/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='http://www.danieldsjoberg.com/gtsummary//reference/bold_italicize_labels_levels.html'>bold_labels</a></span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<div id="zvgxgrzxaq" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#zvgxgrzxaq .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#zvgxgrzxaq .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#zvgxgrzxaq .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#zvgxgrzxaq .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#zvgxgrzxaq .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#zvgxgrzxaq .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#zvgxgrzxaq .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#zvgxgrzxaq .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#zvgxgrzxaq .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#zvgxgrzxaq .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#zvgxgrzxaq .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#zvgxgrzxaq .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#zvgxgrzxaq .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#zvgxgrzxaq .gt_from_md > :first-child {
  margin-top: 0;
}

#zvgxgrzxaq .gt_from_md > :last-child {
  margin-bottom: 0;
}

#zvgxgrzxaq .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#zvgxgrzxaq .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#zvgxgrzxaq .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#zvgxgrzxaq .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#zvgxgrzxaq .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#zvgxgrzxaq .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#zvgxgrzxaq .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#zvgxgrzxaq .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#zvgxgrzxaq .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#zvgxgrzxaq .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#zvgxgrzxaq .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#zvgxgrzxaq .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#zvgxgrzxaq .gt_left {
  text-align: left;
}

#zvgxgrzxaq .gt_center {
  text-align: center;
}

#zvgxgrzxaq .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#zvgxgrzxaq .gt_font_normal {
  font-weight: normal;
}

#zvgxgrzxaq .gt_font_bold {
  font-weight: bold;
}

#zvgxgrzxaq .gt_font_italic {
  font-style: italic;
}

#zvgxgrzxaq .gt_super {
  font-size: 65%;
}

#zvgxgrzxaq .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 65%;
}
</style>
<table class="gt_table">
  <caption><span id="tab:unnamed-chunk-56">Table 1: </span>Crude Table</caption>
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1"><strong>Characteristic</strong></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1"><strong>N</strong></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1"><strong>RR</strong><sup class="gt_footnote_marks">1</sup></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1"><strong>95% CI</strong><sup class="gt_footnote_marks">1</sup></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1"><strong>p-value</strong></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1"><strong>q-value</strong><sup class="gt_footnote_marks">2</sup></th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td class="gt_row gt_left" style="font-weight: bold;">RIAGENDR</td>
<td class="gt_row gt_center">5856</td>
<td class="gt_row gt_center">1.20</td>
<td class="gt_row gt_center">1.10, 1.31</td>
<td class="gt_row gt_center" style="font-weight: bold;"><0.001</td>
<td class="gt_row gt_center" style="font-weight: bold;"><0.001</td></tr>
    <tr><td class="gt_row gt_left" style="font-weight: bold;">ageCat_18</td>
<td class="gt_row gt_center">5856</td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center" style="font-weight: bold;"><0.001</td>
<td class="gt_row gt_center" style="font-weight: bold;">0.001</td></tr>
    <tr><td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">18-39</td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td></tr>
    <tr><td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">40-59</td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center">0.82</td>
<td class="gt_row gt_center">0.74, 0.92</td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td></tr>
    <tr><td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">60+</td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center">0.87</td>
<td class="gt_row gt_center">0.78, 0.96</td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td></tr>
    <tr><td class="gt_row gt_left" style="font-weight: bold;">INDFMPIR</td>
<td class="gt_row gt_center">5021</td>
<td class="gt_row gt_center">0.92</td>
<td class="gt_row gt_center">0.89, 0.95</td>
<td class="gt_row gt_center" style="font-weight: bold;"><0.001</td>
<td class="gt_row gt_center" style="font-weight: bold;"><0.001</td></tr>
    <tr><td class="gt_row gt_left" style="font-weight: bold;">SMQ681</td>
<td class="gt_row gt_center">5132</td>
<td class="gt_row gt_center">0.85</td>
<td class="gt_row gt_center">0.76, 0.94</td>
<td class="gt_row gt_center" style="font-weight: bold;">0.002</td>
<td class="gt_row gt_center" style="font-weight: bold;">0.003</td></tr>
    <tr><td class="gt_row gt_left" style="font-weight: bold;">raceEthCat</td>
<td class="gt_row gt_center">5856</td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center" style="font-weight: bold;"><0.001</td>
<td class="gt_row gt_center" style="font-weight: bold;"><0.001</td></tr>
    <tr><td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">NH White</td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td></tr>
    <tr><td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">NH Black</td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center">0.68</td>
<td class="gt_row gt_center">0.61, 0.76</td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td></tr>
    <tr><td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">NH Asian</td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center">0.42</td>
<td class="gt_row gt_center">0.35, 0.49</td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td></tr>
    <tr><td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Hispanic</td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center">0.67</td>
<td class="gt_row gt_center">0.60, 0.75</td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td></tr>
    <tr><td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">NH Other/Multiple</td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center">0.92</td>
<td class="gt_row gt_center">0.76, 1.09</td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td></tr>
    <tr><td class="gt_row gt_left" style="font-weight: bold;">activity</td>
<td class="gt_row gt_center">5849</td>
<td class="gt_row gt_center">0.95</td>
<td class="gt_row gt_center">0.87, 1.05</td>
<td class="gt_row gt_center">0.31</td>
<td class="gt_row gt_center">0.31</td></tr>
    <tr><td class="gt_row gt_left" style="font-weight: bold;">hi_caffeine</td>
<td class="gt_row gt_center">4339</td>
<td class="gt_row gt_center">1.41</td>
<td class="gt_row gt_center">1.16, 1.67</td>
<td class="gt_row gt_center" style="font-weight: bold;"><0.001</td>
<td class="gt_row gt_center" style="font-weight: bold;">0.001</td></tr>
    <tr><td class="gt_row gt_left" style="font-weight: bold;">BMI_cat</td>
<td class="gt_row gt_center">5434</td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center" style="font-weight: bold;"><0.001</td>
<td class="gt_row gt_center" style="font-weight: bold;"><0.001</td></tr>
    <tr><td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">normal</td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td></tr>
    <tr><td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">underweight</td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center">1.07</td>
<td class="gt_row gt_center">0.71, 1.51</td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td></tr>
    <tr><td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">overweight</td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center">1.05</td>
<td class="gt_row gt_center">0.92, 1.20</td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td></tr>
    <tr><td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">obese</td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center">1.44</td>
<td class="gt_row gt_center">1.28, 1.62</td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td></tr>
    <tr><td class="gt_row gt_left" style="font-weight: bold;">heavy_drink2</td>
<td class="gt_row gt_center">5120</td>
<td class="gt_row gt_center">1.23</td>
<td class="gt_row gt_center">1.12, 1.35</td>
<td class="gt_row gt_center" style="font-weight: bold;"><0.001</td>
<td class="gt_row gt_center" style="font-weight: bold;"><0.001</td></tr>
    <tr><td class="gt_row gt_left" style="font-weight: bold;">depress_cat</td>
<td class="gt_row gt_center">5068</td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center" style="font-weight: bold;"><0.001</td>
<td class="gt_row gt_center" style="font-weight: bold;"><0.001</td></tr>
    <tr><td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">depress_cat.L</td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center">2.42</td>
<td class="gt_row gt_center">2.02, 2.79</td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td></tr>
    <tr><td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">depress_cat.Q</td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center">0.61</td>
<td class="gt_row gt_center">0.52, 0.70</td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td></tr>
    <tr><td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">depress_cat.C</td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center">1.23</td>
<td class="gt_row gt_center">1.08, 1.40</td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td></tr>
    <tr><td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">depress_cat^4</td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center">0.91</td>
<td class="gt_row gt_center">0.82, 1.02</td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td></tr>
  </tbody>
  
  <tfoot>
    <tr class="gt_footnotes">
      <td colspan="6">
        <p class="gt_footnote">
          <sup class="gt_footnote_marks">
            <em>1</em>
          </sup>
           
          RR = Relative Risk, CI = Confidence Interval
          <br />
        </p>
        <p class="gt_footnote">
          <sup class="gt_footnote_marks">
            <em>2</em>
          </sup>
           
          False discovery rate correction for multiple testing
          <br />
        </p>
      </td>
    </tr>
  </tfoot>
</table>
</div>
</div>
<p>Best subset model included race categories, age categories, and depression score categories as predictors. The final model was the model including behavioral variables selected a-priori, along with age and depression score which were identified through the AI model. This final model best suits the epidemiological question at hand: which risk factors are most important in the relationship with excessive daytime sleepiness, with a special emphasis on modifiable lifestyle factors?</p>
<ul>
<li>The predictors in the final model: age categories, race categories, depression score categories, current smoking, weekly moderate to vigorous activity, high caffeine intake, and heavy alcohol use</li>
</ul>
<p>The dataset was large, so the model is still parsimonious with many predictors. All candidate models had Pearsons Goodness of Fit p-values equal to 1, so all fit the data very well. None of the variables showed signs of collinearity for any of the candidate models.</p>
<h4 id="results-from-the-final-model">Results from the final model:</h4>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>mod_final_behav</span> <span class='op'><a href='https://ggobi.github.io/ggally/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='http://www.danieldsjoberg.com/gtsummary//reference/tbl_regression.html'>tbl_regression</a></span><span class='op'>(</span>exponentiate <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span> <span class='op'><a href='https://ggobi.github.io/ggally/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='http://www.danieldsjoberg.com/gtsummary//reference/add_global_p.html'>add_global_p</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://ggobi.github.io/ggally/reference/pipe.html'>%&gt;%</a></span>  <span class='co'># add global p-value </span>
  <span class='fu'><a href='http://www.danieldsjoberg.com/gtsummary//reference/add_q.html'>add_q</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://ggobi.github.io/ggally/reference/pipe.html'>%&gt;%</a></span>         <span class='co'># adjusts global p-values for multiple testing</span>
  <span class='fu'><a href='http://www.danieldsjoberg.com/gtsummary//reference/bold_p.html'>bold_p</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://ggobi.github.io/ggally/reference/pipe.html'>%&gt;%</a></span>        <span class='co'># bold p-values under a given threshold (default 0.05)</span>
  <span class='fu'><a href='http://www.danieldsjoberg.com/gtsummary//reference/bold_p.html'>bold_p</a></span><span class='op'>(</span>t <span class='op'>=</span> <span class='fl'>0.10</span>, q <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span> <span class='op'><a href='https://ggobi.github.io/ggally/reference/pipe.html'>%&gt;%</a></span> <span class='co'># now bold q-values under the threshold of 0.10</span>
  <span class='fu'><a href='http://www.danieldsjoberg.com/gtsummary//reference/modify.html'>modify_caption</a></span><span class='op'>(</span><span class='st'>"Final model"</span><span class='op'>)</span> <span class='op'><a href='https://ggobi.github.io/ggally/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='http://www.danieldsjoberg.com/gtsummary//reference/bold_italicize_labels_levels.html'>bold_labels</a></span><span class='op'>(</span><span class='op'>)</span> 
</code></pre>
</div>
<div id="hcjkayzual" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#hcjkayzual .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#hcjkayzual .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#hcjkayzual .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#hcjkayzual .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#hcjkayzual .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#hcjkayzual .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#hcjkayzual .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#hcjkayzual .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#hcjkayzual .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#hcjkayzual .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#hcjkayzual .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#hcjkayzual .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#hcjkayzual .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#hcjkayzual .gt_from_md > :first-child {
  margin-top: 0;
}

#hcjkayzual .gt_from_md > :last-child {
  margin-bottom: 0;
}

#hcjkayzual .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#hcjkayzual .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#hcjkayzual .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#hcjkayzual .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#hcjkayzual .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#hcjkayzual .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#hcjkayzual .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#hcjkayzual .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#hcjkayzual .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#hcjkayzual .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#hcjkayzual .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#hcjkayzual .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#hcjkayzual .gt_left {
  text-align: left;
}

#hcjkayzual .gt_center {
  text-align: center;
}

#hcjkayzual .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#hcjkayzual .gt_font_normal {
  font-weight: normal;
}

#hcjkayzual .gt_font_bold {
  font-weight: bold;
}

#hcjkayzual .gt_font_italic {
  font-style: italic;
}

#hcjkayzual .gt_super {
  font-size: 65%;
}

#hcjkayzual .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 65%;
}
</style>
<table class="gt_table">
  <caption><span id="tab:unnamed-chunk-57">Table 2: </span>Final model</caption>
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1"><strong>Characteristic</strong></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1"><strong>IRR</strong><sup class="gt_footnote_marks">1</sup></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1"><strong>95% CI</strong><sup class="gt_footnote_marks">1</sup></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1"><strong>p-value</strong></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1"><strong>q-value</strong><sup class="gt_footnote_marks">2</sup></th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td class="gt_row gt_left" style="font-weight: bold;">depress_cat</td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center" style="font-weight: bold;"><0.001</td>
<td class="gt_row gt_center" style="font-weight: bold;"><0.001</td></tr>
    <tr><td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">depress_cat.L</td>
<td class="gt_row gt_center">2.31</td>
<td class="gt_row gt_center">1.73, 2.98</td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td></tr>
    <tr><td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">depress_cat.Q</td>
<td class="gt_row gt_center">0.67</td>
<td class="gt_row gt_center">0.52, 0.84</td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td></tr>
    <tr><td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">depress_cat.C</td>
<td class="gt_row gt_center">1.35</td>
<td class="gt_row gt_center">1.08, 1.68</td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td></tr>
    <tr><td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">depress_cat^4</td>
<td class="gt_row gt_center">0.96</td>
<td class="gt_row gt_center">0.80, 1.16</td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td></tr>
    <tr><td class="gt_row gt_left" style="font-weight: bold;">ageCat_18</td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center" style="font-weight: bold;">0.010</td>
<td class="gt_row gt_center" style="font-weight: bold;">0.023</td></tr>
    <tr><td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">18-39</td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td></tr>
    <tr><td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">40-59</td>
<td class="gt_row gt_center">0.83</td>
<td class="gt_row gt_center">0.71, 0.96</td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td></tr>
    <tr><td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">60+</td>
<td class="gt_row gt_center">0.81</td>
<td class="gt_row gt_center">0.70, 0.94</td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td></tr>
    <tr><td class="gt_row gt_left" style="font-weight: bold;">SMQ681</td>
<td class="gt_row gt_center">1.11</td>
<td class="gt_row gt_center">0.96, 1.28</td>
<td class="gt_row gt_center">0.2</td>
<td class="gt_row gt_center">0.2</td></tr>
    <tr><td class="gt_row gt_left" style="font-weight: bold;">activity</td>
<td class="gt_row gt_center">0.91</td>
<td class="gt_row gt_center">0.80, 1.04</td>
<td class="gt_row gt_center">0.2</td>
<td class="gt_row gt_center">0.2</td></tr>
    <tr><td class="gt_row gt_left" style="font-weight: bold;">raceEthCat</td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center" style="font-weight: bold;"><0.001</td>
<td class="gt_row gt_center" style="font-weight: bold;"><0.001</td></tr>
    <tr><td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">NH White</td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td></tr>
    <tr><td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">NH Black</td>
<td class="gt_row gt_center">0.71</td>
<td class="gt_row gt_center">0.60, 0.83</td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td></tr>
    <tr><td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">NH Asian</td>
<td class="gt_row gt_center">0.45</td>
<td class="gt_row gt_center">0.35, 0.59</td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td></tr>
    <tr><td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Hispanic</td>
<td class="gt_row gt_center">0.70</td>
<td class="gt_row gt_center">0.59, 0.82</td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td></tr>
    <tr><td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">NH Other/Multiple</td>
<td class="gt_row gt_center">0.87</td>
<td class="gt_row gt_center">0.68, 1.11</td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td></tr>
    <tr><td class="gt_row gt_left" style="font-weight: bold;">hi_caffeine</td>
<td class="gt_row gt_center">1.13</td>
<td class="gt_row gt_center">0.88, 1.42</td>
<td class="gt_row gt_center">0.3</td>
<td class="gt_row gt_center">0.4</td></tr>
    <tr><td class="gt_row gt_left" style="font-weight: bold;">heavy_drink2</td>
<td class="gt_row gt_center">1.04</td>
<td class="gt_row gt_center">0.91, 1.18</td>
<td class="gt_row gt_center">0.6</td>
<td class="gt_row gt_center">0.6</td></tr>
  </tbody>
  
  <tfoot>
    <tr class="gt_footnotes">
      <td colspan="5">
        <p class="gt_footnote">
          <sup class="gt_footnote_marks">
            <em>1</em>
          </sup>
           
          IRR = Incidence Rate Ratio, CI = Confidence Interval
          <br />
        </p>
        <p class="gt_footnote">
          <sup class="gt_footnote_marks">
            <em>2</em>
          </sup>
           
          False discovery rate correction for multiple testing
          <br />
        </p>
      </td>
    </tr>
  </tfoot>
</table>
</div>
</div>
<ul>
<li>Belonging to older age groups (40-59 years &amp; 60+ years) conferred a decreased risk of excessive daytime sleepiness when compared to a referent group of 18-39 years, contrary to what is expected based on the literature
<ul>
<li>This may indicate that age-differential lifestyle factors confound the relationship between age and sleep quality.</li>
</ul></li>
<li>There was also an association in the opposite direction of to what is expected for race categories.
<ul>
<li>When compared to white individuals, Hispanic, Asian, and Black individuals have a decreased risk of excessive daytime sleepiness
<ul>
<li>Perhaps the relationship is confounded by social factors not accounted for in the study</li>
</ul></li>
</ul></li>
<li>Associations with the most potential for intervention were mild and moderate to severe depression, caffeine intake, and obesity
<ul>
<li>The direction of the association of depression score with excessive daytime sleepiness varied by severity, which may be due to low sample sizes in severity categories</li>
</ul></li>
<li>Some covariates previously presented as risk factors for poor sleep quality in the literature that were not replicated in this study were heavy alcohol use, current tobacco smoking, and participation in weekly moderate to vigorous physical activity</li>
</ul>
<h3 id="conclusions-and-future-directions">Conclusions and future directions</h3>
<p>Conflicting results emphasize the need for more research is needed to uncover the links between age, race, alcohol use, tobacco smoking and exercise on sleep quality</p>
<p>High daily caffeine consumption is a modifiable risk factor that could play a role in causing excessive sleepiness during the day.</p>
<p>Based on these results and the results of previous research, it may be clinically advisable to address sleep hygiene in people with depression and obesity to prevent future morbidity and mortality.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>


<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom"></div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<div class="distill-site-nav distill-site-footer">
<p>Website theme courtesy of <a href="https://tidymodels.org">Desire De Leon</a><br />
Site created in <a href="https://www.rstudio.com">RStudio</a> and hosted on <a href="https://www.github.com/">GitHub</a></p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
</div>
<!--/radix_placeholder_navigation_after_body-->


</body>

</html>
